
<!DOCTYPE HTML>
<html lang="zh-hans">
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Image processing algorithms &#xB7; SAW User Manual</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="description" content>
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tabs/bootstrap.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../gao-ji-she-zhi/">
    
    
    <link rel="prev" href="gene-expression-algorithms.html">
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary"><div class="book-logo-root"><div class="book-logo" style="text-align: center; padding: 20px;"><img src="data:image/png;base64,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" style><p class="book-title" style="font-weight:600">SAW &#x7528;&#x6237;&#x624B;&#x518C; 8.1 </p></div></div>
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="&#x8F93;&#x5165;&#x5E76;&#x641C;&#x7D22;">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    &#x6982;&#x89C8;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    &#x5FEB;&#x901F;&#x5F00;&#x59CB;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting-started/introduction.html">
            
                <a href="../getting-started/introduction.html">
            
                    
                    &#x8F6F;&#x4EF6;&#x4ECB;&#x7ECD;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting-started/glossary.html">
            
                <a href="../getting-started/glossary.html">
            
                    
                    &#x8BCD;&#x6C47;&#x8868;
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../download-center.html">
            
                <a href="../download-center.html">
            
                    
                    &#x4E0B;&#x8F7D;&#x4E2D;&#x5FC3;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../analysis/">
            
                <a href="../analysis/">
            
                    
                    &#x8FD0;&#x884C;&#x5206;&#x6790;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../analysis/inputs/">
            
                <a href="../analysis/inputs/">
            
                    
                    &#x8F93;&#x5165;&#x6587;&#x4EF6;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../analysis/inputs/chip-mask.html">
            
                <a href="../analysis/inputs/chip-mask.html">
            
                    
                    &#x82AF;&#x7247; mask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../analysis/inputs/fastqs.html">
            
                <a href="../analysis/inputs/fastqs.html">
            
                    
                    &#x6D4B;&#x5E8F; FASTQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../analysis/inputs/images.html">
            
                <a href="../analysis/inputs/images.html">
            
                    
                    &#x663E;&#x5FAE;&#x955C;&#x56FE;&#x50CF;
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../analysis/pipelines/">
            
                <a href="../analysis/pipelines/">
            
                    
                    &#x5206;&#x6790;&#x6D41;&#x7A0B;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../analysis/pipelines/saw-can-shu-ming-ling.html">
            
                <a href="../analysis/pipelines/saw-can-shu-ming-ling.html">
            
                    
                    SAW &#x53C2;&#x6570;&#x547D;&#x4EE4;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../analysis/pipelines/count/">
            
                <a href="../analysis/pipelines/count/">
            
                    
                    count
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.2.1" data-path="../analysis/pipelines/count/stereo-seq-t-ff.html">
            
                <a href="../analysis/pipelines/count/stereo-seq-t-ff.html">
            
                    
                    Stereo-seq T FF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2.2" data-path="../analysis/pipelines/count/stereo-seq-n-ffpe-v1.0.html">
            
                <a href="../analysis/pipelines/count/stereo-seq-n-ffpe-v1.0.html">
            
                    
                    Stereo-seq N FFPE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2.3" data-path="../analysis/pipelines/count/stereo-cite-t-ff.html">
            
                <a href="../analysis/pipelines/count/stereo-cite-t-ff.html">
            
                    
                    Stereo-CITE T FF
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../analysis/outputs/">
            
                <a href="../analysis/outputs/">
            
                    
                    &#x8F93;&#x51FA;&#x7ED3;&#x679C;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../analysis/outputs/count-outputs.html">
            
                <a href="../analysis/outputs/count-outputs.html">
            
                    
                    count &#x8F93;&#x51FA;&#x7ED3;&#x679C;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../analysis/outputs/realign-outputs.html">
            
                <a href="../analysis/outputs/realign-outputs.html">
            
                    
                    realign &#x8F93;&#x51FA;&#x7ED3;&#x679C;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../analysis/outputs/html-report.html">
            
                <a href="../analysis/outputs/html-report.html">
            
                    
                    HTML report
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4" data-path="../analysis/outputs/bam.html">
            
                <a href="../analysis/outputs/bam.html">
            
                    
                    BAM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.5" data-path="../analysis/outputs/matrices.html">
            
                <a href="../analysis/outputs/matrices.html">
            
                    
                    Matrices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.6" data-path="../analysis/outputs/images.html">
            
                <a href="../analysis/outputs/images.html">
            
                    
                    Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.7" data-path="../analysis/outputs/analysis.html">
            
                <a href="../analysis/outputs/analysis.html">
            
                    
                    Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../shi-yong-jiao-cheng/">
            
                <a href="../shi-yong-jiao-cheng/">
            
                    
                    &#x4F7F;&#x7528;&#x6559;&#x7A0B;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../shi-yong-jiao-cheng/preparation-of-reference.html">
            
                <a href="../shi-yong-jiao-cheng/preparation-of-reference.html">
            
                    
                    &#x6BD4;&#x5BF9;&#x7D22;&#x5F15;&#x6784;&#x5EFA;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/">
            
                <a href="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/">
            
                    
                    &#x8FD0;&#x884C;&#x6838;&#x5FC3;&#x5206;&#x6790;&#x6D41;&#x7A0B;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.2.1" data-path="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/stereo-seq-ff.html">
            
                <a href="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/stereo-seq-ff.html">
            
                    
                    Stereo-seq FF &#x5206;&#x6790;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.2" data-path="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/stereo-seq-ffpe.html">
            
                <a href="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/stereo-seq-ffpe.html">
            
                    
                    Stereo-seq FFPE &#x5206;&#x6790;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2.3" data-path="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/stereocite-ff-fen-xi.html">
            
                <a href="../shi-yong-jiao-cheng/yun-xing-he-xin-fen-xi-liu-cheng/stereocite-ff-fen-xi.html">
            
                    
                    Stereo-CITE FF &#x5206;&#x6790;
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html">
            
                <a href="../shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html">
            
                    
                    &#x624B;&#x52A8;&#x56FE;&#x50CF;&#x5904;&#x7406;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../shi-yong-jiao-cheng/secondary-analysis.html">
            
                <a href="../shi-yong-jiao-cheng/secondary-analysis.html">
            
                    
                    &#x6570;&#x636E;&#x518D;&#x5206;&#x6790;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../shi-yong-jiao-cheng/shu-ju-ge-shi-zhuan-huan.html">
            
                <a href="../shi-yong-jiao-cheng/shu-ju-ge-shi-zhuan-huan.html">
            
                    
                    &#x6570;&#x636E;&#x683C;&#x5F0F;&#x8F6C;&#x6362;
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="./">
            
                <a href="./">
            
                    
                    &#x7B97;&#x6CD5;&#x539F;&#x7406;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="gene-expression-algorithms.html">
            
                <a href="gene-expression-algorithms.html">
            
                    
                    Read processing algorithms
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.6.2" data-path="image-processing-algorithms.html">
            
                <a href="image-processing-algorithms.html">
            
                    
                    Image processing algorithms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../gao-ji-she-zhi/">
            
                <a href="../gao-ji-she-zhi/">
            
                    
                    &#x9AD8;&#x7EA7;&#x8BBE;&#x7F6E;
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../gao-ji-she-zhi/analysis-with-gpu.html">
            
                <a href="../gao-ji-she-zhi/analysis-with-gpu.html">
            
                    
                    Analysis with GPU
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../gao-ji-she-zhi/expression-matrix-format.html">
            
                <a href="../gao-ji-she-zhi/expression-matrix-format.html">
            
                    
                    Expression matrix format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../gao-ji-she-zhi/image-related-record-format.html">
            
                <a href="../gao-ji-she-zhi/image-related-record-format.html">
            
                    
                    Image-related record format
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../release-notes.html">
            
                <a href="../release-notes.html">
            
                    
                    &#x7248;&#x672C;&#x8BF4;&#x660E;
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">&#x6280;&#x672F;&#x652F;&#x6301;</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../support/shu-ju-ji.html">
            
                <a href="../support/shu-ju-ji.html">
            
                    
                    &#x6570;&#x636E;&#x96C6;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../support/cuo-wu-ma.html">
            
                <a href="../support/cuo-wu-ma.html">
            
                    
                    &#x9519;&#x8BEF;&#x7801;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../support/shi-pei-jian-rong-de-ruan-jian-he-shi-ji-he.html">
            
                <a href="../support/shi-pei-jian-rong-de-ruan-jian-he-shi-ji-he.html">
            
                    
                    &#x9002;&#x914D;&#x517C;&#x5BB9;&#x7684;&#x8F6F;&#x4EF6;&#x548C;&#x8BD5;&#x5242;&#x76D2;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4">
            
                <a target="_blank" href="https://www.stomics.tech/resources/FAQ">
            
                    
                    &#x5E38;&#x89C1;&#x95EE;&#x9898;
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.5">
            
                <a target="_blank" href="https://www.stomics.tech/service/new-StereoMap.html">
            
                    
                    StereoMap
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            &#x672C;&#x4E66;&#x4F7F;&#x7528; GitBook &#x53D1;&#x5E03;
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="..">Image processing algorithms</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#image-processing-algorithms"><b></b>Image processing algorithms</a></li><ul><li><span class="title-icon "></span><a href="#tissue-segmentation"><b></b>Tissue segmentation</a></li><li><span class="title-icon "></span><a href="#cell-segmentation"><b></b>Cell segmentation</a></li><li><span class="title-icon "></span><a href="#cell-border-expanding"><b></b>Cell border expanding</a></li><li><span class="title-icon "></span><a href="#reference"><b></b>Reference</a></li></ul></ul></div><a href="#image-processing-algorithms" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="image-processing-algorithms"><a name="image-processing-algorithms" class="anchor-navigation-ex-anchor" href="#image-processing-algorithms"><i class="fa fa-link" aria-hidden="true"></i></a>Image processing algorithms</h1>
<p><em><mark style="color:purple;">*The interpretation of the Algorithm part is only available in EN.</mark></em></p>
<h2 id="tissue-segmentation"><a name="tissue-segmentation" class="anchor-navigation-ex-anchor" href="#tissue-segmentation"><i class="fa fa-link" aria-hidden="true"></i></a>Tissue segmentation</h2>
<p>In SAW, gene expression under tissue is used in downstream analysis. A more accurate tissue segmentation helps to define gene expression under tissue with greater precision. The performance of segmentation is affected by imaging quality (such as clarity), tissue properties (such as discontinuous areas), and the contrast between tissue and the background.</p>
<p>The grayscale image (ssDNA/DAPI-based) or G-channel image (H&amp;E-based) after Contrast Limited Adaptive Histogram Equalization (CLAHE) is used as input to the BCDU-Net (Bi-directional ConvLSTM U-Net) model [1]. The model classifies each pixel as either being in tissue or not. It also fills holes in large areas, resulting in a binarized tissue mask.</p>
<p>If you do not have a microscope image, SAW can still perform tissue segmentation using a feature density map. The algorithm is trained on this type of data. The input feature density map is converted to a grayscale image and subjected to clarity enhancement before being fed into the BCDU-Net model. The remaining image-processing steps are identical to those used in microscope-image-based tissue segmentation.</p>
<figure><a href="../img/assets/tissueSeg_algorithm.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/tissueSeg_algorithm.png" alt></a><figcaption></figcaption></figure>

<p>Additionally, holes in the tissue mask from the Immunofluorescence (IF) image won&apos;t be filled.</p>
<table><thead><tr><th width="115">IF Name</th><th width="314">IF image (auto-colored in StereoMap)</th><th>IF tissue Mask</th></tr></thead><tbody><tr><td>AKAP3</td><td><a href="../img/assets/A_IF_image.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/A_IF_image.png" alt></a></td><td><a href="../img/assets/AKAP3_IF_tissueMask.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/AKAP3_IF_tissueMask.png" alt></a></td></tr><tr><td>TESK2</td><td><a href="../img/assets/T_IF_image.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/T_IF_image.png" alt></a></td><td><a href="../img/assets/TESK2_IF_tissueMask.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/TESK2_IF_tissueMask.png" alt></a></td></tr></tbody></table>

<p>If the segmentation result does not meet your expectations, you can refer to the tutorial of <a href="../shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html">With manually processed files</a>, to perform a new segmentation.</p>
<h2 id="cell-segmentation"><a name="cell-segmentation" class="anchor-navigation-ex-anchor" href="#cell-segmentation"><i class="fa fa-link" aria-hidden="true"></i></a>Cell segmentation</h2>
<p>SAW provides the option of cell-level analysis based on the cell segmentation result. However, the imaging quality and cell distribution can impact the segmentation performance. To address this issue, we utilize various tissue-type images as input for a deep-learning model to enhance the accuracy of segmentation. This process involves using a digital image clarity-enhanced method and a light model framework to produce the cell segmentation result. SAW also offers a <a href="../gao-ji-she-zhi/analysis-with-gpu.html">GPU computing option</a> to accelerate the segmentation process.</p>
<p>The input to the BCDU-Net model is a grayscale image after histogram equalization. The model also incorporates BCDU-Net [1], this architecture is beneficial for spatial understanding, predicting patterns, and capturing image context with high parameter efficiency. Finally, utilize the watershed method to acquire more reasonable cell outlines, eliminate small areas of less than 15 pixels, and generate binarized cell masks.</p>
<figure><a href="../img/assets/cellSeg.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/cellSeg.png" alt></a><figcaption></figcaption></figure>

<table>
<thead>
<tr>
<th>Cell segmentation in the tissue edge</th>
<th>Cell segmentation in hollows</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../img/assets/cellbin/_edge.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/cellbin/_edge.png" alt></a></td>
<td><a href="../img/assets/cellbin/_middle.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/cellbin/_middle.png" alt></a></td>
</tr>
</tbody>
</table>
<p>If the segmentation result does not meet your expectations, you can refer to the tutorial of <a href="../shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html">With manually processed files</a>, to perform a new segmentation.</p>
<h2 id="cell-border-expanding"><a name="cell-border-expanding" class="anchor-navigation-ex-anchor" href="#cell-border-expanding"><i class="fa fa-link" aria-hidden="true"></i></a>Cell border expanding</h2>
<p>After tissue staining, only the cell nucleus area will be stained. Therefore, the area segmented by cell segmentation typically corresponds to the nucleus area. It is important to note that the background area outside the segmented cells may also be considered part of the cell. At the same time, there is also the issue of gene diffusion, which leads to a limited number of genes in the nucleus, hindering downstream analysis. Therefore, EDM (Euclidean Distance Map) correction technology is used to expand the boundary of the cell nucleus and simulate a complete cell as much as possible, thereby increasing the number of genes.</p>
<table>
<thead>
<tr>
<th>Cell border correcting (pink) in the tissue edge</th>
<th>Cell border correcting (pink) in hollows</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="../img/assets/cellbin/_cellCorrect/_edge.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/cellbin/_cellCorrect/_edge.png" alt></a></td>
<td><a href="../img/assets/cellbin/_cellCorrect/_middle.png" data-lightbox="01bde83f-fe49-4870-9f60-3668c4c92761" data-title><img src="../img/assets/cellbin/_cellCorrect/_middle.png" alt></a></td>
</tr>
</tbody>
</table>
<p>The EDM correction algorithm is designed to enhance the cell nucleus&apos;s boundary and simulate a complete cell as closely as possible, thereby increasing the number of genes. To achieve this, the input cell segmentation image is converted into an EDM image. The EDM image is composed of the distance from the background pixel outside the cell to the nearest cell. The algorithm calculates the distance from each point in the background to the nearest cell. Based on the threshold (default value is 10, but adjustable), the area within this threshold from the nearest cell is assigned to the cell. In other words, each cell expands its range within the threshold. Within this threshold, any data point that is closest to a cell is assigned to that cell. In other words, each cell extends its range within the threshold.</p>
<p></p><div class="alert alert-info hints-alert"><div class="hints-icon"><i class="fa fa-info-circle"></i></div><div class="hints-container"><p>Cell border expanding is automatically performed based on the cell segmentation result, during <code>SAW count</code> and <code>SAW realign</code>. If you are satisfied with your cell segmentation image, <code>--adjusted--distance</code> in <code>SAW realign</code> will be helpful to skip this step.</p>
</div></div><p></p>
<h2 id="reference"><a name="reference" class="anchor-navigation-ex-anchor" href="#reference"><i class="fa fa-link" aria-hidden="true"></i></a>Reference</h2>
<ol>
<li>R. Azad, M. Asadi-Aghbolaghi, M. Fathy and S. Escalera, &quot;Bi-Directional ConvLSTM U-Net with Densley Connected Convolutions,&quot; <em>2019 IEEE/CVF International Conference on Computer Vision Workshop (ICCVW)</em>, Seoul, Korea (South), 2019, pp. 406-415, doi: 10.1109/ICCVW.2019.00052.</li>
</ol>
<footer class="page-footer"><span class="copyright">&#xA9; 2025 STOmics Tech. All rights reserved.</span><span class="footer-modification">Modified: 
2025-04-09 15:29:46
</span></footer><script>document.addEventListener("DOMContentLoaded", function() {lightbox.option({"resizeDuration":200,"wrapAround":true});})</script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching &quot;<span class="search-query"></span>&quot;</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching &quot;<span class="search-query"></span>&quot;</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="gene-expression-algorithms.html" class="navigation navigation-prev " aria-label="Previous page: Read processing algorithms">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../gao-ji-she-zhi/" class="navigation navigation-next " aria-label="Next page: &#x9AD8;&#x7EA7;&#x8BBE;&#x7F6E;">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Image processing algorithms","level":"1.6.2","depth":2,"next":{"title":"高级设置","level":"1.7","depth":1,"path":"gao-ji-she-zhi/README.md","ref":"gao-ji-she-zhi/README.md","articles":[{"title":"Analysis with GPU","level":"1.7.1","depth":2,"path":"gao-ji-she-zhi/analysis-with-gpu.md","ref":"gao-ji-she-zhi/analysis-with-gpu.md","articles":[]},{"title":"Expression matrix format","level":"1.7.2","depth":2,"path":"gao-ji-she-zhi/expression-matrix-format.md","ref":"gao-ji-she-zhi/expression-matrix-format.md","articles":[]},{"title":"Image-related record format","level":"1.7.3","depth":2,"path":"gao-ji-she-zhi/image-related-record-format.md","ref":"gao-ji-she-zhi/image-related-record-format.md","articles":[]}]},"previous":{"title":"Read processing algorithms","level":"1.6.1","depth":2,"path":"algorithms/gene-expression-algorithms.md","ref":"algorithms/gene-expression-algorithms.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters-small","anchor-navigation-ex","logo","-insert-logo","tbfed-pagefooter","hide-element","-code-optimize","katex","hints","tabs","lightbox","-lunr","-search","search-plus","add-index-html","anchor-to-full-links"],"root":".","styles":{},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"© 2025 STOmics Tech.","modify_label":"Modified: ","modify_format":"YYYY-MM-DD HH:mm:ss"},"logo":{"logo":"data:image/png;base64,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","title":"SAW 用户手册 8.1 ","titleStyle":"font-weight:600"},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"hide-element":{"elements":[".gitbook-link"]},"katex":{},"add-index-html":{"myConfigKey":"it's the default value","elements":["a"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"printLog":true,"showGoTop":true,"showLevel":false},"anchor-to-full-links":{"myConfigKey":"it's the default value","elements":["a"]},"lightbox":{"jquery":true,"includeJQuery":true,"sameUuid":true,"options":{"resizeDuration":200,"wrapAround":true}},"expandable-chapters-small":{},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"code-optimize":{"copyButtons":true,"showLines":true},"tabs":{},"search-plus":{}},"theme":"default","author":"","pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":12,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"isbn":"","variables":{},"title":"SAW User Manual","language":"zh-hans","links":{"gitbook":false,"sharing":{"google":false,"facebook":false,"twitter":false,"all":false}},"gitbook":"3.2.3","description":null,"extension":null},"file":{"path":"algorithms/image-processing-algorithms.md","mtime":"2025-04-09T07:29:46.834Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2025-04-09T09:29:48.718Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-tabs/bootstrap.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-add-index-html/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchor-to-full-links/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

