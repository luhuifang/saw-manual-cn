
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Read processing algorithms · SAW User Manual</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-anchor-navigation-ex/style/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code-optimize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tabs/bootstrap.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-lightbox/css/lightbox.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="image-processing-algorithms.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    概览
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                    快速开始
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting-started/introduction.html">
            
                <a href="../getting-started/introduction.html">
            
                    
                    软件介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting-started/glossary.html">
            
                <a href="../getting-started/glossary.html">
            
                    
                    词汇表
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../download-center.html">
            
                <a href="../download-center.html">
            
                    
                    下载中心
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../analysis/">
            
                <a href="../analysis/">
            
                    
                    运行分析
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../analysis/inputs/">
            
                <a href="../analysis/inputs/">
            
                    
                    输入文件
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="../analysis/inputs/chip-mask.html">
            
                <a href="../analysis/inputs/chip-mask.html">
            
                    
                    芯片 mask
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.2" data-path="../analysis/inputs/fastqs.html">
            
                <a href="../analysis/inputs/fastqs.html">
            
                    
                    测序 FASTQ
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="../analysis/inputs/images.html">
            
                <a href="../analysis/inputs/images.html">
            
                    
                    显微镜图像
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../analysis/pipelines/">
            
                <a href="../analysis/pipelines/">
            
                    
                    分析流程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../analysis/pipelines/saw-can-shu-ming-ling.html">
            
                <a href="../analysis/pipelines/saw-can-shu-ming-ling.html">
            
                    
                    SAW 参数命令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../analysis/pipelines/count/">
            
                <a href="../analysis/pipelines/count/">
            
                    
                    count
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.2.1" data-path="../analysis/pipelines/count/stereo-seq-t-ff.html">
            
                <a href="../analysis/pipelines/count/stereo-seq-t-ff.html">
            
                    
                    Stereo-seq T FF
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2.2" data-path="../analysis/pipelines/count/stereo-seq-n-ffpe-v1.0.html">
            
                <a href="../analysis/pipelines/count/stereo-seq-n-ffpe-v1.0.html">
            
                    
                    Stereo-seq N FFPE
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../analysis/outputs/">
            
                <a href="../analysis/outputs/">
            
                    
                    输出结果
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../analysis/outputs/count-outputs.html">
            
                <a href="../analysis/outputs/count-outputs.html">
            
                    
                    count 输出结果
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../analysis/outputs/realign-outputs.html">
            
                <a href="../analysis/outputs/realign-outputs.html">
            
                    
                    realign 输出结果
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../analysis/outputs/html-report.html">
            
                <a href="../analysis/outputs/html-report.html">
            
                    
                    HTML report
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.4" data-path="../analysis/outputs/bam.html">
            
                <a href="../analysis/outputs/bam.html">
            
                    
                    BAM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.5" data-path="../analysis/outputs/matrices.html">
            
                <a href="../analysis/outputs/matrices.html">
            
                    
                    Matrices
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.6" data-path="../analysis/outputs/images.html">
            
                <a href="../analysis/outputs/images.html">
            
                    
                    Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.7" data-path="../analysis/outputs/analysis.html">
            
                <a href="../analysis/outputs/analysis.html">
            
                    
                    Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../shi-yong-jiao-cheng/">
            
                <a href="../shi-yong-jiao-cheng/">
            
                    
                    使用教程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../shi-yong-jiao-cheng/preparation-of-reference.html">
            
                <a href="../shi-yong-jiao-cheng/preparation-of-reference.html">
            
                    
                    比对索引构建
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../shi-yong-jiao-cheng/stereo-seq-ff.html">
            
                <a href="../shi-yong-jiao-cheng/stereo-seq-ff.html">
            
                    
                    Stereo-seq FF 分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../shi-yong-jiao-cheng/stereo-seq-ffpe.html">
            
                <a href="../shi-yong-jiao-cheng/stereo-seq-ffpe.html">
            
                    
                    Stereo-seq FFPE 分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html">
            
                <a href="../shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html">
            
                    
                    手动图像处理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../shi-yong-jiao-cheng/secondary-analysis.html">
            
                <a href="../shi-yong-jiao-cheng/secondary-analysis.html">
            
                    
                    数据再分析
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../shi-yong-jiao-cheng/shu-ju-ge-shi-zhuan-huan.html">
            
                <a href="../shi-yong-jiao-cheng/shu-ju-ge-shi-zhuan-huan.html">
            
                    
                    数据格式转换
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="./">
            
                <a href="./">
            
                    
                    算法原理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.6.1" data-path="gene-expression-algorithms.html">
            
                <a href="gene-expression-algorithms.html">
            
                    
                    Read processing algorithms
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="image-processing-algorithms.html">
            
                <a href="image-processing-algorithms.html">
            
                    
                    Image processing algorithms
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../gao-ji-she-zhi/">
            
                <a href="../gao-ji-she-zhi/">
            
                    
                    高级设置
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../gao-ji-she-zhi/analysis-with-gpu.html">
            
                <a href="../gao-ji-she-zhi/analysis-with-gpu.html">
            
                    
                    Analysis with GPU
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../gao-ji-she-zhi/expression-matrix-format.html">
            
                <a href="../gao-ji-she-zhi/expression-matrix-format.html">
            
                    
                    Expression matrix format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../gao-ji-she-zhi/image-related-record-format.html">
            
                <a href="../gao-ji-she-zhi/image-related-record-format.html">
            
                    
                    Image-related record format
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../cuo-wu-ma.html">
            
                <a href="../cuo-wu-ma.html">
            
                    
                    错误码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../release-notes.html">
            
                <a href="../release-notes.html">
            
                    
                    版本说明
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../shu-ju-ji.html">
            
                <a href="../shu-ju-ji.html">
            
                    
                    数据集
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" >
            
                <a target="_blank" href="https://www.stomics.tech/resources/FAQ">
            
                    
                    常见问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <a target="_blank" href="https://www.stomics.tech/service/new-StereoMap.html">
            
                    
                    StereoMap
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Read processing algorithms</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div id="anchor-navigation-ex-navbar"><i class="fa fa-navicon"></i><ul><li><span class="title-icon "></span><a href="#read-processing-algorithms"><b></b>Read processing algorithms</a></li><ul><li><span class="title-icon "></span><a href="#alignment--annotation"><b></b>Alignment &amp; Annotation</a></li><ul><li><span class="title-icon "></span><a href="#cid-mapping"><b></b>CID mapping</a></li><li><span class="title-icon "></span><a href="#rna-filtering"><b></b>RNA filtering</a></li><li><span class="title-icon "></span><a href="#mid-filtering"><b></b>MID filtering</a></li><li><span class="title-icon "></span><a href="#genome-alignment"><b></b>Genome Alignment</a></li><li><span class="title-icon "></span><a href="#annotation-to-transcriptome"><b></b>Annotation to transcriptome</a></li><li><span class="title-icon "></span><a href="#mid-correction"><b></b>MID correction</a></li></ul><li><span class="title-icon "></span><a href="#secondary-analysis"><b></b>Secondary analysis</a></li><ul><li><span class="title-icon "></span><a href="#dimensionality-reduction-"><b></b>Dimensionality reduction </a></li><li><span class="title-icon "></span><a href="#clustering-"><b></b>Clustering </a></li><li><span class="title-icon "></span><a href="#differential-expression-"><b></b>Differential expression </a></li></ul></ul></ul></div><a href="#read-processing-algorithms" id="anchorNavigationExGoTop"><i class="fa fa-arrow-up"></i></a><h1 id="read-processing-algorithms"><a name="read-processing-algorithms" class="anchor-navigation-ex-anchor" href="#read-processing-algorithms"><i class="fa fa-link" aria-hidden="true"></i></a>Read processing algorithms</h1>
<p><em><mark style="color:purple;">*The interpretation of the Algorithm part is only available in EN.</mark></em></p>
<p>Gene Expression Count during <code>SAW count</code>, for the FASTQ data from the Stereo-seq sequencing platform, includes the following analysis stages:</p>
<figure><a href="../img/assets/Work_with_reads.png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/Work_with_reads.png" alt=""></a><figcaption></figcaption></figure>

<p>Regarding the key steps of read alignment and annotation, a flowchart is used to illustrate.</p>
<figure><a href="../img/assets/Workflow_of_Alignment&amp;Annotation.png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/Workflow_of_Alignment&amp;Annotation.png" alt=""></a><figcaption></figcaption></figure>

<h2 id="alignment--annotation"><a name="alignment--annotation" class="anchor-navigation-ex-anchor" href="#alignment--annotation"><i class="fa fa-link" aria-hidden="true"></i></a>Alignment &amp; Annotation</h2>
<h3 id="cid-mapping"><a name="cid-mapping" class="anchor-navigation-ex-anchor" href="#cid-mapping"><i class="fa fa-link" aria-hidden="true"></i></a>CID mapping</h3>
<p>CID mapping requires FASTQs and a chip mask file, recording position information for sequencing reads. </p>
<p>Check the amount of Ns in Coordinate IDs:</p>
<ul>
<li>If there is 1 N base in CID, the N base will be replaced by <code>A/T/C/G</code>.</li>
<li>CIDs without N bases will be directly poured into the match pool.</li>
<li>CIDs with more than one N base will be discarded.</li>
</ul>
<p>In the absense of an N base, if a CID does not match to any positions, each base of the CID will replaced by the other three types iterately until a successful match. After the mapping, only the unique CID match will be retained for subsequent steps.</p>
<figure><a href="../img/assets/CID_mapping.png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/CID_mapping.png" alt=""></a><figcaption></figcaption></figure>

<h3 id="rna-filtering"><a name="rna-filtering" class="anchor-navigation-ex-anchor" href="#rna-filtering"><i class="fa fa-link" aria-hidden="true"></i></a>RNA filtering</h3>
<p>Before genome alignment, it is necessary to confirm that the reads entering the next step are cDNA sequences. Ideally, this part of the data only contains cDNA fragments, but there may be cases where the fragmented cDNA is too short or some non-cDNA fragments are detected.</p>
<p>Reads will be discarded if any of the following conditions are triggered:</p>
<ul>
<li>mapped to adapter sequences,</li>
<li>mapped to DNB sequences,</li>
<li>with a length of less than 30 after cutting out the poly-A sequence.</li>
</ul>
<p>The above three are collectively known as &quot;non-relevant short reads&quot;.</p>
<h3 id="mid-filtering"><a name="mid-filtering" class="anchor-navigation-ex-anchor" href="#mid-filtering"><i class="fa fa-link" aria-hidden="true"></i></a>MID filtering</h3>
<p>MID sequences will be filtered out if they match any of the following:</p>
<ul>
<li>having more than one base with quality &lt;= Q10,</li>
<li>having N bases &gt;= 1.</li>
</ul>
<h3 id="genome-alignment"><a name="genome-alignment" class="anchor-navigation-ex-anchor" href="#genome-alignment"><i class="fa fa-link" aria-hidden="true"></i></a>Genome Alignment</h3>
<p>To align reads to the genome with splicing awareness, SAW utilizes the <a href="https://github.com/alexdobin/STAR" target="_blank">STAR</a> aligner. Using a transcript annotation GTF/GFF file, the system classifies reads as exonic, intronic, or intergenic ones based on their alignment. If a read shares at least 50% of its overlap with an exon, it is considered exonic <code>XF:i:0</code>. If a sequence does not meet the criteria for exon but crosses an intron, it is called intronic <code>XF:i:1</code>. If it does not fit into either of the previous categories, it is called intergenic <code>XF:i:2</code>.</p>
<p>The exonic locus is given priority, and the read is deemed to be reliably mapped to the exonic locus with a MAPQ of 255 for reads that align to one exonic locus but also to one or more non-exonic loci.</p>
<h3 id="annotation-to-transcriptome"><a name="annotation-to-transcriptome" class="anchor-navigation-ex-anchor" href="#annotation-to-transcriptome"><i class="fa fa-link" aria-hidden="true"></i></a>Annotation to transcriptome</h3>
<p>In SAW, reads mapped to exonic and intronic regions are to be annotated, using the transcriptomic annotation file.</p>
<h4 id="remove-rrna"><a name="remove-rrna" class="anchor-navigation-ex-anchor" href="#remove-rrna"><i class="fa fa-link" aria-hidden="true"></i></a>Remove rRNA</h4>
<p>The preconditions for rRNA filtration are:</p>
<ul>
<li>switching <code>--rRNA-remove</code> on when running<code>SAW count</code>,</li>
<li>addition of rRNA information to the index files using <a href="../shi-yong-jiao-cheng/preparation-of-reference.html#for-star"><code>SAW makeRef</code></a>.</li>
</ul>
<p>Reads mapped to rRNA regions will have a tag of <code>XF:i:3</code>, and they will not move on to the next step.</p>
<h4 id="transcriptome"><a name="transcriptome" class="anchor-navigation-ex-anchor" href="#transcriptome"><i class="fa fa-link" aria-hidden="true"></i></a>Transcriptome</h4>
<p>SAW estimates whether there is a successful annotating record based on the position of each read mapped to the genome and whether the alignment is located in a gene region.</p>
<ul>
<li>When the alignment direction of the read on the genome is consistent with that of a gene and overlaps with the gene &gt;= 50% of the mapped length, the read will be considered to be annotated with the gene.</li>
<li>If a read is annotated to multiple genes, the one with the longest overlap length with the gene is selected as the final result of the read. When the overlap lengths are the same, the read is considered to be annotated unsuccessfully.</li>
</ul>
<figure><a href="../img/assets/Annotation.png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/Annotation.png" alt=""></a><figcaption></figcaption></figure>

<p>Annotating types are classified according to the following rules: </p>
<ul>
<li>If the overlap between read and exon is &gt;=50%, the read is considered to originate from the exonic region of the gene, otherwise, it originates from the intron region. </li>
<li>Reads overlapped with genes but have inconsistent directions are classified as antisense.</li>
<li>Reads that can be aligned to the genome but cannot be classified as gene or antisense are considered to be intergenic.</li>
</ul>
<h3 id="mid-correction"><a name="mid-correction" class="anchor-navigation-ex-anchor" href="#mid-correction"><i class="fa fa-link" aria-hidden="true"></i></a>MID correction</h3>
<p>At a position, if the MID counts of a certain gene &gt;= 5, they will be corrected. After sorting the MID counts of a specific gene in descending order, the numerical values are corrected following the fundamental principle that allows a Hamming distance of 1. After correction, a tag of <code>UB:Z:XXXXX</code> will be added to the record.</p>
<figure><a href="../img/assets/MID_correction.png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/MID_correction.png" alt=""></a><figcaption></figcaption></figure>

<h2 id="secondary-analysis"><a name="secondary-analysis" class="anchor-navigation-ex-anchor" href="#secondary-analysis"><i class="fa fa-link" aria-hidden="true"></i></a>Secondary analysis</h2>
<p>The secondary analysis, in <code>SAW count</code> and <code>SAW realign</code>, are performed using Stereopy. The procedure includes 6 main parts: </p>
<ul>
<li>Preprocess gene expression data from the tissue coverage region (normalize, logarithmize, identify highly variable genes, and scale each gene).</li>
<li>Reduce the dimensionality of the data by running PCA.</li>
<li>Compute the neighborhood graph and embed the neighborhood graph using UMAP.</li>
<li>Clustering by Leiden algorithm.</li>
<li>Perform differential expression analysis, using the t-test to find marker features.</li>
<li>Output analysis result file in AnnData H5AD and marker feature CSV.</li>
</ul>
<h3 id="dimensionality-reduction-"><a name="dimensionality-reduction-" class="anchor-navigation-ex-anchor" href="#dimensionality-reduction-"><i class="fa fa-link" aria-hidden="true"></i></a>Dimensionality reduction <a href="#dimen-reduction" id="dimen-reduction"></a></h3>
<p><strong>PCA</strong>: Spatiotemporal transcriptome data often contain thousands of genes, making the data high-dimensional and challenging to analyze. Principal Components Analysis (PCA) reduces dimensionality by transforming the data into a set of principal components (PCs) that capture the most significant variance.</p>
<p><strong>UMAP</strong>: SAW supports Uniform Manifold Approximation and Projection (UMAP), which is a popular non-linear dimensionality reduction technique that is particularly useful for visualizing high-dimensional data in a low-dimensional space. In the context of spatiotemporal transcriptome data analysis, it is beneficial to capture both local and global structures as it facilitates the interpretation of complex datasets. UMAP coordinates are available in the pipeline output H5AD, as well as being displayed in the HTML report and StereoMap.</p>
<h3 id="clustering-"><a name="clustering-" class="anchor-navigation-ex-anchor" href="#clustering-"><i class="fa fa-link" aria-hidden="true"></i></a>Clustering <a href="#clustering" id="clustering"></a></h3>
<p>SAW uses Leiden algorithm for clustering spots by expression similarity, operating in the PCA representation.</p>
<p><strong>Leiden:</strong> an algorithm for network community detection, which is particularly important in bioinformatics analysis, especially in the analysis of spatial transcriptomic datasets. It is an enhanced version of Louvain&apos;s method, developed to address its potential instability and provide higher resolution and a more robust community structure. In bioinformatics, the primary roles and benefits of Leiden algorithm can be summarized as follows:</p>
<ul>
<li>Improved resolution and stability: the algorithm can effectively identify smaller community structures, which is crucial for understanding cellular heterogeneity and subtle changes in complex biological processes. Compared with Louvain&apos;s method, Leiden can offer more consistent and stable results across multiple runs.</li>
<li>Efficient cell type identification: in the analysis of spatial transcriptomic sequencing data, Leiden clustering can assist researchers in identifying various cell types or states from thousands of cells. By constructing a network of cell similarities, Leiden algorithm can cluster similar cells together to form distinct groups, which typically correspond to various biological functions or cell types.</li>
<li>Powerful community structure detection: Leiden algorithm ensures the quality of clustering by optimizing a modularity function, which helps reveal complex biological patterns and potential regulatory networks in samples. It is particularly important for understanding the interactions and signal transduction pathways between cells.</li>
<li>Applicable to large-scale datasets: with the advancement of single-cell sequencing technology, the size of datasets is increasing. The Leiden algorithm&apos;s computational efficiency allows it to handle large-scale datasets while keeping computational costs low.</li>
<li>Flexibility and scalability: it is not only applicable to spatial transcriptomic data but can also be extended to other types of bioinformatic data, such as protein interaction networks, metabolic networks, etc.</li>
</ul>
<h3 id="differential-expression-"><a name="differential-expression-" class="anchor-navigation-ex-anchor" href="#differential-expression-"><i class="fa fa-link" aria-hidden="true"></i></a>Differential expression <a href="#diff-exp" id="diff-exp"></a></h3>
<p>To identify genes whose expression is specific to each cluster for each gene and each cluster, whether the in-cluster mean differs from the out-of-cluster mean. </p>
<p><strong>t-test:</strong> the method used in the <code>find_marker_genes</code> of Stereopy package is based on classical statistical principles to identify differentially expressed genes between groups of cells.</p>
<ul>
<li>Grouping cells: cells are grouped based on a categorical variable, such as cluster labels obtained from the Leiden clustering algorithm. For example, cells in cluster A are compared to cells in cluster B.</li>
<li>Expression levels: for each gene, the expression levels are compared between the two groups of cells.</li>
<li>Calculating the t-statistic: the t-statistic is calculated using the formula:</li>
</ul>
<p></p><figure><a href="../img/assets/image%20(5).png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/image (5).png" alt=""></a><figcaption></figcaption></figure><p></p>
<ul>
<li>Degrees of freedom: the degrees of freedom (df) for the test are calculated, often using a formula that takes into account the sample sizes and variances of both groups. A common formula is:</li>
</ul>
<p></p><figure><a href="../img/assets/5b762e050b1ecae283f5befc086052c.png" data-lightbox="d06a4209-d2bf-44e1-9c59-e926f5ee97e1" data-title=""><img src="../img/assets/5b762e050b1ecae283f5befc086052c.png" alt=""></a><figcaption></figcaption></figure><p></p>
<ul>
<li>P-value calculation: the t-statistic is then compared to the t-distribution with the calculated degrees of freedom to obtain a p-value. This p-value indicates the probability that the observed difference in means could have occurred by chance.</li>
<li>Multiple testing correction: given that thousands of genes are tested simultaneously, multiple testing correction methods (such as Benjamini-Hochberg) are applied to control the false discovery rate (FDR).</li>
</ul>
<p>The t-test method in <code>find_marker_genes</code> leverages the principles of hypothesis testing to identify genes that are significantly differentially expressed between predefined groups of cells. This method provides a straightforward and statistically sound approach to uncovering key marker genes that distinguish between cell types or conditions, facilitating deeper insights into the underlying biology of the dataset.</p>
<footer class="page-footer"><span class="copyright">&#xA9; 2024 STOmics Tech. All right reserved.</span><span class="footer-modification">Modiftied: 
2024-07-22 15:30:04
</span></footer><script>document.addEventListener("DOMContentLoaded", function() {lightbox.option({"resizeDuration":200,"wrapAround":true});})</script>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: 算法原理">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="image-processing-algorithms.html" class="navigation navigation-next " aria-label="Next page: Image processing algorithms">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Read processing algorithms","level":"1.6.1","depth":2,"next":{"title":"Image processing algorithms","level":"1.6.2","depth":2,"path":"algorithms/image-processing-algorithms.md","ref":"algorithms/image-processing-algorithms.md","articles":[]},"previous":{"title":"算法原理","level":"1.6","depth":1,"path":"algorithms/README.md","ref":"algorithms/README.md","articles":[{"title":"Read processing algorithms","level":"1.6.1","depth":2,"path":"algorithms/gene-expression-algorithms.md","ref":"algorithms/gene-expression-algorithms.md","articles":[]},{"title":"Image processing algorithms","level":"1.6.2","depth":2,"path":"algorithms/image-processing-algorithms.md","ref":"algorithms/image-processing-algorithms.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["expandable-chapters-small","anchor-navigation-ex","-insert-logo","tbfed-pagefooter","hide-element","code-optimize","katex","hints","tabs","lightbox","-lunr","-search","search-plus","add-index-html","livereload"],"root":".","styles":{},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"© 2024 STOmics Tech.","modify_label":"Modiftied: ","modify_format":"YYYY-MM-DD HH:mm:ss"},"livereload":{},"hints":{"danger":"fa fa-exclamation-circle","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"hide-element":{"elements":[".gitbook-link"]},"katex":{},"add-index-html":{"myConfigKey":"it's the default value","elements":["a"]},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"anchor-navigation-ex":{"associatedWithSummary":true,"float":{"floatIcon":"fa fa-navicon","level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"mode":"float","multipleH1":true,"pageTop":{"level1Icon":"fa fa-hand-o-right","level2Icon":"fa fa-hand-o-right","level3Icon":"fa fa-hand-o-right","showLevelIcon":false},"printLog":true,"showGoTop":true,"showLevel":false},"lightbox":{"jquery":true,"includeJQuery":true,"sameUuid":true,"options":{"resizeDuration":200,"wrapAround":true}},"expandable-chapters-small":{},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":[]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"code-optimize":{"copyButtons":true,"showLines":true},"tabs":{},"search-plus":{}},"theme":"default","author":"","pdf":{"pageBreaksBefore":"/","headerTemplate":null,"paperSize":"a4","margin":{"right":62,"left":62,"top":36,"bottom":36},"fontSize":12,"fontFamily":"Arial","footerTemplate":null,"chapterMark":"pagebreak","pageNumbers":false},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"isbn":"","variables":{},"title":"SAW User Manual","language":"zh-hans","links":{"gitbook":false,"sharing":{"google":false,"facebook":false,"twitter":false,"all":false}},"gitbook":"3.2.3","description":null,"extension":null},"file":{"path":"algorithms/gene-expression-algorithms.md","mtime":"2024-07-22T07:30:04.348Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2024-07-22T07:44:47.860Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters-small/expandable-chapters-small.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-element/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code-optimize/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-tabs/bootstrap.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lightbox/js/lightbox.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-add-index-html/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

