{"./":{"url":"./","title":"概览","summary":"Homepage of SAW for software introduction","keywords":"","body":"概览SAWSAW工具是什么?数据分析使用教程概览 SAW SAW工具是什么? Stereo-seq Analysis Workflow (SAW) 是一套生信分析流程软件包，整合了多个Stereo-seq空间组基因表达分析工具。它可以将测序数据映射到组织切片上的空间位置，量化特征表达，直观地呈现空间表达分布。SAW 处理来自 Stereo-seq 测序平台的数据，结合显微镜拍照图像，生成空间特征表达矩阵。分析人员可以将SAW标准分析流程输出的文件结果作为起点，开展下游生信分析。 软件下载download-center.md快速开始getting-started数据下载Broken link 数据分析 输入文件准备 SAW 分析的输入文件分析流程如何运行 SAW 分析流程输出结果探究 SAW 分析的输出结果 使用教程 SAW for Stereo-seq FF学习如何使用 FF (fresh fozen) 样本数据开展 SAW 分析SAW for Stereo-seq FFPE学习如何使用 FFPE (formalin-fixed paraffin-embedded) 样本数据开展 SAW 分析With manually processed files学习如何使用 StereoMap 输出的手动处理图像重启分析 ©2024 华大三箭齐发科技有限责任公司保留所有权利。 本产品仅用于研究，不用于诊断。 本手册上的内容可能全部或部分受到适用的知识产权法的保护。华大三箭齐发科技有限责任公司和/或相应权利主体依法拥有其知识产权，包括但不限于商标权、版权等。 华大三箭齐发科技有限责任公司不授予或暗示使用我们或任何第三方的任何版权内容或商标（注册或未注册）的权利或许可。未经本单位书面同意，任何人不得擅自使用、修改、复制、公开传播、更改、分发或发布本手册的程序或内容，不得使用或利用设计技巧使用或占有本单位或本单位关联方的商标、标识或其他专有信息（包括图像、文本、网页设计或形式）。 此处的任何内容都无意于或应被理解为对此处列出或描述的任何产品的性能的任何保证、表达或暗示。适用于本文所列任何产品的任何和所有保证均载于购买该产品所附的适用销售条款和条件。华大三箭齐发科技有限责任公司不做任何保证，并在此声明对本文所述任何第三方产品或协议的使用不做任何保证。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"getting-started/":{"url":"getting-started/","title":"快速开始","keywords":"","body":"快速开始初次接触SAW?SAW使用介绍快速开始 初次接触SAW? SAW是什么？Stereo-seq Analysis Workflow (SAW) 是一套生信分析流程软件包，整合了多个Stereo-seq空间组基因表达分析工具。它可以将测序数据映射到组织切片上的空间位置，量化特征表达，直观地呈现空间表达分布。SAW 处理来自 Stereo-seq 测序平台的数据，结合显微镜拍照图像，生成空间特征表达矩阵。分析人员可以将SAW标准分析流程输出的文件结果作为起点，开展下游生信分析。 For further details regarding STOmics and SAW, click the title. SAW使用介绍 下载和安装 软件下载 > 安装 > 数据准备 输入概览 > 分析流程 SAW 参数命令 > SAW count > SAW realign > 其他分析辅助流程 > 运行分析 Stereo-seq FF > Stereo-seq FFPE > 接入手动图像数据 > 输出结果 输出概览 > HTML 报告 > 其他信息 时空词汇 > 算法原理说明 > 文件格式详解 > GPU使用 > Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"getting-started/introduction.html":{"url":"getting-started/introduction.html","title":"软件介绍","keywords":"","body":"软件介绍什么是SAW软件?分析流程显微镜图像标准分析流程软件介绍 什么是SAW软件? STOmics 转录组技术由 STOmics Tech 开发，集成了专业设备和试剂盒，可实现高通量空间转录组测序，该技术可在组织和细胞维度上实现超高时空分辨率。Stereo-seq 芯片的优势在于可以捕获组织和细胞维度上的特征表达信息，此功能助力解析生物体中的时间变化和分子调控网络，研究转录变化的动态过程。 Stereo-seq workflow SAW 是专门为时空转录组测序数据而设计的生信分析流程软件包，通过复原组织样本中每个捕获转录本 (Molecular ID，MID) 的空间位置 (Coordinate ID，CID) 和其对应的表达水平，来实现空间维度的特征表达信息提取。从海量数据集中提取高精度和高密度生物学信息。 现在，SAW 工具包支持 FFPE 和 FF 组织样本的分析，可以对遗传发育、疾病病理和临床转化等领域的课题项目进行更多探索性的研究。 分析流程 SAW 提供以下分析流程用于处理 Stereo-seq 数据： SAW count 是 SAW 的核心分析流程，可以兼容大多数 Stereo-seq FF 和 Stereo-seq FFPE 数据。输入数据包括芯片 mask 文件、测序 FASTQ、参考基因组和显微镜拍照图像。流程输出 Stereo-seq 芯片的空间表达矩阵和分析结果。 SAW realign 是专门用于处理手动图像数据 (.tar.gz) 的辅助分析流程，使用调整后的图像重启分析，主要适用于自动分析流程的输出结果不够完美，或者图像QC结果失败的数据。 其他辅助分析流程 主要应用于索引文件构建、下游分析和文件格式转换。 显微镜图像 SAW 使用显微镜拍照图像作为组织形态学的参考，协助分析流程，实现特征表达矩阵的空间可视化。SAW 分析中提供的图像类型包括荧光和 H\\&E 染色图像。详细说明请参阅显微镜图像模块。 标准分析流程 大多数情况下，SAW count 分析流程会自动完成显微镜图像与特征表达矩阵之间的配准。如果图像和矩阵间的自动配准不成功，或是QC失败的图像数据，可以在 StereoMap 中对其图像进行手动处理。更多关于图像手动处理的介绍，请参阅 SAW realign 使用教程。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"getting-started/glossary.html":{"url":"getting-started/glossary.html","title":"词汇表","keywords":"","body":"词汇表STOmics 词汇说明词汇表 为更加清晰、方便地理解 STOmics Tech 的分析工具使用，我们整理了常见的 STOmics 词汇说明。 STOmics 词汇说明 TermDefinitionStereo-seq Chip TUsed in generating a spatially-resolved 3’ RNA library from biological tissue sections, only for fresh frozen (FF) samples currently.Stereo-seq Chip NUsed in generating a spatially-resolved 3’ RNA library from biological tissue sections, only for formalin-fixed paraffin-embedded (FFPE) samples currently.DNBDNB NanaBall. DNA nanoball is the product of rolling-circle amplification (RCA) that is linearly amplified from the original circular single-stranded DNA template. DNB is the smallest capture unit on the Stereo-seq Chip.Resolution/PitchAlso called the chip resolution/pitch. A center-to-center distance of two adjacent DNBs.CIDCoordinate ID. Spatial position identifier, the artificially synthesized barcode sequence unique to each spot on the Stereo-seq Chip.MIDMolecular ID. A molecular identifier is an artificially synthesized sequence that is unique to each mRNA molecule captured from the sample. It helps differentiate the number of reads contributed by mRNA expression levels due to amplification. Two copies of native transcripts from the same molecule captured on one DNA nanoball will result in two independent reads with the same CID but different MID. In contrast, two reads with identical CID and MID originated from the same transcript but were amplified.GEFGene expression file (GEF) is a data management and storage format designed to support multidimensional datasets and high computational efficiency. Stereo-seq analysis workflow generates bin GEF and cellbin GEF files.GEMGene expression matrix (GEM) stores gene spatial expression data. SAW generates multiple gene expression matrix files in the workflow, the basic format requires four columns with a header row that shows the column names.Bin &Bin sizeBin (or Square Bin) is the analysis unit on the expression heatmap. A bin is a fixed-sized square in which the expression value in this square is accumulated. Bins are not overlapped. The value followed by \"Bin\" represents the square side length. For bin1, each DNB on the Stereo-seq Chip is shown as a spot, which means one spot only contains the data from one DNB. BinN means one spot that aggregates data from N×N DNBs. For example, a spot of bin5 covers data from 5*5 DNBs.CellBinA cell bin stands for a region of cell on the expression heatmap recognized by the algorithm (either from image or heat map). Expression within a cell bin region is accumulated, and neighbor cell bins are not overlapped. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"download-center.html":{"url":"download-center.html","title":"下载中心","keywords":"","body":"下载中心系统配置要求软件下载SAW 8.0.1 (7月8日, 2024)SAW-8.0.0 软件亮点参考基因组下载解压安装下载中心 请根据下面的提示步骤，在计算环境中安装SAW软件： 检查系统配置要求 下载SAW 安装SAW 下载参考基因组（可选择） 系统配置要求 SAW分析软件包在Linux系统上被解压和安装，计算环境需满足下列基本要求： 8-core Intel or AMD processor (>24 cores recommended) 128GB RAM (>256GB recommended) 1TB free disk space or higher 64-bit CentOS/RedHat 7.8 or Ubuntu 20.04 软件下载 SAW 8.0.1 (7月8日, 2024) Download for Linux 64-bit (tar.gz)File size: 3.0 GBmd5sum: afd82ed454f5ab06c8f24ff2572f10b9 ```bash curl -o saw_8.0.1.tar.gz \"https://cdn-newfile.stomics.tech/saw-8.0.1.tar.gz\"sh ``` 或： ```bash wget -O saw_8.0.1.tar.gz \"https://cdn-newfile.stomics.tech/saw-8.0.1.tar.gz\" ``` SAW-8.0.0 软件亮点 SAW本次更新以单体可执行程序.tar.gz 文件的形式发布，可以直接在系统上解压，无需额外配置计算环境。由于它已经集成并预编译所有内置软件所需的依赖项，因此可以在大多数Linux环境直接运行。 整合并简化流程使命令编写和完成分析变得更加便捷。这些流程模块包括： SAW count：核心流程模块，用于根据计算基因表达读数和Stereo-seq芯片生成表达矩阵。 SAW makeRef：根据参考基因组数据构建索引文件。 SAW checkGTF：检查注释文件的格式。 SAW realign：使用手动处理的文件重新启动分析。 SAW reanalyze：重新执行下游分析。 SAW convert：支持文件格式转换。 SAW支持从FFPE（formalin-fixed paraffin-embedded）样本中获取基因表达信息。在运行SAW count时，通过将--kit-version设置为\"Stereo-seq N FFPE Kit V1.0\"来实现。对于FFPE分析，需要使用SAW v8.0.0或更高版本。 基于 FFPE 组织样本，可以在运行 SAW count 时通过使用--microorganism-detect 参数来开启微生物分析，需要准备必要的参考数据集。更多信息请参阅参考基因组准备。 SAW还升级了读取比对和注释的生物信息学工作流程，以适应FFPE数据集。 在注释过程中，默认情况下会同时使用唯一比对 reads 和 多比对 reads 中的最优比对进行基因定量分析。如果分析人员只关注唯一比对 reads，可以使用--uniquely-mapped-only参数。 新的空间基因表达矩阵通过唯一基因ID进行标识，同时依然记录基因名称信息。 在图像相关的分析部分，软件对图像处理性能进行了优化。同时，在运行SAW count时，支持以TIFF格式直接输入显微镜拼接大图图像。 SAW 分析中新增了基于 Leiden 聚类进行的差异表达分析，marker features 被记录在AnnData格式的 H5AD 和 CSV 文件中，并在HTML报告和StereoMap中展示。 HTML 报告中的图表是交互式的，新增微生物分析页面，增加了 marker features 结果表格。 重新整理输出目录结构，使得结果文件更加清晰易查找，并将中间环节文件和日志放入指定的文件夹中。 输出可视化压缩文件visualization.tar.gz，其中包含.stereo统领文件，用于记录 SAW 分析流程的基本信息和 StereoMap 所需的字段信息。 版本说明 > 参考基因组下载 SAW 提供小鼠的参考基因组下载，请跳转到数据集部分，demo数据同样可以从中获取。 解压安装 SAW 此版本为单体可执行程序的.tar.gz 文件，可以直接在系统上解压，无需额外配置计算环境。由于它已经集成并预编译所有内置软件所需的依赖项，因此可以在大多数Linux环境直接运行。 注意，参考基因组和 demo 数据集需要单独下载。 Step 1 - 下载 SAW 软件包并解压到合适的目录位置，文档示例假设 /saw/package 为运行目录。 $ cd /saw/package [download the SAW package tar.gz from the Software download part] $ tar -xzf saw-8.0.1.tar.gz Step 2 - 下载参考基因组文件并解压到合适的目录位置。文档示例假设 /saw/reference 为运行目录。 $ cd /saw/reference [download the reference data from the Reference download part] $ tar -xzf reference-mm10.tar.gz # tar -xzf reference-mm10-with-rRNA.tar.gz Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/":{"url":"analysis/","title":"运行分析","keywords":"","body":"运行分析输入文件分析流程输出结果运行分析 输入文件 准备 SAW 分析的输入文件 分析流程 如何运行 SAW 分析流程 输出结果 探究 SAW 分析的输出结果 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/inputs/":{"url":"analysis/inputs/","title":"输入文件","keywords":"","body":"输入文件SAW count 输入文件SAW realign 输入文件输入文件 在运行 SAW 分析流程之前，应提前准备好输入文件。启动分析的输入文件因生化实验操作、测序数据类型、选择的 SAW 分析流程等因素会有所不同。 SAW count 输入文件 准备输入文件、分析流程和参数设置时，请考虑以下事项： 使用哪个分析流程？ SAW count 是将测序 FASTQ（数据）转换为空间特征表达矩阵（信息）的核心分析流程。在启动标准分析之前，应当调用 SAW makeRef 辅助流程构建参考基因组的索引文件，用于 read 的比对和注释。 什么是时空芯片？ Stereo-seq Chip T/N 芯片是时空转录组测序的载体，与 FASTQ 数据密切相关，时空芯片涉及的主要信息包括 SN（芯片序列号）和记录 CID 信息（Coordiante ID）的芯片 mask 文件。 如何获取芯片 mask 文件？ 时空芯片 mask 文件对于SAW count 分析流程的开启至关重要，可以从 STOmics Cloud 上的在线项目文件中获取。学习相关下载教程，可直接将芯片 mask 下载 Linux 服务器上。 如何选择图像？ SAW 通常需要显微镜拍照图像来作为样本组织的解剖结构参考图，是否输入图像（支持TIFF 或 .tar.gz格式）取决于具体的分析需求。 如何确认一些重要的参数信息？ --kit-version 与产品试剂盒的版本相关，可在生化实验操作手册中找到对应信息，通过该参数程序可以自动识别流程中的内置参数设置，例如，“Stereo-seq T FF V1.2”表示对 Stereo-seq Chip T 芯片上的 FF（新鲜冷冻）组织样本开展分析。 --sequencing-type 时空测序生成的报告相关，例如，“PE100_50+100” 表示双端测序长度为100bp的，read 1 循环50次，read 2 循环100次。 SAW realign 输入文件 是否已经运行过一次SAW count标准分析流程？ 将SAW count 输出 visualization.tar.gz 可视化压缩文件下载至本地后，解压后输入到 StereoMap 进行可视化查看和手动图像处理。需要注意，此次SAW count 的输出结果将在后续手动处理中发挥重要作用。 是否已经完成图像手动处理？ 经过一系列手动调整后，StereoMap 的 Image Processing 模块会生成一个“重新调整”后的图像 .tar.gz 文件，将该文件传给 SAW realign 的 --realigned-image-tar 参数，重启分析流程。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/inputs/chip-mask.html":{"url":"analysis/inputs/chip-mask.html","title":"芯片 mask","keywords":"","body":"芯片 maskStereo-seq 芯片是什么？如何获取芯片 mask 文件？芯片 mask Stereo-seq 芯片是什么？ Stereo-seq Chip 是STOmics Tech独立开发的一项技术，用于在生命科学领域研究基因表达、细胞变化和生命发展。这项技术利用了一种名为\"Stereo-seq\"的时空转录组技术，其捕获组织中的mRNA，并使用时空条形码（Coordinate ID，CID）恢复其空间位置，以统计空间维度的特征表达信息。.png>) 时空组学技术的突破在于其亚细胞分辨率和厘米级的视野。该技术可以达到500纳米的分辨率，意味着一个单独的细胞可以被捕获到400个像素。通过对生命发展中的基因和细胞变化进行高精度的时空维度分析，时空组学为理解认知器官结构、生命发展、人类疾病和物种进化提供了新的研究途径。 如何获取芯片 mask 文件？ Stereo-seq Chip 时空芯片的 mask 文件对于SAW count分析至关重要，可以在 STOmics Cloud 的在线项目文件中获取。参考下载教程，可将芯片 mask 文件直接下载至 Linux 集群系统。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/inputs/fastqs.html":{"url":"analysis/inputs/fastqs.html","title":"测序 FASTQ","keywords":"","body":"测序 FASTQ概览质量值记录存储类型名称前缀规范测序 FASTQ 概览 FASTQ 是一种常见的存储测序和质量评估信息的数据格式。Stereo-seq 的测序方法是双端测序 （paired-end, PE）。Read 1 包含坐标信息（Coordinate ID，CID）和分子信息（Molecular ID，MID），read 2 包含探针捕获的 RNA 测序数据。在多样本测序过程中，会添加一个额外的样本条形码（sample barcode）序列来识别样本。当测序数据不准确时，会进行过滤，从 read 1 及其配对的 read 2 中移除低质量的 MID 序列（MID中包含 N 碱基或有两个及两个以上碱基的质量值低于10）。然后，过滤后的 read 2 的 read ID 后会附加上 CID 和 MID 信息。Read 2 中包含 RNA 数据的单链被写入 FASTQ 格式的文件中，作为原始测序数据，注意，此时已经去除了样本条形码。 质量值记录 Q40 FASTQ 和 Q4 FASTQ 是记录原始测序数据的碱基质量值的两种方式。两者区别为质量评估体系不同，Q40 采用了41个质量值描述测序碱基的质量，Q4 中只有4个质量值。 存储类型 成对 FASTQ 和成组 FASTQ 是原始测序数据的两种可选输出格式。 注意：FASTQ 中的质量值记录方式与其文件的存储类型无关。 成对的 FASTQs 包括一对 read 文件，read 1 用于记录 CID、MID 信息，read 2 用于记录探针捕获的 RNA 测序数据。下面是 成对 FASTQ 的一个示例： # read 1 @E100026571L1C001R00300000000/1 TGTCCAACGGAGACGGCTCCGACAAGGCACTGGCA + >DG;*EFE8*G/3E@2:F0-GBGG188F=E53FEF5>FGF@,0ADE9CEAG2GBE@HF3EA 成组 FASTQ 格式通常为一个 read 文件，但其脱身于一个组，每组数据由16或64个单独的 read 文件构成。read 文件中的 read ID 以“@”开头，包括 read 名称和经过编码的 CID 和 MID 信息。序列部分包含捕获的 RNA 测序数据。由于文件为组合格式，和并且减少了评估的质量值数量，存储空间大大减少。下面是成组 FASTQ 的一个示例： @FP300000513L1C002R00400000218 CE242DF29A57 97D26 GTGTAGTGAACCCCATGGTAGTTTTCTGATTGTTGTTAAAAAAAATGACTTAACATATTACATGGACACTCAATAAAAATGTTTTATTTCCTGTTGAAAA + FFFFFFFFFFFF8F8FFFFFFFFFFFFF8FFFFFFFFF8FF8FFF8FFFFFFF,FFFFFFFFFFF8FFFFFF8F8F,F8FFFFFF,FFFFFFFFFF,FFF 名称前缀规范 Stereo-seq 的原始测序数据根据存储类型分为两类，它们的文件名有自己的规则。--fastqs 参数需要一个或多个文件夹路径，文件夹下的所有 FASTQ 文件都会进入到 SAW count 分析流程中，所以，请注意你的输入目录。 对于成对 FASTQ，文件名前缀分别表示测序 slide、lane 编号和 read 索引，标准的成对 FASTQ 文件遵循以下命名方式： __.fq.gz。 成对 FASTQ 文件和目录结构类似： /saw/datasets/Q40_fastqs ├── TestFlowcell01_L01_read_1.fq.gz ├── TestFlowcell01_L01_read_2.fq.gz ├── TestFlowcell01_L03_read_1.fq.gz ├── TestFlowcell01_L03_read_2.fq.gz └── ... 对于成组 FASTQ，文件名前缀表示测序流 slide、lane 编号、样本条形码和拆分索引编号，标准成组 FASTQ 文件遵循以下命名方式：___.fq.gz. 由于成组 FASTQ 数据是拆分后进行存储的，需要以组为单位被使用，每组包含 16 或 64 个文件。 成组 FASTQ 文件和目录结构类似： /saw/datasets/Q4_fastqs ├── TestFlowcell02_L01_25_1.fq.gz ├── TestFlowcell02_L01_25_2.fq.gz ├── TestFlowcell02_L01_25_3.fq.gz ├── TestFlowcell02_L01_25_4.fq.gz ├── TestFlowcell02_L01_25_5.fq.gz ├── TestFlowcell02_L01_25_6.fq.gz ├── TestFlowcell02_L01_25_7.fq.gz ├── TestFlowcell02_L01_25_8.fq.gz ├── TestFlowcell02_L01_25_9.fq.gz ├── TestFlowcell02_L01_25_10.fq.gz ├── TestFlowcell02_L01_25_11.fq.gz ├── TestFlowcell02_L01_25_12.fq.gz ├── TestFlowcell02_L01_25_13.fq.gz ├── TestFlowcell02_L01_25_14.fq.gz ├── TestFlowcell02_L01_25_15.fq.gz ├── TestFlowcell02_L01_25_16.fq.gz └── ... 在SAW count分析流程中，成对和成组的 FASTQ 测序数据不能混用。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:29:11 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/inputs/images.html":{"url":"analysis/inputs/images.html","title":"显微镜图像","keywords":"","body":"显微镜图像类型和格式核染色图像核染色 + 免疫荧光图像H\\&E图像图像类型和格式显微镜图像 类型和格式 SAW 支持三种组合的显微镜图像输入: 核染色图像 核染色 + 免疫荧光图像 H\\&E染色图像 核染色图像 核染色在组织切片中标记细胞没有偏差，对于确定组织区域和细胞位置非常有价值。STOmics 的研发团队比较和测试了多种商业化的染色试剂，发现 ssDNA 染色对下游 mRNA 捕获率的影响最小， DAPI 染料是一种常用的核染色剂，对染色细胞核具有高度特异性，可以与其它荧光试剂一起使用。Stereo-seq 实验流程和生信分析工具同时兼容了 ssDNA 和 DAPI 两种核染色方法，这两种染色方法都能够可视化展示轨迹线。 ssDNA 核染色 + 免疫荧光图像 免疫荧光（IF）是一种广泛使用的基于图像，可视化展示细胞中蛋白质组的亚细胞分布的技术。例如，细胞核可以用DAPI染色，而T细胞可以通过CD3识别。多重免疫荧光（mIF）可以标记在组织切片上通过荧光显微镜同时扫描。Stereo-seq生化流程和生信分析工具同时支持DAPI和最多6个用户定义的IF兼容，从而实现对组织样本的更多空间研究。 DAPI APAK3_IF TESK2_IF H\\&E图像 苏木素-伊红（H\\&E染色）染色是一种常用的组织染色方法，被称为医学诊断和病理学的研究的金标准。苏木素主要染色细胞核呈现蓝紫色，而伊红主要以不同深浅的粉红色染色细胞质和细胞外基质。通过Stereo-seq生成的空间表达矩阵与H\\&E染色图像相结合，可以将细胞的形态与空间定位的特征表达关联起来。组织学图像和特征矩阵结合的共表达分析增加了组织切片所能提供的信息量。 H&E 图像类型和格式 如下为 StereoMap 和 SAW 支持的数据格式说明： 图像类型图像格式放大倍率Stereo-seq 芯片尺寸核染色图像，比如：ssDNA或者 DAPI8 或 16 位的单张灰度图像10X核染色+免疫荧光图像比如：DAPI +最多 6 个IF的图像8 或 16 位的单张灰度图像10X苏木精-伊红（H&E）染色图像24位深的彩图10X Stereo-seq 芯片表面具有周期性的轨迹线（水平和垂直轨迹线），在空间表达的热图上会显示为狭窄的线条，因轨迹线区域是没有捕获探针的，可以辅助矩阵跟图像的对齐。为最大程度地减小其对下游 mRNA 捕获率的影响并提高显微镜图像中轨迹线的可见性，设计了 Stereo-seq 技术的组织染色和成像标准操作规程（SOP）。因在基因热图和显微镜图像上同时可以看到这些轨迹线，因此这些线条可以用作图像对齐的位置标记。 以下是图像和热图上的轨迹线示例。 展示的图像已经过调整，以便轨迹线可以清晰的可视化。 荧光图像上的轨迹线 彩色图像上的轨迹线 表达热图上的轨迹线 轨迹线为黑色线条 轨迹线为浅白色线条 轨迹线为黑色线条 SAW 软件嵌入了自动化图像处理算法，用于识别组织和细胞的边界，并在Stereo-seq 芯片上检测轨迹线，以便将图像与特征表达矩阵对齐。如果无法检测到轨迹线或组织/细胞边界不清晰，可能需要手动处理协助。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/pipelines/":{"url":"analysis/pipelines/","title":"分析流程","keywords":"","body":"分析流程核心分析流程辅助分析流程分析流程 SAW 软件中的分析流程是对子程序模块的整合，每个程序模块都能够独立地特定的任务，以此满足不同用户场景的分析需求。 核心分析流程 SAW count 是分析软件包的核心部分，支持处理绝大部分的 Stereo-seq FF 和 Stereo-seq FFPE 的数据。输入文集包括芯片 mask 文件、测序 FASTQ 、参考基因组和显微镜图像，输出空间特征表达矩阵和下游分析结果。 辅助分析流程 辅助分析流程包含： SAW makeRef: 构建参考基因组的索引文件，需要 GTF/GFF 注释文件和 FASTA 基因组文件，以及包含特定、rRNA 信息的 FASTA 文件； SAW chechGTF: 检查 GTF/GFF 注释文件是否为标准格式，在 SAW count 流程中会被自动调用。此外，可以从 GTF/GFF 中提取特定的注释信息； SAW realign: 接回 StereoMap 手动处理后生成的图像 .tar.gz 文件，重启分析流程； SAW reanalyze: 进行数据再分析，包含聚类分析、矩阵套索和差异表达分析； SAW convert: 提供数据格式转换工具。 of which the purpose is to support the main pipeline SAW count and ensure smooth, convenient processing of the entire analysis. 辅助分析流程主要是为了支持 SAW 软件的正常运行，尽可能满足用户分析的使用场景，确保整个分析流程的顺利开展。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/pipelines/saw-can-shu-ming-ling.html":{"url":"analysis/pipelines/saw-can-shu-ming-ling.html","title":"SAW 参数命令","keywords":"","body":"SAW 参数命令SAW countSAW makeRefSAW checkGTFSAW realignSAW reanalyzeSAW convertMatrix relatedImage relatedSAW 参数命令 可在命令行输入saw --help | -h，查看具体分析流程和参数设置信息，通过 saw --version 检查软件版本信息。 SAW count 将时空转录组测序数据转换为空间特征表达矩阵。 运行方式: saw count [Parameters] --id --sn --omics --kit-version --sequencing-type --reference --image --fastqs saw count -h | --help ParameterDescription--id (Optional, default to None) A unique task id ([a-zA-Z0-9_-]+) which will be displayed as the output folder name and the title of HTML report. If the parameter is absent, --sn will play the same role.--sn (Required, default to None) SN (serial number) of the Stereo-seq chip.--omics (Required, default to \"transcriptomics\") Omics information.--kit-version (Required, default to None) The version of the product kit. More in count pipeline introduction.--sequencing-type (Required, default to None) Sequencing type of FASTQs which is recorded in the sequencing report.--chip-mask (Required, default to None) Stereo-seq chip mask file.--organism (Optional, default to None) Organism type of sample, usually referring to species.--tissue (Optional, default to None) Physiological tissue of sample.--reference (Optional, default to None) Path to the reference folder, containing SAW-compatible index files and GTF/GFF, built by SAW makeRef.--ref-libraries (Optional, default to None) Path to a ref_libraries.csv which declares reference indexes, built by SAW makeRef. Not compatible with --reference.--fastqs (Required, default to None) Path(s) to folder(s), containing all needed FASTQs. If FASTQs are stored in multiple directories, use it as: --fastqs=/path/to/directory1,/path/to/directory2,.... Notice that all FASTQ files under these directories will be loaded for analysis. --microorganism-detect(Optional, default to None) Whether to perform analysis related to microorganisms. Notice that the detection only works for FFPE assay currently.--uniquely-mapped-only(Optional, default to None) Only annotate on uniquely mapped reads during read annotation.--rRNA-remove(Optional, default to None) Whether to remove rRNA. Before turning the switch on, make sure that the necessary rRNA information has been added to FASTA, using SAW makeRef.--clean-reads-fastq(Optional, default to None) Whether to output the reads confidently mapped to the genome in Q4 FASTQ format.--unmapped-STAR-fastq(Optional, default to None) Whether to output unmapped reads in Q4 FASTQ format.--unmapped-fastq(Optional, default to None) Whether to output unmapped reads in Q4 FASTQ format (not including \"too many loci\" reads from STAR).--image (Optional, default to None) TIFF image for QC (quality control), combined with expression matrix for analysis.Name rule for input TIFF :a. _.tifb. _.tiffc. _.TIFd. _.TIFF includes:a. ssDNAb. DAPIc. HE (referring to H&E)d. _IF, _IF, ...--image-tar (Optional, default to None) The compressed image .tar.gz file from StereoMap has been through prepositive QC (quality control).--output (Optional, default to None) Set a specific output directory for the run.--threads-num (Optional, default to 8) Allowed local cores to run the pipeline.--memory (Optional, default to detected) Allowed local memory to run the pipeline.--gpu-id (Optional, default to -1) Set GPU id, according to GPU resources in the computing environment. Default to -1, which means running the pipeline using the CPU. -h, --help(Optional, default to None) Print help information. SAW makeRef 构建参考基因组的索引文件，支持 SAW count 分析，需输入 GTF/GFF 注释文件和 FASTA 基因组文件，可以加入 rRNA 信息的 FASTA 文件。 运行方式: saw makeRef [Parameters] --mode --fasta --gtf --genome saw makeRef -h | --help ParameterDescription--mode (Required, default to \"STAR\") Set the mode to build index files, used for the alignment. There are three modes, including STAR, Bowtie2 and Kraken2 for specific analysis scenarios.--fasta (Optional, default to None) Path to FASTA, to build index files. When it comes to multiple FASTAs, they will be integrated in order of input beforehand.--rRNA-fasta (Optional, default to None) Path to rRNA FASTA that will be added to --fasta file, with the elimination of redundant rRNA fragments.--gtf (Optional, default to None) Path to input GTF/GFF to build index files.--basename (Optional, default to \"host\") Basename for Bowtie2 index files when set mode=Bowtie2. If not specified, \"host\" will be used, which straightforwardly means removing host information in the next step.--database (Optional, default to None) Path to Kraken2 reference database. If the parameter works, output index files will be saved in the same directory level.--genome (Optional, default to detected) Path to the output reference genome with index information.--params-csv (Optional, default to detected) Path to CSV file, recording detailed parameters to build Bowtie2/Kraken2 index. It works when --mode is set to Bowtie2/Kraken2.More in Tutorials.--threads-num (Optional, default to 8) Set the number of threads to use.-h, --help(Optional, default to None) Print help information. SAW checkGTF Check whether an annotation file (GTF/GFF) is in the standard format, used in SAW count. In addition, extract specific information from GTF/GFF. 检查 GTF/GFF 注释文件是否为标准格式。此外，可以从 GTF/GFF 中提取特定的注释信息。 运行方式: saw checkGTF [Parameters] --input-gtf --attribute --output-gtf saw checkGTF -h | --help ParameterDescription--input-gtf (Required, default to None) Path to input GTF/GFF, for a necessary format check.--attribute (Optional, default to None) Extract specific annotation information from GTF/GFF. Input as .--output-gtf (Required, default to None) Path to output GTF/GFF after a necessary check, or additional filtration when performing --attribute.-h, --help(Optional, default to None) Print help information. SAW realign 接回 StereoMap 手动处理后生成的图像文件，重启分析流程。 运行方式: saw realign [Parameters] --id --sn --count-data --realigned-image-tar saw realign -h | --help ParameterDescription-id (Optional, default to None) A unique task id ([a-zA-Z0-9_-]+) which will be displayed as the output folder name and the title of HTML report. If the parameter is absent, --sn will play the same role.--sn (Required, default to None) SN (serial number) of the Stereo-seq chip.--count-data (Required, default to None) Output folder of the corresponding SAW count result, which mainly contains the expression matrices and other related datasets.--realigned-image-tar (Required, default to None) Compressed image file from StereoMap, which has been manually processed, including stitching, tissue segmentation, cell segmentation, calibration and registration.--lasso-geojson (Optional, default to None) Lasso GeoJSON from StereoMap is used for tissue segmentation when the analysis is without images. It is incompatible with --realigned-image-tar.--adjusted-distance (Optional, default to 10) Outspread distance based on the cellular contour of the cell segmentation image, in pixels. Default to 10. If --adjusted-distance=0, the pipeline will not expand the cell border.--no-matrix(Optional, default to None) Whether to output feature expression matrices.--no-report(Optional, default to None) Whether to output HTML report.--output (Optional, default to None) Set a specific output directory for the run.--threads-num (Optional, default to 8) Set the number of threads to use.-h, --help(Optional, default to None) Print help information. SAW reanalyze 进行数据再分析，包含聚类分析、矩阵套索和差异表达分析。 运行方式: saw reanalyze [Parameters] --gef --bin-size --marker --output saw reanalyze -h | --help ParameterDescription--gef (Optional, default to None) Input bin GEF file for analysis.--cellbin-gef (Optional, default to None) Input cellbin GEF file for analysis.--bin-size (Optional, default to 200) Bin size for analysis.--Leiden-resolution (Optional, default to 1.0) The resolution parameter controls the coarseness of the clustering when performing Leiden. Higher values lead to more clusters.--marker(Optional, default to None) Whether to perform differential expression analysis.--count-data (Optional, default to None) Output folder of the corresponding SAW count result, which mainly contains the expression matrices and other related datasets.--diffexp-geojson (Optional, default to None) GeoJSON from StereoMap to analyze differential expression.--lasso-geojson (Optional, default to None) GeoJSON from StereoMap to lasso sub expression matrices of targeted regions.--output (Optional, default to None) Path to the output folder, to save analysis results.--threads-num (Optional, default to 8) Set the number of threads to use.-h, --help(Optional, default to None) Print help information. SAW convert 实现数据格式转换，分析流程下设置子模块用于实现特定的转换需求。 运行方式: saw convert gef2gem [Parameters] --gef --bin-size --marker --gem saw convert -h | --help ParameterDescription--threads-num (Optional, default to 8) Set the number of threads to use.-h, --help(Optional, default to None) Print help information. Matrix related gef2gem ParameterDescription--gef (Required, default to None) Path to input bin GEF file.--bin-size (Optional, default to 1) Bin size used during conversion.--cellbin-gef (Optional, default to None) Path to input cellbin GEF file.--gem (Optional, default to None) Path to output GEM file.--cellbin-gem (Optional, default to None) Path to output cellbin GEM file. gem2gef ParameterDescription--gem (Optional, default to None) Path to input GEM file.--gef (Optional, default to None) Path to output bin GEF file.--cellbin-gem (Optional, default to None) Path to output cellbin GEM file.--cellbin-gef (Optional, default to None) Path to input cellbin GEF file. bin2cell ParameterDescription--gef (Required, default to None) Path to input bin GEF file.--image (Required, default to None) Path to the image of cell segmentation.--cellbin-gem (Required, default to None) Path to output cellbin GEM file.--cellbin-gef (Optional, default to None) Path to output cellbin GEF file. gef2h5ad ParameterDescription--gef (Optional, default to None) Path to input bin GEF file.--bin-size (Optional, default to 20) Bin size used during conversion.--cellbin-gef (Optional, default to None) Path to input cellbin GEF file.--h5ad (Required, default to None) Path to output AnnData H5AD file. gem2h5ad ParameterDescription--gem (Optional, default to None) Path to input GEM file.--bin-size (Optional, default to 20) Bin size used during conversion.--cellbin-gem (Optional, default to None) Path to input cellbin GEM file.--h5ad (Required, default to None) Path to output AnnData H5AD file. gef2img ParameterDescription--gef (Required, default to None) Path to input bin GEF.--bin-size (Required, default to 1) Bin size used to plot expression heatmap.--image (Required, default to None) Path to output heatmap image. visualization ParameterDescription--gef (Required, default to None) Path to input raw bin GEF file.--bin-size (Required, default to 1,5,10,20,50,100,150,200) Bin sizes used during conversion.--visualization-gef (Required, default to None) Path to output visualization GEF file. Image related tar2img ParameterDescription--image-tar (Required, default to None) Path to input image compressed tar file.--image (Required, default to None) Path to output folder of images. img2rpi ParameterDescription--image (Required, default to None) Path to images, please note that the order of input images, corresponding to --layers names.--layers (Required, default to None) Layer names, recorded in the output RPI file, should correspond to images individually. Layer names can be set arbitrarily, but follow the format of /, like DAPI/TissueMask.--rpi (Required, default to None) Path to output RPI file. merge ParameterDescription--image (Required, default to None) Path to input images (up to 3), to be merged into one image, in the color order of R-G-B.--merged-image (Required, default to None) Path to output multichannel image. overlay ParameterDescription--image (Required, default to None) Path to image, used to be the base one.--template (Required, default to None) Point information of matrix template.--overlaid-image (Required, default to None) Path to output overlaid image, with the cover of a template. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/pipelines/count/":{"url":"analysis/pipelines/count/","title":"count","keywords":"","body":"countSAW countStereo-seq T FFV1.2Stereo-seq N FFPEV1.0count SAW count SAW count 是SAW软件的核心分析流程，可以兼容大多数 Stereo-seq FF 和 Stereo-seq FFPE 数据。输入数据包括芯片mask文件、测序FASTQ、参考基因组和显微镜拍照图像。流程输出Stereo-seq 芯片的空间表达矩阵和分析结果。 根据时空试剂盒产品线的不同，运行分析所需的参数设置也有所区别。在开始分析任务之前，需要注意产品试剂盒的版本信息，选择一个合适的。 Stereo-seq T FF *T 代表 Chip T 芯片 V1.2 Count for Stereo-seq T FF V1.2 Spatial Gene Expression Stereo-seq N FFPE *N 代表 Chip N 芯片 V1.0 Count for Stereo-seq N FFPE V1.0 Spatial Gene Expression Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/pipelines/count/stereo-seq-t-ff.html":{"url":"analysis/pipelines/count/stereo-seq-t-ff.html","title":"Stereo-seq T FF","keywords":"","body":"Stereo-seq T FF时空试剂盒信息输入文件运行 SAW count标准分析流程图像手动处理输出结果Stereo-seq T FF 时空试剂盒信息 SAW支持分析FF (fresh frozen) 样本的时空芯片测试数据，工作流程如下图所示： --kit-version 是开启分析前需要确认的重要信息，可参考 STOmics 的 Stereo-seq 转录组试剂套装使用说明书。 Stereo-seq SolutionStereo-seq Kit--kit-versionStereo-seq Transcriptomics SolutionV1.2.1\"Stereo-seq T FF V1.2\"Stereo-seq Transcriptomics mIF SolutionV1.2\"Stereo-seq T FF V1.2\"Stereo-seq Transcriptomics H&E SolutionV1.2.1\"Stereo-seq T FF V1.2\"Stereo-seq Transcriptomics Mini Chip SolutionV1.2\"Stereo-seq T FF V1.2\"Stereo-seq Large Chip DesignsV1.0\"Stereo-seq T FF V1.2\" *T 代表 Chip T 芯片 根据上面的关系对应表，确认运行 SAW count 分析所需的 --kit-version 参数信息。 输入文件 SAW count 分析流程需要输入以下文件： Stereo-seq Chip T 芯片 mask 文件 (--mask) 时空测序 FASTQ 数据 (--fastqs) --sequencing-type参数信息与FASTQ测序数据相关，例：“PE100_50+100”，表示双端测序长度为 100 bp，read 1 进行50次循环扩增 ，read 2 进行100次循环扩增。相关信息可以从测序报告中获取。 显微镜图像支持TIFF或 StereoMap QC模块输出的图像.tar.gz文件 --image参数支持直接输入显微镜拼接大图TIFF --image-tar参数支持输入 StereoMap QC模块输出的图像.tar.gz文件 Reference 包含物种的参考基因组 (FASTA) 和注释文件 (GTF/GFF) (--reference) 参考基因组的索引文件需要预先构建，可使用 SAW makeRef 分析流程会自动对注释文件的格式进行检查，也可以单独调用 SAW checkGTF 进行格式检查 运行 SAW count 根据 SAW 参数命令说明，或直接在命令行中输入 saw count --help，获取可用参数信息。在运行分析流程之前，确认已从 STOmics Cloud 平台下载芯片 mask 文件。 输入数据准备完毕后，根据图像 QC 结果选择合适的操作路径。 标准分析流程 使用 Stereo-seq FF 样本的测序数据进行基因比对和注释，输出空间特征表达矩阵，基于显微镜拍照图像，标准流程调用自动配准、组织分割、细胞分割和细胞修正算法对图像进行处理，结合表达矩阵数据和图像结果进行分析，使用下面的代码命令行开启SAW count分析： 如果是QC失败的图像数据，SAW count将不会在标准分析过程中调用图像算法，仅基于表达矩阵数据进行组织区域的识别。 cd /saw/runs saw count \\ --id= \\ --sn= \\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq T FF V1.2\" \\ --sequencing-type=\"PE100_50+100\" \\ --chip-mask=/path/to/chip/mask \\ --organism= \\ --tissue= \\ --fastqs=/path/to/fastq/folders \\ --reference=/path/to/reference/folder \\ --image-tar=/path/to/image/tar 详细教程请参考 Stereo-seq FF 分析 部分。 图像手动处理 运行一次SAW count 标准分析流程后，可以从结果文件中获取 visualism.tar.gz 文件，下载至本地解压后，可在 StereoMap 中进行可视化查看和手动图像操作。经过一系列手动处理后，新生成的图像 .tar.gz 被传回 SAW realign，重启分析流程。 QC失败的图像数据需要在StereoMap中手动进行矩阵和图像之间的配准操作，之后SAW realign重启分析流程，可以基于手动配准后的结果调用图像相关的算法进行分析处理，在此过程中手动处理的其他结果（手动处理得到的组织分割和细胞分割）不会被覆盖。 cd /saw/runs saw realign \\ --id= \\ --sn= \\ --count-data=/path/to/previous/SAW/count/task/folder \\ --realigned-image-tar=/path/to/realigned/image/tar 详细教程请参考 手动图像处理 部分。 输出结果 下面列出了SAW count 的输出文件目录结构和内容： Demo_Mouse_Kidney ├── pipeline-logs ├── STEREO_ANALYSIS_WORKFLOW_PROCESSING └── outs ├── analysis ├── bam ├── feature_expression ├── image ├── .report.tar.gz └── visualization.tar.gz 进一步探究流程输出结果 ： 跳转至HTML报告解读； 熟悉 visualization.tar.gz 可视化文件； 了解输出结果中的各种文件类型。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/pipelines/count/stereo-seq-n-ffpe-v1.0.html":{"url":"analysis/pipelines/count/stereo-seq-n-ffpe-v1.0.html","title":"Stereo-seq N FFPE","keywords":"","body":"Stereo-seq N FFPE时空试剂盒信息输入文件运行 SAW count标准分析流程图像手动处理输出结果Stereo-seq N FFPE 时空试剂盒信息 SAW 支持分析 FFPE (formalin-fixed paraffin-embedded) 样本的时空芯片测试数据，工作流程如下图所示： --kit-version 是开启分析前需要确认的重要信息，可参考 STOmics 的 Stereo-seq 转录组试剂套装使用说明书。 Stereo-seq SolutionStereo-seq Kit--kit-versionStereo-seq Transcriptomics FFPE SolutionV1.0\"Stereo-seq N FFPE V1.O\" *N 代表 Chip N 芯片 根据上面的关系对应表，确认运行 SAW count 分析所需的 --kit-version 参数信息。 输入文件 SAW count分析流程需要输入如下文件： Stereo-seq Chip N 芯片的 mask 文件 (--mask) 时空测序 FASTQ 数据 (--fastqs) --sequencing-type参数信息与FASTQ测序数据相关，例：“PE75_25+59”，表示双端测序长度为 75 bp，read 1 进行25次循环扩增 ，read 2 进行59次循环扩增。相关信息可以从测序报告中获取。 显微镜图像支持TIFF或 StereoMap QC模块输出的图像.tar.gz文件 --image参数支持直接输入显微镜拼接大图TIFF --image-tar for brightfield or fluorescent image .tar.gz from StereoMap --image-tar参数支持输入StereoMap QC模块输出的图像.tar.gz文件 Reference 包含物种的参考基因组 (FASTA) 和注释文件 (GTF/GFF) (--reference) 参考基因组的索引文件需要预先构建，可使用 SAW makeRef 如果要开展微生物分析，需额外构建索引文件并且提前下载相关的微生物比对数据库 分析流程会自动对注释文件的格式进行检查，也可以单独调用 SAW checkGTF 进行格式检查 运行 SAW count 根据 SAW 参数命令说明，或直接在命令行中输入 saw count --help，获取可用参数信息。在运行分析流程之前，确认已从 STOmics Cloud 平台下载芯片 mask 文件。 输入数据准备完毕后，根据图像 QC 结果选择合适的操作路径。 标准分析流程 使用 Stereo-seq FFPE 样本的测序数据进行基因比对和注释，输出空间特征表达矩阵，基于显微镜拍照图像，标准流程调用自动配准、组织分割、细胞分割和细胞修正算法对图像进行处理，结合表达矩阵数据和图像结果进行分析，使用下面的代码命令行开启 SAW count 分析： 如果是QC失败的图像数据，SAW count将不会在标准分析过程中调用图像算法，仅基于表达矩阵数据进行组织区域的识别。 需要特别注意，FFPE 数据的 H\\&E 染色图像不会输出细胞分割结果。 cd /saw/runs saw count \\ --id= \\ --sn= \\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq N FFPE V1.0\" \\ --sequencing-type=\"PE75_25+59\" \\ --chip-mask=/path/to/chip/mask \\ --organism= \\ --tissue= \\ --fastqs=/path/to/fastq/folders \\ --reference=/path/to/reference/folder \\ --image-tar=/path/to/image/tar 详细教程请参考 Stereo-seq FF 分析 部分。 图像手动处理 运行一次SAW count 标准分析流程后，可以从结果文件中获取 visualism.tar.gz 文件，下载至本地解压后，可在 StereoMap 中进行可视化查看和手动图像操作。经过一系列手动处理后，新生成的图像 .tar.gz 被传回 SAW realign 重启分析流程。 QC失败的图像数据需要在StereoMap中手动进行矩阵和图像之间的配准操作，之后SAW realign重启分析流程，可以基于手动配准后的结果调用图像相关的算法进行分析处理，在此过程中手动处理的其他结果（手动处理得到的组织分割和细胞分割）不会被覆盖。 cd /saw/runs saw realign \\ --id= \\ --sn= \\ --count-data=/path/to/previous/SAW/count/task/folder \\ --realigned-image-tar=/path/to/realigned/image/tar 详细教程请参考 手动图像处理 部分。 输出结果 下面列出了SAW count 的输出文件目录结构和内容： Demo_Mouse_Brain ├── pipeline-logs ├── STEREO_ANALYSIS_WORKFLOW_PROCESSING └── outs ├── analysis ├── bam ├── feature_expression ├── image ├── .report.tar.gz └── visualization.tar.gz 进一步探究流程输出结果 ： 跳转至HTML报告解读； 熟悉 visualization.tar.gz 可视化文件； 了解输出结果中的各种文件类型。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/":{"url":"analysis/outputs/","title":"输出结果","keywords":"","body":"输出结果SAW count 输出结果SAW realign 输出结果输出结果 SAW count 输出结果 SAW count 是处理 FASTQ 测序数据的 的核心分析流程，通常会包含显微镜图像。如果你不熟悉 SAW 分析流程的输出结果，以下内容将带你了解一些基本知识。 如果找到SAW分析的输出目录？ SAW count 分析任务通常在工作目录下执行，在该目录下，将找到一个名为 --id 或 --sn（当--id参数没有启用时）的文件夹。 输出结果下面的文件夹都是什么？ 输出目录下的文件夹主要包含三部分： /outs - 主要的分析输出结果，按照数据类型进行分类整理； /pipeline-logs - 分析流程的日志文件和相关配置文件； /STEREO_ANALYSIS_WORKFLOW_PROCESSING - 中间环节、临时文件，统计信息文件和单程序模块的日志文件。 主要的分析输出结果中都包含什么文件？ SAW count 分析任务运行结束后，输出的结果文件依据其数据类型被分类。主要输出文件保存在 /outs文件夹下，方便分析人员更快速找到目标文件。 Main output files 什么是 HTML 报告？ HTML 报告汇总展示了分析过程中的统计信息，以及分析结果，以呈现 SAW count 任务运行的总体情况，更多解读请参见HTML报告详情页。 什么是可视化 visualization.tar.gz 文件？ 可视化图像压缩包文件集成了 StereoMap 中结果展示所需的数据文件，其中主要包括空间表达矩阵、下游分析文件和图像相关文件。下面为一个简单的示例： visualization ├── C04144D5.tissue.gef ├── C04144D5.bin200_1.0.h5ad ├── C04144D5.adjusted.cellbin.gef ├── C04144D5.cellbin_1.0.adjusted.h5ad ├── C04144D5.rpi ├── C04144D5_SC_20240509_174202_4.0.0.tar.gz ├── C04144D5.stereo └── ssDNA_matrix_template.txt SAW realign 输出结果 与 SAW count 的输出结果相比有何不同？ SAW realign 使用 --count-data 参数来获取reads比对、注释和空间表达矩阵相关的信息。经过手动处理的图像 .tar.gz 文件可以输出调整后的图像数据，协助分析流程生成组织和细胞维度的表达矩阵，具体结果取决于图像 .tar.gz 文件中所记录的手动处理信息。 能否通过SAW realign 分析流程输出 HTML 报告？ 当然！ 你可以通过输入手动处理后的图像.tar.gz文件，运行SAW realign重启分析流程。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/count-outputs.html":{"url":"analysis/outputs/count-outputs.html","title":"count 输出结果","keywords":"","body":"count 输出结果目录概览输出文件列表visualization.tar.gz.stereocount 输出结果 目录概览 SAW count 分析任务通常在工作目录下开启，在该目录下，将找到一个名为 --id 或 --sn（当--id参数没有启用时）的文件夹。输出结果依据数据类型被分类，主要文件被保存在 /outs下。 分析流程输出的具体文件取决于： SAW软件的版本 分析流程的选择，SAW count 或 SAW realign 是否加入显微镜图像进行分析 特定的分析参数设置 ... 输出文件列表 完成 Stereo-seq T FF 和 Stereo-seq N FFPE 组织样本的SAW count分析任务后，可以在 outs/ 目录下找到以下文件： Directory/File NameDescriptionbam/Files in BAM format.annotated_bam/BAM file after alignment and annotation..*.bamIndexed BAM file containing position-sorted reads mapped to CIDs, aligned to the genome, and annotated with GTF/GFF..*.bam.csiIndex for .*.bam. image/Images are generated from automatic or manual workflows.__regist.tifThe panoramic image after the registration with .raw.gef matrix.__tissue_cut.tifThe tissue segmentation image, based on the aligned panoramic image.__mask.tifThe cell segmentation image, based on the aligned panoramic image.__mask_edm_dis_.tifThe adjusted image, based on the cell segmentation imagefeature_expression/Feature expression matrices in HDF5 format at different dimensions..raw.gefFeature expression matrix includes the whole information over a complete chip region. It only has bin1 expression counts. .tissue.gefFeature expression matrix under the tissue coverage region. It is also a visualization GEF that includes expression counts for bin1, 5, 10, 20, 50, 100, 150, 200..cellbin.gefCellbin feature expression matrix records the information of cells individually, including the centroid coordinate, boundary coordinates, expression of genes, and cell area..adjusted.cellbin.gefCellbin expression matrix with cell border expanding, based on __mask_edm_dis_.tif..merge.barcodeReadsCount.txtA mapped CID list file with read counts for each CID, including three columns (x, y, count)._raw_barcode_gene_exp.txtAn annotated list file with the information of coordinate, gene, MID, read counts, which is prepared to be a sampling file that performs sequence saturation.analysis/Secondary analysis files..bin200_1.0.h5adAn AnnData H5AD records preprocessing, filtering, normalization, dimensionality reduction, clustering and differential expression analysis, based on .tissue.gef. This output H5AD is named in the format of ._.h5ad. In the file name, stands for the Stereo-seq chip serial number, for bin size, and for the resolution of Leiden clustering.bin200_marker_features.csvFormat-integrated differential expression analysis results, using .tissue.gef of bin200..cellbin_1.0.h5adAn AnnData H5AD records preprocessing, filtering, normalization, dimensionality reduction, clustering and differential expression analysis, using .cellbin.gef.cellbin_marker_features.csvFormat-integrated differential expression analysis results, using .cellbin.gef..cellbin_1.0.adjusted.h5adAn AnnData H5AD records preprocessing, filtering, normalization, dimensionality reduction, clustering and differential expression analysis, using .adjusted.cellbin.gef.cellbin_adjusted_marker_features.csvFormat-integrated differential expression analysis results, using .adjusted.cellbin.gef..report.tar.gzAnalysis summary report of metrics and plots in HTML format.report.htmlHTML file, involved in .report.tar.gz.visualization.tar.gzStereoMap visualization file to presentation and manual processing..stereoA manifest file in JSON format includes experiment and pipeline information, basic analysis statistics, and references to image and spatial matrix files in the SAW output visualization file folder. visualization.tar.gz 可视化压缩文件内集成了 StereoMap 展示所需的文件，一个解压后的示例文件如下： visualization ├── C04144D5.adjusted.cellbin.gef ├── C04144D5.bin200_1.0.h5ad ├── C04144D5.cellbin_1.0.adjusted.h5ad ├── C04144D5.rpi ├── ssDNA_matrix_template.txt ├── C04144D5_SC_20240509_174202_4.0.0.tar.gz ├── C04144D5.stereo └── C04144D5.tissue.gef .stereo .stereo 是一个JSON格式的统领文件，里面记录了： SAW分析流程的基本信息 组织样本的相关信息 基本分析统计结果 StereoMap所需的图像相关和矩阵相关的文件信息 *文件详细介绍在 “输出结果” 下的各部分说明中可以找到 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/realign-outputs.html":{"url":"analysis/outputs/realign-outputs.html","title":"realign 输出结果","keywords":"","body":"realign 输出结果目录概览输出文件列表visualization.tar.gz.stereorealign 输出结果 目录概览 SAW realign 分析任务通常在工作目录下开启，在该目录下，将找到一个名为 --id 或 --sn（当--id参数没有启用时）的文件夹。输出结果依据数据类型被分类，主要文件被保存在 /outs下。 分析流程输出的具体文件取决于： SAW软件的版本 分析流程的选择，SAW count 或 SAW realign 是否加入显微镜图像进行分析 特定的分析参数设置 ... 输出文件列表 完成 Stereo-seq T FF 和 Stereo-seq N FFPE 组织样本的 SAW realign 分析任务后，可以在 outs/ 目录下找到以下文件： Directory/File Name Description bam/ Files in BAM format. annotated_bam/ BAM file after alignment and annotation. .*.bam Indexed BAM file containing position-sorted reads mapped to CIDs, aligned to the genome, and annotated with GTF/GFF. .*.bam.csi Index for .*.bam. image/ Images are generated from automatic or manual workflows. __regist.tif The panoramic image aligned with raw.gef matrix. __tissue_cut.tif The tissue segmentation image, based on the aligned panoramic image. __mask.tif The cell segmentation image, based on the aligned panoramic image. __mask_edm_dis_.tif The adjusted image, based on the cell segmentation image feature_expression/ Feature expression matrices in HDF5 format at different dimensions. .raw.gef Feature expression matrix includes the whole information over a complete chip region. It only has bin1 expression counts. .tissue.gef Feature expression matrix under the tissue coverage region. It is also a visualization GEF which includes expression counts for bin1, 5, 10, 20, 50, 100, 150, 200. .cellbin.gef Cellbin feature expression matrix records the information of cells individually, including the centroid coordinate, boundary coordinates, expression of genes, and cell area. .adjusted.cellbin.gef Cellbin expression matrix with cell border expanding, based on __mask_edm_dis_.tif. .merge.barcodeReadsCount.txt A mapped CID list file with read counts for each CID, including three columns (x, y, count). _raw_barcode_gene_exp.txt An annotated list file with the information of coordinate, gene, MID, read counts, which is prepared to be a sampling file that performs sequence saturation. analysis/ Secondary analysis files. .bin200_1.0.h5ad An AnnData H5AD records preprocessing, filtering, normalization, dimensionality reduction, clustering and differential expression analysis, based on .tissue.gef. This output H5AD is named in the format of ._.h5ad. In the file name, stands for the Stereo-seq chip serial number, for bin size, and for the resolution of Leiden clustering. bin200_marker_features.csv Format-integrated differential expression analysis results, using .tissue.gef of bin200. .cellbin_1.0.h5ad An AnnData H5AD records preprocessing, filtering, normalization, dimensionality reduction, clustering and differential expression analysis, using .cellbin.gef. cellbin_marker_features.csv Format-integrated differential expression analysis results, using .cellbin.gef. .cellbin_1.0.adjusted.h5ad An AnnData H5AD records preprocessing, filtering, normalization, dimensionality reduction, clustering and differential expression analysis, using .adjusted.cellbin.gef. cellbin_adjusted_marker_features.csv Format-integrated differential expression analysis results, using .adjusted.cellbin.gef. .report.tar.gz Analysis summary report of metrics and plots in HTML format. report.html HTML file, involved in .report.tar.gz. visualization.tar.gz StereoMap visualization file to presentation and manual processing. .stereo A manifest file in JSON format includes experiment and pipeline information, basic analysis statistics, and references to image and spatial matrix files in the SAW output visualization file folder. 表达矩阵相关的数据和结果来自于上一次 SAW count 的输出，通过--count-data参数传递信息。 visualization.tar.gz 可视化压缩文件内集成了 StereoMap 展示所需的文件，一个解压后的示例文件如下： visualization ├── C04144D5.adjusted.cellbin.gef ├── C04144D5.bin200_1.0.h5ad ├── C04144D5.cellbin_1.0.adjusted.h5ad ├── C04144D5.rpi ├── ssDNA_matrix_template.txt ├── C04144D5_SC_20240509_174202_4.0.0.tar.gz ├── C04144D5.stereo └── C04144D5.tissue.gef .stereo .stereo 是一个JSON格式的统领文件，里面记录了： SAW分析流程的基本信息 组织样本的相关信息 基本分析统计结果 StereoMap所需的图像相关和矩阵相关的文件信息 *文件详细介绍在 “输出结果” 下的各部分说明中可以找到 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/html-report.html":{"url":"analysis/outputs/html-report.html","title":"HTML report","keywords":"","body":"HTML reportSummaryKey metricsAnnotationInformationTissue relatedSequencing saturationSquare BinStatisticsPlotsClustering & UMAPDifferential expression analysisCell BinStatisticsPlotsClustering & UMAPDifferential expression analysisImageImage informationQCStitchingRegistrationMicroorganismDenoisingTaxonomic ClassificationMicrobes Proportion (Phylum)AlertsHTML report *The interpretation of the HTML report is only available in EN. SAW count and SAW realign pipelines will output an interactive report .report.tar.gz that contains report.html. The contents of the HTML report file will vary depending on the pipeline and parameters used but generally follow a similar format across runs. On this page, we demonstrate the report of a mouse brain FFPE tissue sample run with SAW count (v8.0). Summary Expression heatmap and four key metrics Display of microscope image The spatial gene expression distribution plot, on the left, shows MID count at each bin200. Total Reads is the amount of total sequencing reads of input FASTQs. Mean MID per Bin200 and Mean Gene per Bin200 represent the mean MID and gene type counts at each bin200. Unique Reads is the number of reads in the transcriptome that have been corrected by MAPQ and deduplicated. Key metrics Details and sunburst plot of key metrics Key metrics of the data are listed: MetricDescriptionTotal ReadsTotal number of sequenced reads.Valid CID ReadsNumber of reads with CIDs that can be matched with the mask fileInvalid CID ReadsNumber of reads with CIDs that cannot be matched with the mask file.Clean ReadsNumber of Valid CID Reads that have passed QC.Non-Relevant Short ReadsNumber of non-relevant short readsDiscarded MID ReadsNumber of reads with MID that have been discarded since MID sequence quality does not satisfy with further analysis.Uniquely Mapped ReadsNumber of reads that mapped uniquely to the reference genome. If the pipeline uses uniquely mapped reads and the best match from multi-mapped reads for subsequent annotation, this item will include them bothTranscriptomeNumber of reads that are aligned to transcripts of at least one geneUnique ReadsNumber of reads in Transcriptome that have been corrected by MAPQ and deduplicatedSequencing SaturationNumber of reads in Transcriptome that have been corrected by MAPQ with duplicated MIDUnannotated ReadsNumber of reads that cannot be aligned to the transcript of one geneMulti-Mapped ReadsNumber of reads that mapped more than one time on the genome. If the pipeline uses uniquely mapped reads and the best match from multi-mapped reads for subsequenty annotation, this item will exclude multi-mapped ones to be annotatedUnmapped ReadsNumber of reads that cannot be mapped to the reference genome.rRNA ReadsNumber of reads that mapped to the rRNA regions. Annotation Metrics of reads to be annotated by GTF/GFF files. MetricDescriptionTranscriptomeNumber of reads that mapped to a unique gene in the transcriptome. These reads are considered for MID counting. (Transcriptome = Exonic + Intronic)ExonicNumber of reads that mapped uniquely to an exonic region and on the same strand of the genome.IntronicNumber of reads that mapped uniquely to an intronic region and on the same strand of the genome.IntergenicNumber of reads that mapped uniquely to an intergenic region and on the same strand of the genome.AntisenseNumber of reads mapped to the transcriptome but on the opposite strand of their annotated gene. Information This item displays the basic information of the input FASTQs, Organism is from the --organism parameter used in SAW count, usually referring to the species. Tissue is from the --tissue parameter used in SAW count. Reference means the reference genome used in SAW count, as the same as Organism. FASTQ records FASTQ files in SAW count, including file prefixes of all input sequencing FASTQs. Tissue related Display and metrics related to tissue-coverage region The tissue segmentation result based on a microscope image is shown on the left, of which the tissue region is covered in purple. Metrics related to tissue coverage are listed: MetricDescriptionTissue AreaTissue area in nm²​.DNB Under TissueNumber of DNBs under tissue coverage region.mRNA-Captured DNBs Under TissueNumber of DNBs under tissue that have captured mRNA.Genes Under TissueNumber of detected gene under tissue coverage.Number of MID Under Tissue CoverageNumber of MID under tissue coverage.Fraction MID in Spots Under TissueFraction of MID under tissue over total unique reads. (MID Under Tissue / Unique Reads)Reads Under TissueNumber of reads with position prior to filtration under tissue coverage.Fraction Reads in Spots Under TissueFraction of mapped reads under tissue over total mapped reads. (Mapped Reads in Spots Under Tissue / Valid CID Reads) Sequencing saturation Sequencing saturation curves The saturation analysis in the HTML report can assess the overall quality of the sequencing data. In order to improve calculation efficiency, small samples are randomly selected from successfully annotated reads in the bin200 dimension. Therefore, the results of multiple runs of the same data may vary slightly. The formulas may not be identical, but the general shape of the curve is consistent. Figure 1: Statistics of Unique Reads (reads with unique CID, geneName and MID) in the sampled samples, saturation value = 1-(Unique Reads)/(Total Annotated Reads), as the sampling volume increases, the fitting curve becomes near-flat, indicating that the data tends to be saturated. Whether to add additional tests depends on the overall project design and sample conditions. For example, it is recommended that additional tests be performed on precious samples. The threshold value of 0.8 in the report serves as a reminder for recommended guidance. Figure 2: As the number of random samples increases, the gene median in the bin200 dimension gradually increases. Figure 3: Curves fitted based on Unique Reads data from randomly sampled samples, with a fitting curve R² ≥ 0.9. The x-axis of the three graphs is the same, and the y-axis is divided into saturation value, gene median, and number of Unique Reads. Square Bin This page contains results of statistics, plots, clustering, UMAP, and differential expression analysis, at bin dimension. Results come from the analysis based on .tissue.gef file. Statistics Statistics of bins under tissue-coverage region The above table records the statistics from bin 1 to bin 200: ItemDescriptionBin SizeThe size of Bin which is the unit of aggregated DNBs in a squared region.i.e. Bin 50 = 50 * 50 DNBsMean Reads (per bin)Mean number of sequenced reads divided by the number of bins under tissue coverage.Median Reads (per bin)Median number of sequenced reads divided by the number of bins under tissue coverage (pick the middle value after sorting).Mean Gene Type (per bin)Mean number of unique gene types divided by the number of bins under tissue coverage.Median Gene Type (per bin)Median number of unique gene types divided by the number of bins under tissue coverage.Mean MID (per bin)Mean number of MIDs divided by the number of bins under tissue coverage.Median MID (per bin)Median number of MIDs divided by the number of bins under tissue coverage Plots Distribution plots of MID and gene type In the upper left corner,there is a a scatter plot of MID count and gene types in each bin. In the upper right corner, violin plots show the distribution of deduplicated MID count and gene types in each bin. On the bottom, univariate distribution of MID count, gene types, and DNB numbers is shown with rug along the x-axis. Clustering & UMAP Leiden clustering and UMAP projection Clustering is performed based on SN.tissue.gef using the Leiden algorithm. UMAP projections are performed based on SN.tissue.gef and colored by automated clustering. The same color is assigned to spots that are within a shorter distance and with similar gene expression profiles. Differential expression analysis Marker feature table The goal of the differential expression analysis is to identify markers that are more highly expressed in a cluster than the rest of the sample. For each marker, a differential expression test was run between each cluster and the remaining sample. An estimate of the log2 ratio of expression in a cluster to that in other coordinates is Log2 fold-change (L2FC). A value of 1.0 denotes a 2-fold increase in expression within the relevant cluster. Based on a negative binomial test, the p-value indicates the expression difference's statistical significance. The Benjamini-Hochberg method has been used to correct the p-value for multiple testing. Additionally, the top N features by L2FC for each cluster were kept after features in this table were filtered by (Mean UMI counts > 1.0). Grayed-out features have an adjusted p-value >= 0.10 or an L2FC When the values of L2FC in the marker feature table are blank, \"infinity\" and \"-infinity\", the analysis results are normal. These conditions are well explained below. The calculation of L2FC is related to the expression number of cells of a certain gene in the case group and the control group. Since the calculation of L2FC uses the natural logarithm as the base, when the expression relationship has extremely high or low values, the three special values, none, \"inf\" and \"-inf\", will appear. The screenshot below uses inf and a constant to make a simple demonstration. An example in Notebook using Python The p-values should be increasing as the list descends (with a maximum of 1), infinitely close to 0. If you find that the p-value is 0 in the result table, it may be because the calculated differential expression feature is extremely significant, leading to an extremely small p-value. This can exceed the limit of the data type (usually float64, depending on the basic computing package), resulting in a situation that cannot be expressed in scientific notation. Cell Bin This page contains results of statistics, plots, clustering, UMAP, and differential expression analysis, at cellbin dimension. Cell border expanding is automatically performed during SAW count and SAW realign, which means the contents of \"Cell Bin\" tab are based on SN.adjusted.cellbin.gef. When it comes to --adjusted-distance=0 in SAW realign, all contents of this tab are based on SN.cellbin.gef. Statistics Detailed statistics of cellbin The above table records the statistics of cellbin: ItemDescriptionCell CountNumber of cells.Mean Cell AreaMean cell area, in pixes.Median Cell AreaMedian cell area, in pixes.Mean DNB CountMean number of DNBs that have captured-mRNAs per cell.Median DNB CountMedian number of DNBs that have captured-mRNAs per cell.Mean Gene TypeMean gene types per cell.Median Gene TypeMedian gene types per cell.Mean MIDMean MID count per cell.Median MIDMedian MID count per cell. Plots Distribution plots of MID and gene type In the upper left corner, there is a a scatter plot of MID count and gene types in the cellbin. In the upper right corner, violin plots show the distribution of deduplicated MID count and gene types in the cellbin. On the bottom, univariate distribution of MID count, gene types, and DNB numbers is shown with rug along the x-axis. Clustering & UMAP Leiden clustering and UMAP projection Clustering is performed based on SN.adjusted.cellbin.gef or SN.cellbin.gef, using the Leiden algorithm. UMAP projections are performed based on SN.adjusted.cellbin.gef or SN.cellbin.gef, and colored by automated clustering. The same color is assigned to spots that are within a shorter distance and with similar gene expression profiles. Differential expression analysis Marker feature table The goal of the differential expression analysis is to identify markers that are more highly expressed in a cluster than the rest of the sample. For each marker, a differential expression test was run between each cluster and the remaining sample. An estimate of the log2 ratio of expression in a cluster to that in other coordinates is Log2 fold-change (L2FC). A value of 1.0 denotes a 2-fold increase in expression within the relevant cluster. Based on a negative binomial test, the p-value indicates the expression difference's statistical significance. The Benjamini-Hochberg method has been used to correct the p-value for multiple testing. Additionally, the top N features by L2FC for each cluster were kept after features in this table were filtered by (Mean UMI counts > 1.0). Grayed-out features have an adjusted p-value >= 0.10 or an L2FC Interpretation for exceptional cases related to differential expression analysis can be found under Square Bin part. Image Image information Basic information about the microscopic staining image, usually involving microscope settings. QC MetricDescriptionImage QC versionThe version of image QC module.QC PassWhether the image(s) passed image QC quality check.Trackline ScoreReference score for trackline detection.Clarity ScoreReference score for image clarity.Good FOV CountNumber of FOVs that have at least one track dot detected.Total FOV CountTotal number of FOVs.Stitching ScoreReference score for stitching.Tissue Segmentation ScoreReference score for tissue segmentation.Registration ScoreReference score for auto-aligning image with gene expression matrix. Stitching MetricDescriptionTemplate Source Row No.The row number of the template FOV used for predicting the entire template.Template Source Column No.The column number of the template FOV used for predicting the entire template.Global HeightHeight of the stitched image.Global WidthWidth of the stitched image. Registration MetricDescriptionScaleXThe lateral scaling between image and template.ScaleYThe longitudinal scaling between image and template.RotationThe rotation angle of the image relative to the template.FlipWhether the image is flipped horizontally.Image X OffsetOffset between image and matrix in x direction.Image Y OffsetOffset between image and matrix in y directionCounter Clockwise RotationCounter clockwise rotation angle.Manual ScaleXThe lateral scaling based on image center (manual-registration).Manual ScaleYThe longitudinal scaling based on image center (manual-registration).Manual RotationThe rotation angle based on image center (manual-registration).Matrix X StartGene expression matrix offset in x direction by DNB numbers.Matrix Y StartGene expression matrix offset in y direction by DNB numbers.Matrix HeightGene expression matrix height.Matrix WidthGene expression matrix width. Microorganism Here is an another FFPE tissue sample of mouse lung which is especially for microorganism analysis. Bin200 microorganism heatmap under tissue region and four key metrics The distribution plot of microorganism spatial expression, on the left, shows MID count at each bin200. Denoising MetricDescriptionTotal ReadsTotal number of input reads.Non-Host Source ReadsNumber of reads that can not be aligned to the host genome.Host Source ReadsNumber of reads that can be aligned to the host genome during denoising. Taxonomic Classification Mapping result of Bowtie2 and Kraken2 MetricDescriptionNon-Host Source ReadsNumber of reads that can not be aligned to the host genome.Bacteria, Fungi and Viruses MIDsNumber of unique mRNA molecular assigned to bacteria, fungi or viruses.Bacteria, Fungi and Viruses DuplicationNumber of assigned reads that have been corrected due to duplicated MID.Other Microbes or Host-SuspiciousNumber of reads assigned to other microbes (exclude bacteria, fungi and viruses) or host.Unclassified ReadsNumber of unclassified reads. Microbes Proportion (Phylum) Microbes proportion at phylum level The main proportion of microbes at the phylum level. *the same for other classifications Alerts Thresholds are set for several important statistical indicators. If the analysis results are abnormal, an alert message will be displayed at the top of the HTML report. Here is an abnormal exmple data just for display. Alert information Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/bam.html":{"url":"analysis/outputs/bam.html","title":"BAM","keywords":"","body":"BAM标签信息比对统计信息注释统计信息BAM BAM文件为二进制格式，用于保存序列的比对和基因注释信息。SAW count 在BAM文件的可选字段中添加自定义标签，用于记录read的坐标、CID、MID信息，注释信息通过标签字段添加在BAM中。 标签信息 BAM 可选字段中添加的自定义标签信息： TagDescriptionCx:ix coordinate of the Coordiante ID.Cy:iy coordinate of the Coordiante ID.UR:ZThe hexadecimal representation of uncorrected binary-encoded MID.XF:iMapping region on the reference genome. Valid value: 0=EXONIC, 1=INTRONIC, 2=INTERGENIC, 3=rRNA.GI:ZAnnotated gene ID.GE:ZAnnotated gene name.GS:Z‘+’ or ‘-’, indicating forward/reverse strand respectively.UB:ZThe hexadecimal representation of count corrected binary-encoded MID. 原始比对输出的BAM示例： ```Bash E100026571L1C009R00301275185 16 1 3000095 255 26M121066N74M * 0 0 GGCTTTTTTTTTTTTTTTTTTTTTTTTTTTCTAAATATTGGGTTTTATTAGCACCATGATAACTGTATATTAATTTGCACTGACTGTCATAACAAAATAC G+:GFFGGFGFFGFFGFGGFFGFFFFFCFGFCFGGGFGGFGFFFFGGFGGFGFFFGGFFGFFFGFGFGFFGFFGFGFFFFGFFFFFFFFGGFFGGFFGEF NH:i:1 HI:i:1 AS:i:88 nM:i:0 Cx:i:4826 Cy:i:11598 UR:Z:6FA29 ``` 基因注释后的BAM示例： ```Bash E100026571L1C002R00703943265 1040 1 3082766 255 11M132671N89M * 0 0 CTGCTGCAGCTTTTTTTTCTTTGAGATTTATTTTTATGCTATGTGTATGGGTATTTTGCCTGCATATATGTCTATGCACCATGTGTGTGCAGTGCTTGAG FFFFFECGFDCFGDGDFEE@EEGIBFGGCGFFGACGFCGFFDGDGFFFFFFEGCDFCGFFGG@FFF=EFFDGGGGGFDGFFFGGGFGFFGGGFFGGGDFG NH:i:1 HI:i:1 AS:i:88 nM:i:0 Cx:i:7767 Cy:i:18052 UR:Z:7AE49 XF:i:0 GI:Z:ENSMUSG00000051951 GE:Z:Xkr4 GS:Z:- UB:Z:79E49 ``` 比对统计信息 测序 FASTQ 经过 read 比对之后，该环节的统计文件、详细信息被保存在 /STEREO_ANALYSIS_WORKFLOW/ALIGNMENT/.CIDMap.stat目录下。 MetricDescriptionNumber of CID in chip maskNumber of CIDs in the chip mask fileNumber of unique CID in FASTQNumber of unique CIDs in FASTQsNumber of total readsNumber of total reads in FASTQsQ10 in CID %Ratio of Q10 CID basesQ20 in CID %Ratio of Q20 CID basesQ30 in CID %Ratio of Q30 CID basesNumber of mapped CIDNumber of reads mapped to CID% of mapped CIDRatio of reads mapped to CIDNumber of exactly mapped CIDNumber of reads exactly mapped to CID% of exactly mapped CIDRatio of reads exactly mapped to CIDNumber of CID with mismatchNumber of reads mapped to CID with mismatch% of CID with mismatchRatio of reads mapped to CID with mismatchQ10 in RNA %Ratio of Q10 RNA basesQ20 in RNA %Ratio of Q20 RNA basesQ30 in RNA %Ratio of Q30 RNA basesNumber of reads with polyANumber of reads with polyA sequence% of reads with polyARatio of reads with polyA sequenceNumber of short reads (trim polyA)Number ot short reads after trimming polyA sequence% of short reads (trim polyA)Ration ot short reads after trimming polyA sequenceNumber of reads with adapterNumber of reads with adapter sequence% of reads with adapterRation of reads with adapter sequenceNumber of short reads (trim adapter)Number of short reads after trimming adapter sequence% of short reads (trim adapter)Ratio of short reads after trimming adapter sequenceNumber of reads filtered with DNBNumber of reads with DNB sequence% of reads filtered with DNBRatio of reads with DNB sequenceQ10 in clean RNA %Ratio of Q10 RNA bases after filteringQ20 in clean RNA %Ratio of Q20 RNA bases after filteringQ30 in clean RNA %Ratio of Q30 RNA bases after filteringQ10 in MID %Ratio of Q10 MID basesQ20 in MID %Ratio of Q20 MID basesQ30 in MID %Ratio of Q30 MID basesNumber of low quality MIDNumber of MID with low quality bases% of low quality MIDRatio of MID with low quality basesNumber of MID with NNumber of MID with N base% of MID with NRatio of MID with N baseNumber of MID in specific sequenceNumber of MID mapped to specific sequences% of MID with specific sequenceRatio of MID mapped to specific sequencesQ10 in clean MID %Ratio of Q10 MID bases after filteringQ20 in clean MID %Ratio of Q20 MID bases after filteringQ30 in clean MID %Ratio of Q30 MID bases after filteringNumber of exact MIDNumber of reads exactly mapped to MID% of exact MIDRatio of reads exactly mapped to MIDNumber of inexact MIDNumber of reads inexactly mapped to MID% of inexact MIDRatio of reads inexactly mapped to MID 注释统计信息 read 经过基因注释之后，该环节的统计文件、详细信息被保存在 /STEREO_ANALYSIS_WORKFLOW/ANNOTATION/*.bam.summary.stat目录下。 MetricDescriptionNumber of total readsNumber for total reads aligned to genomeNumber of reads to be annotatedNumber of reads that will be annotated with GTF/GFF annotation database% of reads to be annotated% of reads that will be annotated with GTF/GFF annotation databaseNumber of uniquely mapped reads to be annotatedNumber of reads to be annotated which are uniquely mapped to genome% of uniquely mapped reads to be annotatedRatio of reads to be annotated which are uniquely mapped to genomeNumber of multi-mapped reads to be annotatedNumber of reads to be annotated which are multi-mapped to genome% of multi-mapped reads to be annotatedRatio of reads to be annotated which are multi-mapped to genomeNumber of multi-mapped readsNumber of reads multi-mapped to genomeNumber of reads mapped to transcriptomeNumber of reads mapped to transcriptome, including exon and intron regions.% of reads mapped to transcriptome% of reads mapped to transcriptome, including exonic and intronic regions.Number of unique captures (on CID, gene and MID)Number of unique captures for reads, based on CID, gene and MID information% of unique captures (on CID, gene and MID)% of unique captures for reads, based on CID, gene and MID informationNumber of duplicated readsNumber of duplicated captures for reads, based on CID, gene and MID information% of duplicated reads% of duplicated captures for reads, based on CID, gene and MID informationNumber of reads to be annotatedNumber of reads that will be annotated with GTF/GFF annotation databaseNumber of reads mapped to exonic regionsNumber of reads mapped to exonic regions% of reads mapped to exonic regions% of reads mapped to exonic regionsNumber of reads mapped to intronic regionsNumber of reads mapped to intronic regions% of reads mapped to intronic regions% of reads mapped to intronic regionsNumber of reads mapped to intergenic regionsNumber of reads mapped to intergenic regions% of reads mapped to intergenic regions% of reads mapped to intergenic regionsNumber of reads mapped antisense to geneNumber of reads mapped antisense to gene% of reads mapped antisense to gene% of reads mapped antisense to geneNumber of reads mapped to rRNANumder of reads mapped to rRNA regionsNumber of rRNA reads in uniquely mappedNumder of uniquely mapped reads mapped to rRNA regions% of rRNA reads in uniquely mapped% of uniquely mapped reads mapped to rRNA regionsNumber of rRNA reads in multi-mappedNumder of multi-mapped reads mapped to rRNA regions% of rRNA reads in multi-mapped reads% of multi-mapped reads mapped to rRNA regions Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/matrices.html":{"url":"analysis/outputs/matrices.html","title":"Matrices","keywords":"","body":"MatricesGene Expression File (GEF)Gene Expression Matrix (GEM)文件类型常见矩阵文件微生物相关Matrices Gene Expression File (GEF) 基因表达文件 (GEF) 是一种数据管理和存储格式，旨在支持多维数据集和高计算效率。Stereo-seq 分析工作流程生成 bin GEF 和 cellbin GEF 文件。Bin GEF 文件格式是一种分层结构的数据模型，以各种 bin 大小存储一个或多个组合的基因表达矩阵。Cellbin GEF 文件格式存储每个细胞内的表达信息。每个 GEF 容器组织一个空间基因表达矩阵集合。它包括两个主要数据对象：Group 和 Dataset。数据集是数据元素的多维数组。Group 对象类似于以层次结构组织数据集和其他组的文件系统目录。 Gene Expression Matrix (GEM) 基因表达矩阵 (GEM) 存储基因空间表达数据。SAW 在分析流程中生成多个基因表达矩阵文件，基本格式需要六列，标题行显示列名。六列分别是基因 ID、基因名称、x 坐标、y 坐标、MID 计数和 exon 计数，如果是 cellbin 数据，那么会有第七列记录细胞 ID。最大面积外接矩形区域的表达矩阵标题在列行前有多个以“#”开头的注释行，标题字段名称和字段类型在表中描述。 文件类型 SAW 分析流程输出的表达矩阵文件主要包括两种类型，bin GEF 和 cellbin GEF。可以通过文件后缀名来快速识别： File extensionDescription.gefThe feature expression matrix file in HDF5 format for visualization. It contains the MID count for each gene of each spot. A spot is a binning unit that has a fixed-sized square shape in which the expression value in this square is accumulated. By default, a visualization .gef includes spot sizes of bin 1, 5, 10, 20, 50, 100, 150, 200..cellbin.gefThe cellbin feature expression matrix file in HDF5 format. It contains the spatial location and area of each cell, the MID count for each gene of each cell, and the cluster the cell belongs to. In .cellbin.gef, the cell is the smallest data unit.Only available when the cell segmentation was done based on an microscopy image. 常见矩阵文件 SAW count 和 SAW realign 输出的表达矩阵文件通常为： FileDescription.raw.gefFeature expression matrix includes the whole information over a complete chip region. It only has bin1 expression counts. .gefFeature expression matrix. It is also a visualization GEF that includes expression counts for bin1, 5, 10, 20, 50, 100, 150, 200..tissue.gefFeature expression matrix under the tissue coverage region. It is also a visualization GEF that includes expression counts for bin1, 5, 10, 20, 50, 100, 150, 200..cellbin.gefCellbin feature expression matrix records the information of cells individually, including the centroid coordinate, boundary coordinates, expression of genes, and cell area..adjusted.cellbin.gefCellbin expression matrix with cell border expanding, based on __mask_edm_dis_.tif. 微生物相关 基于 Stereo-seq N FFPE 组织样本进行分析，在运行 SAW count 分析任务时，设置--microorganism-detect 参数，输出的微生物相关的表达矩阵文件就被保存在 /outs/feature_expression/microorganism 目录下，具体内容如下： FileDescription.microorganism.raw.gefFeature expression matrix of microorganisms includes the whole information over a complete chip region. It only has bin1 expression counts. .microorganism.gefFeature expression matrix of microorganisms. It is also a visualization GEF that includes expression counts for bin1, 5, 10, 20, 50, 100, 150, 200..host_microorganism.raw.gefFeature expression matrix of microorganisms and the host includes the whole information over a complete chip region. It only has bin1 expression counts. .host_microorganism.gefFeature expression matrix of microorganisms and the host. It is also a visualization GEF that includes expression counts for bin1, 5, 10, 20, 50, 100, 150, 200..microorganism..gemFeature expression matrix of a specific classification of microbes. Classifications of microorganisms include phylum, class, order, family, genus, and species. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/images.html":{"url":"analysis/outputs/images.html","title":"Images","keywords":"","body":"Images自动图像算法处理无图流程Images 自动图像算法处理 如果在启动 SAW count 或 SAW realign 分析时加入了图像数据，图像相关的结果文件将被保存在/outs/image 目录下，具体内容取决于图像 QC 结果和手动处理信息。 FileDiscription*_regist.tifThe panoramic image, having been registered with the raw expression matrix, is from staining layers in TIFF format.*_tissue_cut.tifTissue segmentation result of the registered panoramic image.*_mask.tifCell segmentation result of the registered panoramic image.*_mask_edm_dis_10.tifThe result of the cell border expanding is based on the cell segmentation image. *_mask.tif. dis_10 represents the expansion of 10 pixels. 对于每个图像文件类型，这里以一个小鼠全脑样本为例进行展示： Registered panoramic image Tissue segementation in purple Cell segmentation Adjusted cell segmentation 无图流程 如果在启动 SAW count 或 SAW realign 分析时没有加入图像数据，或者图像 QC 结果为失败，分析流程会基于表达矩阵进行组织分割。 FileDiscriptionbin1_img_tissue_cut.tifTissue segmentation result of the expression data. 这里以一个小鼠小肠样片为例进行展示： Heatmaop of expression matrix Tissue segementation based on expression data Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"analysis/outputs/analysis.html":{"url":"analysis/outputs/analysis.html","title":"Analysis","keywords":"","body":"Analysis聚类分析差异表达分析Analysis 聚类分析 SAW count, realign 和 reanalyze 分析流程以 AnnData H5AD 格式输出空间聚类结果，其中了数据记录预处理、降维、聚类和差异表达分析的信息结果。 H5AD 中的聚类结果和 UMAP 降维信息可以在 StereoMap 中实现可视化。 这里详细展开了一个H5AD文件中的记录信息： $ h5dump -n /outs/analysis/.bin200_1.0.h5ad ## you can also check .cellbin_1.0.h5ad HDF5 \"/outs/analysis/.bin200_1.0.h5ad\" { FILE_CONTENTS { group / dataset /X group /layers group /obs dataset /obs/_index group /obs/leiden dataset /obs/leiden/categories dataset /obs/leiden/codes dataset /obs/n_genes_by_counts group /obs/orig.ident dataset /obs/orig.ident/categories dataset /obs/orig.ident/codes dataset /obs/pct_counts_mt dataset /obs/total_counts dataset /obs/x dataset /obs/y group /obsm dataset /obsm/X_pca dataset /obsm/X_umap dataset /obsm/spatial group /obsp group /obsp/connectivities dataset /obsp/connectivities/data dataset /obsp/connectivities/indices dataset /obsp/connectivities/indptr group /obsp/distances dataset /obsp/distances/data dataset /obsp/distances/indices dataset /obsp/distances/indptr group /raw group /raw/X dataset /raw/X/data dataset /raw/X/indices dataset /raw/X/indptr group /raw/var dataset /raw/var/_index dataset /raw/var/mean_umi dataset /raw/var/n_cells dataset /raw/var/n_counts group /raw/var/real_gene_name dataset /raw/var/real_gene_name/categories dataset /raw/var/real_gene_name/codes group /raw/varm group /uns dataset /uns/bin_size dataset /uns/bin_type group /uns/gene_exp_leiden dataset /uns/gene_exp_leiden/1 ... dataset /uns/gene_exp_leiden/_index group /uns/hvg dataset /uns/hvg/method group /uns/hvg/params dataset /uns/hvg/source dataset /uns/leiden_resolution group /uns/neighbors dataset /uns/neighbors/connectivities_key dataset /uns/neighbors/distance_key group /uns/rank_genes_groups dataset /uns/rank_genes_groups/logfoldchanges group /uns/rank_genes_groups/mean_count dataset /uns/rank_genes_groups/mean_count/1 ... dataset /uns/rank_genes_groups/mean_count/_index dataset /uns/rank_genes_groups/names group /uns/rank_genes_groups/params dataset /uns/rank_genes_groups/params/corr_method dataset /uns/rank_genes_groups/params/groupby dataset /uns/rank_genes_groups/params/method dataset /uns/rank_genes_groups/params/reference dataset /uns/rank_genes_groups/params/use_raw group /uns/rank_genes_groups/pts dataset /uns/rank_genes_groups/pts/1 ... dataset /uns/rank_genes_groups/pts/_index group /uns/rank_genes_groups/pts_rest dataset /uns/rank_genes_groups/pts_rest/1 ... dataset /uns/rank_genes_groups/pts_rest/_index dataset /uns/rank_genes_groups/pvals dataset /uns/rank_genes_groups/pvals_adj dataset /uns/rank_genes_groups/scores dataset /uns/resolution group /uns/sn dataset /uns/sn/_index dataset /uns/sn/batch dataset /uns/sn/sn group /var dataset /var/_index dataset /var/dispersions dataset /var/dispersions_norm dataset /var/highly_variable dataset /var/mean_umi dataset /var/means dataset /var/n_cells dataset /var/n_counts group /var/real_gene_name dataset /var/real_gene_name/categories dataset /var/real_gene_name/codes group /varm group /varp } } 差异表达分析 SAW count, realign 和 reanalyze 会以 CSV 格式输出差异表达分析结果。 差异表达分析的 CSV 结果文件有两种，分别为 find_marker_genes.csv 和 _marker_features.csv。 find_marker_genes.csv 是差异表达分析的原始输出结果 _marker_features.csv 中的数据信息经过整理，格式经过调整，更加简洁明了。 对于每个类群的特征信息，主要计算以下指标：： 平均 MID Count 表达占比的Log2变化值 校正后的 p-value 基因在类群内的表达占比 ```csv Feature ID,Feature Name,Cluster 1 Mean MID Count,Cluster 1 Log2 fold change,Cluster 1 Adjusted p-value,Cluster 1 % of expressed, ... ,Cluster 20 Mean MID Count,Cluster 20 Log2 fold change,Cluster 20 Adjusted p-value,Cluster 20 % of expressed ENSMUSG00000016559,H3f3b,67.1754386,42.00155933,1.76E-41,1, ... ,0.076923077,-63.19518177,0,0.076923077 ``` _marker_features.csv 中记录的差异表达分析结果可在 StereoMap 中查看，或直接使用 Excel 打开。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/":{"url":"shi-yong-jiao-cheng/","title":"使用教程","keywords":"","body":"使用教程使用教程 Select a tutorial based on your kit version or analysis scenarios! 根据你的分析场景和需求选择合适的软件使用教程。 设置 SAW下载和安装 SAW 软件SAW for Stereo-seq FF学习如何使用 FF (fresh fozen) 样本数据开展 SAW 分析SAW for Stereo-seq FFPE学习如何使用 FFPE (formalin-fixed paraffin-embedded) 样本数据开展 SAW 分析With manually processed files学习如何使用 StereoMap 输出的手动处理图像重启分析SAW for Stereo-CITE FF即将发布 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/preparation-of-reference.html":{"url":"shi-yong-jiao-cheng/preparation-of-reference.html","title":"比对索引构建","keywords":"","body":"比对索引构建SAW makeRef转录组比对微生物分析SAW checkGTF比对索引构建 对于参考基因组和注释文件，SAW 软件提供了两个辅助分析流程，SAW makeRef 和 SAW checkGTF， 在运行 SAW count 分析任务之前，需要预先构建一个或多个参考基因组的索引文件。 SAW makeRef 用于构建SAW count需要参考基因组索引文件的辅助分析流程。 SAW makeRef 支持三种常用生信分析软件的索引构建，使用 --mode 参数来指定运行的模式。 转录组比对 STAR 索引文件 需要注释文件 （GTF/GFF） 和参考基因组 （FASTA） 来构建索引文件，用于测序 reads 的比对和注释。 ```sh cd /saw/datasets/reference saw makeRef \\ --mode=STAR \\ --fasta=/path/to/FASTA1 \\ --gtf=/path/to/GTF/or/GFF \\ --genome=./transcriptome ``` --genome 参数需要传入一个不存在的文件夹路径，程序会自动创建。 运行命令行后，程序会自动生成 SAW 分析所需的目录结构，在 --genome 目录下生成索引文件和其他相关文件，包括: ./transcriptome/fasta- 所有输入 FASTA 文件 ./transcriptome/genes - 注释文件 ./transcriptome/STAR 由 STOmics Tech 优化算法后的 STAR 索引文件 ```sh /saw/datasets/reference/transcriptome ├── fasta │   └── genome.fa ├── genes │   └── genes.gtf └── STAR ├── chrLength.txt ├── chrNameLength.txt ├── chrName.txt ├── chrStart.txt ├── exonGeTrInfo.tab ├── exonInfo.tab ├── FMindex ├── geneInfo.tab ├── Genome ├── genomeParameters.txt ├── SA ├── SAindex ├── SAindexAux ├── sjdbInfo.txt ├── sjdbList.fromGTF.out.tab ├── sjdbList.out.tab └── transcriptInfo.tab ``` 添加 rRNA 信息至参考基因组 如果计划在 SAW 分析中去除 rRNA 片段，使用 --rRNA-FASTA 参数来指定 rRNA 信息，将添加其到参考基因组 --fasta 中。 信息处理的关键步骤： Step 1：鉴于传至 --rRNA-FASTA 参数的 rRNA 信息具有片段短且重复度高的特点，流程首先会对其进行去冗余； Step 2：将 rRNA 信息添加到 --fasta 文件中，会在染色体信息列上增加“_rRNA”后缀，例如：“1_rRNA”，以区分 rRNA 区域和基本的参考基因组； Step 3：基于添加了去重 rRNA 信息的参考基因组，构建索引文件。 ```sh cd /saw/datasets/reference saw makeRef \\ --mode=STAR \\ --fasta=/path/to/FASTA \\ --gtf=/path/to/GTF/or/GFF \\ --rRNA-fasta=/path/to/rRNA/FASTA \\ --genome=./transcriptome_with_rRNA ``` 输出结果和目录结构不变： /saw/datasets/reference/transcriptome_with_rRNA ├── fasta │ └── genome.fa ├── genes │ └── genes.gtf └── STAR ├── chrLength.txt ├── chrNameLength.txt ├── chrName.txt ├── chrStart.txt ├── exonGeTrInfo.tab ├── exonInfo.tab ├── FMindex ├── geneInfo.tab ├── Genome ├── genomeParameters.txt ├── SA ├── SAindex ├── SAindexAux ├── sjdbInfo.txt ├── sjdbList.fromGTF.out.tab ├── sjdbList.out.tab └── transcriptInfo.tab 快速使用 SAW count 分析对所使用的索引文件目录结构有要求，请按如下方式设置 --reference参数： ... --reference=/saw/datasets/reference/transcriptome or --reference=/saw/datasets/reference/transcriptome_with_rRNA 微生物分析 SAW count 支持对 Stereo-seq FFPE 的组织样本开展微生物分析，如果你的样本适用微生物比对分析，请在运行 SAW count 时同时设置 --microorganism-detect 和 --ref-libraries 在启动分析之前，应分别构建所需的索引文件，STAR 用于宿主的转录组比对，Bowtie2 用于去除宿主的基因组， Kraken2 用于微生物的探索和分类。 Bowtie2 索引文件 在 SAW count 分析流程中，在进行微生物比对分析前，需要使用 Bowtie2 工具从 unmapped reads 中去除宿主的基因组信息。 SAW count中 --unmapped-reads 参数的输出结果就是去宿主操作时的输入数据。 ```sh #Scenario 1 cd /saw/datasets/reference saw makeRef \\ --mode=Bowtie2 \\ --fasta=/path/to/host/FASTA1,/path/to/host/FASTA2,... \\ --basename=host \\ --genome=./Bowtie2 ``` 运行命令行后，输出目录包含这些文件： /saw/dataset/reference/Bowtie2 ├── human_genome_rRNA.fa #Host FASTA ├── human_genome_rRNA.1.bt2 ##Bowtie2 index files, suffixed with .bt2 ├── human_genome_rRNA.2.bt2 ├── human_genome_rRNA.3.bt2 ├── human_genome_rRNA.4.bt2 ├── human_genome_rRNA.rev.1.bt2 └── human_genome_rRNA.rev.2.bt2 SAW makeRef 提供了 bowtie2-build 构建索引时用到的基础、必要参数，用于 SAW count 的微生物分析。 有两种方法可以实现 Bowtie2 工具的全部功能： 使用原始 Bowtie2 软件。 使用--params-csv 参数，调用 Bowtie2 工具的原始参数命令。 ```sh # Senario 2 cd /saw/datasets/reference saw makeRef \\ --mode=Bowtie2 \\ --params-csv=/path/to/parameter/setting/Bowtie2_build.csv ``` --params-csv 中的参数设置内容： ```csv Parameter,Value ,/path/to/host/FASTA1,/path/to/host/FASTA2,... , ``` Kraken2 索引文件 Kraken2 是专为基因组的生物分类比对而设计开发的生信工具，在 SAW count 微生物比对分析中，可以快速准确地识别环境样本或复杂微生物群落中存在的微生物，你可以从 Kraken2 数据库网站 下载所需数据库。 ```sh #Scenario 1 cd /saw/datasets/reference ##Step 1 (optional) if needed,add FASTAs needed for a customed database saw makeRef \\ --mode=Kraken2 \\ --fasta=/path/to/host/FASTA1,/path/to/host/FASTA2,... \\ --database=/path/to/Kraken2/database ##Step 2 build saw makeRef \\ --mode=Kraken2 \\ --database=/path/to/Kraken2/database ``` 构建 Kraken2 索引文件时，无需指定--genome参数，直接基于 database 数据进行构建。 在构建客制化 database 的 Step 2 之前，需要在 database 目录下构建 ./taxonomy/，具体文件可以从 NCBI/Taxonomy 获取。 运行命令行后，输出目录包含以下文件： /saw/datasets/reference/Kraken2_db1 ├── hash.k2d ##Contains the minimizer to taxon mappings ├── opts.k2d ##Contains information about the options used to build the database ├── taxo.k2d ##Contains taxonomy information used to build the database ├── inspect.txt ├── seqid2taxid.map ├── database100mers.kmer_distrib ├── database150mers.kmer_distrib ├── database200mers.kmer_distrib ├── database250mers.kmer_distrib ├── database300mers.kmer_distrib ├── database50mers.kmer_distrib └── database75mers.kmer_distrib SAW makeRef 提构建索引时用到的基础、必要参数，用于 SAW count 的微生物分析。 有两种方法可实现 Kraken2 的全部功能。 使用原始 Kraken2 。 使用--params-csv 参数，调用 Kraken2 工具的原始参数命令。 ```sh #Scenario 2 cd /saw/datasets/reference saw makeRef \\ --mode=Kraken2 \\ --params-csv=/path/to/parameter/setting/Kraken2_build.csv ``` --params-csv 中的参数设置内容： ```csv Parameter,Value --add-to-library,/path/to/fasta --db,/path/to/db ``` Reference libraries 在为 STAR、Bowtie2 和 Kraken2 构建索引文件后，需要构建一个 --ref-libraries 参数所需的配置 CSV，将微生物比对分析需要用到的数据文件进行整合。 Reference,Type /saw/datasets/reference/transcriptome,STAR /saw/datasets/reference/Bowtie2,Bowtie2 /saw/datasets/reference/Kraken2_db1,Kraken2 --ref-libraries 与 --reference两个参数不可同时使用！ SAW checkGTF SAW count 的分析任务只能接受标准格式的注释文件，所以在 SAW count 进行 reads 注释之前会自动校验文件。除了之外，还能够通过它实现特定注释信息内容的提取。 SAW 允许接入的注释文件的文件后缀名包括：gtf/gtf.gz、gff/gff.gz、gff3/gff3.gz 。 如果注释文件存在以下格式问题（常见的错误），SAW checkGTF 将进行简单地更正，以确保文件能够被正常使用。 IssueSolutionIn the seventh column indicating the sense and antisense strands, \"-\" and \"_\" symbols are mistakenly mixed.Check each row of the annotation file and correct the error symbol \"_\" to \"-\".Any of \"transcript_id\", \"transcription_name\", \"gene_id\", \"gene_name\" is missed in GTF.For each row, use the existing information of ID and name to fill in the missing items.Part of gene or transcript rows are absent in GTF.According to the attributes of exon rows, including gene, transcript, id and name, add the missing gene and transcript rows to the file.Part of mRNA rows lack parent information in GFF.Use the parent information of the previous neighboring record to fill in the missing one. 运行命令进行注释文件的格式检查： saw checkGTF \\ --input-gtf=/path/to/input/GTF/or/GFF \\ --output-gtf=/path/to/output/GTF/or/GFF If you want to extract specific annotations, like gene_biotype:protein_coding or gene_biotype:lincRNA, run as: 如果想要提取特定的注释信息，例如： gene_biotype:protein_coding 或 gene_biotype:lincRNA，可以这样运行程序： saw checkGTF \\ --input-gtf=/path/to/input/GTF/or/GFF \\ --attribute=key:value \\ --output-gtf=/path/to/output/GTF/or/GFF 如果 --attribute 启用，SAW checkGTF 将提取特定的注释信息，但不进行文件格式的检查。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/stereo-seq-ff.html":{"url":"shi-yong-jiao-cheng/stereo-seq-ff.html","title":"Stereo-seq FF 分析","keywords":"","body":"Stereo-seq FF 分析基本要求SAW count 流程概述 Demo 数据参数命令运行 SAW count探索输出目录Stereo-seq FF 分析 本教程将指导你如何使用 SAW count 进行任务分析，演示数据来自 Stereo-seq 芯片捕获的 FF (新鲜冷冻) 小鼠肾脏组织样本。 基本要求 为顺利运行 SAW count流程，需要先确认： 熟悉 Linux 系统； 熟悉运行命令行工具； 确保计算系统满足最低配置要求。 在运行分析流程之前，确保计算环境中有存储空间充足，以及运行账号有足够的权限等级。 SAW count 流程概述 使用 SAW count 分析 FF 组织样本的 Stereo-seq 测序数据。 启动分析任务前，通常需要准备好以下文件： 芯片 mask 文件（记录 Stereo-seq 芯片的 CID 信息） FASTQ 测序数据（Stereo-seq 测序下机数据） reference 文件（参考基因组的索引文件，根据物种进行选择） 一张或多张显微镜图像（TIFF 或来自 StereoMap 的图像 .tar.gz） 来自 StereoMap 的压缩图像.tar.gz 文件 ，保存了原始的显微镜图像和 图像 QC 信息。 输出结果主要包括： 比对和注释后的 BAM 文件； 处理后的图像文件； 不同维度的基因表达矩阵； 聚类​​和差异表达分析结果； 可视化文件 visualization.tar.gz ， 用于 StereoMap。 Demo 数据 本教程页面使用了 Stereo-seq Chip T 捕获的小鼠肾脏组织样本。 C02533C1 数据基本信息如下： 芯片尺寸：1cm * 1cm (S1) Bin1： 500 nm * 500 nm 10μm 厚度的组织切片 Motic 显微镜拍摄得到的 H\\&E 染色图像 在数据集页面下载芯片 mask 文件、测序 FASTQ 数据、TIFF 图像或图像 tar.gz 文件，以及 reference 文件。为了更好地归纳和整理数据，建议为不同类型的文件创建对应的文件夹。 $ cd /saw # Create sub-folders of different datasets $ mkdir -p datasets/fastqs datasets/mask datasets/image datasets/reference 参数命令 在工作目录下，运行设置 SAW count 参数命令： saw count \\ --id= \\ --sn= \\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq T FF V1.2\" \\ --sequencing-type=\"PE100_50+100\" \\ --chip-mask=/path/to/chip/mask \\ --organism= \\ --tissue= \\ --fastqs=/path/to/fastq/folders \\ --reference=/saw/datasets/reference \\ --image-tar=/path/to/image/tar 命令行中参数的简要说明： ParameterDescription--id(Optional, default to None) A unique task id ([a-zA-Z0-9_-]+) which will be displayed as the output folder name and the title of HTML report. If the parameter is absent, --sn will play the same role.--sn (Required, default to None) SN (serial number) of the Stereo-seq chip.--omics (Required, default to \"transcriptomics\") Omics information.--kit-version (Required, default to None) The version of the product kit. More in count pipeline introduction.--sequencing-type (Required, default to None) Sequencing type of FASTQs which is recorded in the sequencing report.--chip-mask (Required, default to None) Stereo-seq chip mask file.--organism (Optional, default to None) Organism type of sample, usually referring to species.--tissue (Optional, default to None) Physiological tissue of sample.--reference (Optional, default to None) Path to the reference folder, containing SAW-compatible index files and GTF/GFF, built by SAW makeRef.--fastqs (Required, default to None) Path(s) to folder(s), containing all needed FASTQs. If FASTQs are stored in multiple directories, use it as: --fastqs=/path/to/directory1,/path/to/directory2,.... Notice that all FASTQ files under these directories will be loaded for analysis. --image (Optional, default to None) TIFF image for QC (quality control), combined with expression matrix for analysis.Name rule for input TIFF :a. _.tifb. _.tiffc. _.TIFd. _.TIFF includes:a. ssDNAb. DAPIc. HE (referring to H&E)d. _IF, _IF, ...--image-tar (Optional, default to None) The compressed image .tar.gz file from StereoMap has been through prepositive QC (quality control). 运行 SAW count 在工作目录下，运行设置 SAW count 分析任务： cd /saw/runs saw count \\ --id=Demo_Mouse_Kidney \\ --sn=C02533C1 \\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq T FF V1.2\" \\ --sequencing-type=\"PE100_50+100\" \\ --chip-mask=/saw/datasets/mask/C02533C1.barcodeToPos.h5 \\ --organism=mouse \\ --tissue=kidney \\ --fastqs=/saw/datasets/fastqs \\ --reference=/saw/datasets/reference \\ --image-tar=/saw/datasets/image/C02533C1_SC_20240327_201353_4.0.0.tar.gz 如果您输入图像为 TIFF 格式，文件名的前缀应为： \\_\\_*.tif 免疫荧光染色 (IF) 图像应为： \\_\\_IF_*.tif 例如： C04144D5_ssDNA.tif SS200000135TL_D1_DAPI.tif C02533C1_HE.tif (HE 指 H\\&E 染色) SS200000059_NC_DAPI.tif、SS200000059_NC_TESK2_IF.tif、SS200000059_NC_APAK3_IF.tif，…… 探索输出目录 分析任务运行结束后，在工作目录下会生成一个名为 Demo_Mouse_Kidney 的输出文件夹，它的命名取决于 --id 参数，当--id参数没有启用时取决于 --sn 参数的信息。 SAW count 分析任务通常在工作目录下开启，在该目录下，将找到一个名为 --id 或 --sn（当--id参数没有启用时）的文件夹。输出结果依据数据类型被分类，主要文件被保存在 /outs下。 下面列出了 SAW count 的输出文件目录结构和内容： Demo_Mouse_Kidney ├── pipeline-logs ├── STEREO_ANALYSIS_WORKFLOW_PROCESSING └── outs ├── analysis ├── bam ├── feature_expression ├── image ├── .report.tar.gz └── visualization.tar.gz 进一步探究流程输出结果 ： 跳转至HTML报告解读； 熟悉 visualization.tar.gz 可视化文件； 了解输出结果中的各种文件类型。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/stereo-seq-ffpe.html":{"url":"shi-yong-jiao-cheng/stereo-seq-ffpe.html","title":"Stereo-seq FFPE 分析","keywords":"","body":"Stereo-seq FFPE 分析基本要求SAW count 流程概述 Demo 数据参数命令运行 SAW count探索输出目录Stereo-seq FFPE 分析 本教程将指导你如何使用 SAW count 进行任务分析，演示数据来自 Stereo-seq 芯片捕获的 FFPE （福尔马林固定，石蜡包埋）小鼠全脑组织样本。 基本要求 为顺利运行 SAW count流程，需要先确认： 熟悉 Linux 系统； 熟悉运行命令行工具； 确保计算系统满足最低配置要求。 在运行分析流程之前，确保计算环境中有存储空间充足，以及运行账号有足够的权限等级。 SAW count 流程概述 使用 SAW count 分析 FFPE 组织样本的 Stereo-seq 测序数据。 启动分析任务前，通常需要准备好以下文件： 芯片 mask 文件（记录 Stereo-seq 芯片的 CID 信息） FASTQ 测序数据（Stereo-seq 测序下机数据） reference 文件（参考基因组的索引文件，根据物种进行选择） 一张或多张显微镜图像（TIFF 或来自 StereoMap 的图像 .tar.gz） 来自 StereoMap 的压缩图像.tar.gz 文件 ，保存了原始的显微镜图像和 图像 QC 信息。 输出结果主要包括： 比对和注释后的 BAM 文件； 处理后的图像文件； 不同维度的基因表达矩阵； 聚类​​和差异表达分析结果； 可视化文件 visualization.tar.gz ， 用于 StereoMap。 Demo 数据 本教程页面使用了 Stereo-seq Chip T 捕获的小鼠肾脏组织样本。 C02533C1 数据基本信息如下： 芯片尺寸：1cm * 1cm (S1) Bin1： 500 nm * 500 nm 5μm 厚度的组织切片 Motic 显微镜拍摄得到的 ssDNA 染色图像 在数据集页面下载芯片 mask 文件、测序 FASTQ 数据、TIFF 图像或图像 tar.gz 文件，以及 reference 文件。为了更好地归纳和整理数据，建议为不同类型的文件创建对应的文件夹。 $ cd /saw # Create sub-folders of different datasets $ mkdir -p datasets/fastqs datasets/mask datasets/image datasets/reference 参数命令 在工作目录下，运行设置 SAW count 参数命令： saw count \\ --id= \\ --sn= \\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq N FFPE V1.0\" \\ --sequencing-type=\"PE75_25+59\" \\ --chip-mask=/path/to/chip/mask \\ --organism= \\ --tissue= \\ --fastqs=/path/to/fastq/folders \\ --reference=/saw/datasets/reference \\ --image-tar=/path/to/image/tar 对于 FFPE 样本，SAW count 支持进行微生物比对分析，需要设置 --microorganism-detect 和 --ref-libraries 参数。 --ref-libraries 配置CSV 文件整合了STAR、Bowtie2 和 Kraken2 的索引文件信息。有关构建 reference 的详细内容请参阅 SAW makeRef 教程。 --ref-libraries 与 --reference 两个参数不兼容。 你需要评估你的组织样本是否适合进行微生物比对分析，这可能与前序步骤中的生化实验部分有关。 命令行中参数的简要说明： ParameterDescription--id(Optional, default to None) A unique task id ([a-zA-Z0-9_-]+) which will be displayed as the output folder name and the title of HTML report. If the parameter is absent, --sn will play the same role.--sn (Required, default to None) SN (serial number) of the Stereo-seq chip.--omics (Required, default to \"transcriptomics\") Omics information.--kit-version (Required, default to None) The version of the product kit. More in count pipeline introduction.--sequencing-type (Required, default to None) Sequencing type of FASTQs which is recorded in the sequencing report.--chip-mask (Required, default to None) Stereo-seq chip mask file.--organism (Optional, default to None) Organism type of sample, usually referring to species.--tissue (Optional, default to None) Physiological tissue of sample.--reference (Optional, default to None) Path to the reference folder, containing SAW-compatible index files and GTF/GFF, built by SAW makeRef.--ref-libraries (Optional, default to None) Path to a ref_libraries.csv which declares reference indexes, built by SAW makeRef. Not compatible with --reference.--fastqs (Required, default to None) Path(s) to folder(s), containing all needed FASTQs. If FASTQs are stored in multiple directories, use it as: --fastqs=/path/to/directory1,/path/to/directory2,.... Notice that all FASTQ files under these directories will be loaded for analysis. --image (Optional, default to None) TIFF image for QC (quality control), combined with expression matrix for analysis.Name rule for input TIFF :a. _.tifb. _.tiffc. _.TIFd. _.TIFF includes:a. ssDNAb. DAPIc. HE (referring to H&E)d. _IF, _IF, ...--image-tar (Optional, default to None) The compressed image .tar.gz file from StereoMap has been through prepositive QC (quality control).--microorganism-detect(Optional, default to None) Whether to perform analysis related to microorganisms. Notice that the detection only works for FFPE assay currently. 运行 SAW count 在工作目录下，运行设置 SAW count 分析任务： cd /saw/runs saw count \\ --id=Demo_Mouse_Brain \\ --sn=C04144D5 \\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq N FFPE V1.0\" \\ --sequencing-type=\"PE75_25+59\" \\ --chip-mask=/saw/datasets/chip_mask/C04144D5.barcodeToPos.h5 \\ --organism=mouse \\ --tissue=brain \\ --fastqs=/saw/datasets/fastqs \\ --reference=/saw/datasets/reference/mouse_transcriptome \\ --image-tar=/saw/datasets/image/C04144D5_SC_20240620_153.tar.gz 如果您输入图像为 TIFF 格式，文件名的前缀应为： \\_\\_*.tif 例如： C04144D5_ssDNA.tif SS200000135TL_D1_DAPI.tif C02533C1_HE.tif （HE 指 H\\&E 染色） 探索输出目录 分析任务运行结束后，在工作目录下会生成一个名为 Demo_Mouse_Brain 的输出文件夹，它的命名取决于 --id 参数，当--id参数没有启用时取决于 --sn 参数的信息。 SAW count 分析任务通常在工作目录下开启，在该目录下，将找到一个名为 --id 或 --sn（当--id参数没有启用时）的文件夹。输出结果依据数据类型被分类，主要文件被保存在 /outs下。 下面列出了 SAW count 的输出文件目录结构和内容： Demo_Mouse_Brain ├── pipeline-logs ├── STEREO_ANALYSIS_WORKFLOW_PROCESSING └── outs ├── analysis ├── bam ├── feature_expression ├── image ├── .report.tar.gz └── visualization.tar.gz 进一步探究流程输出结果 ： 跳转至HTML报告解读； 熟悉 visualization.tar.gz 可视化文件； 了解输出结果中的各种文件类型。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html":{"url":"shi-yong-jiao-cheng/shou-dong-tu-xiang-chu-li.html","title":"手动图像处理","keywords":"","body":"手动图像处理为什么要进行手动处理？SAW realign 概览第一次运行 SAW count手动处理配准组织分割细胞分割回到 SAW realign使用 QC 成功的图像使用 QC 失败的图像无图场景SAW realign 输出结果手动图像处理 为什么要进行手动处理？ 在某些情况下，SAW count 的输出结果不够完美，分析人员可能希望手动调整图像（需要结合表达矩阵），或使用第三方工具的算法处理结果，来得到令人满意的分析结果。 当数据的图像 QC 结果为不成功时，分析人员必须手动完成显微镜图像与空间特征表达矩阵之间的配准。 通常来说，细致的手动调整会让分析流程生成更准确的表达矩阵数据，用于下游生信分析。 SAW realign 概览 FF 和 FFPE 组织样本经手动处理过后都可以使用 SAW realign 重启分析， 在启动分析任务前，通常需要准备好以下文件： 相关联的 SAW count 的输出目录； 来自 StereoMap 的经过手动调整的图像.tar.gz 文件（包含手动处理信息） 来自 StereoMap 的重新对齐的压缩图像.tar.gz文件，保存了原始显微镜图像、图像 QC 信息和手动处理的信息记录。 Interaction between SAW and StereoMap 输出结果主要包括： 由关联 SAW count 分析而来的表达矩阵相关数据； 处理后的图像文件； 不同维度的基因表达矩阵； 聚类​​和差异表达分析结果； 可视化文件 visualization.tar.gz ， 用于 StereoMap。 ParameterDescription-id (Optional, default to None) A unique task id ([a-zA-Z0-9_-]+) which will be displayed as the output folder name and the title of HTML report. If the parameter is absent, --sn will play the same role.--sn (Required, default to None) SN (serial number) of the Stereo-seq chip.--count-data (Required, default to None) Output folder of the corresponding SAW count result, which mainly contains the expression matrices and other related datasets.--realigned-image-tar (Required, default to None) Compressed image file from StereoMap, which has been manually processed, including stitching, tissue segmentation, cell segmentation, calibration and registration.--lasso-geojson (Optional, default to None) Lasso GeoJSON from StereoMap is used for tissue segmentation when the analysis is without images. It is incompatible with --realigned-image-tar.--adjusted-distance (Optional, default to 10) Outspread distance based on the cellular contour of the cell segmentation image, in pixels. Default to 10. If --adjusted-distance=0, the pipeline will not expand the cell border. 当你没有提供显微镜图像数据用于分析时， StereoMap 输出的 lasso GeoJSON 可用作于进行再一次的组织分割，以提取新的 .tissue.gef 矩阵。 --lasso-geojson与 --realigned-image-tar 不兼容。 第一次运行 SAW count SAW count 的输入数据大致可分为三类： 图像 QC 结果为成功 图像 QC 结果为失败 没有显微镜图像 以上三种情况，运行 SAW count 后，输出目录中都会包含下列文件： Demo_Data ├── pipeline-logs ├── STEREO_ANALYSIS_WORKFLOW_PROCESSING └── outs ├── analysis ├── bam ├── feature_expression ├── image ├── .report.tar.gz └── visualization.tar.gz visualization.tar.gz不仅用于可视化展示，还可在 StereoMap 中进行图像手动调整，调整结果将记录在压缩图像 .tar.gz 文件中。 对于 QC 失败图像或无图像的分析任务，组织分割是基于表达矩阵数据进行的，因此这两种情况下的任务不会调用标准分析流程中的自动图像算法。 手动处理 StereoMap 中可以实现手动调整，包括图像-矩阵配准、手动组织分割和手动细胞分割，所有这些操作都可以 StereoMap 的Image Processing模块完成，实时看到修改修过，所见即所得。 配准 图像配准需要同时使用表达矩阵和显微镜图像，根据组织形态，分析人员可以将两个图像层靠拢对齐，直到配准效果达到分析人员的要求，配准操作对于后续步骤非常重要。 A matrix heatmap and an H&E-stained image for registration 组织分割 组织分割是指通过识别样本的生物学组织形态来探测其组织区域，借助显微镜图像，分析人员可识别组织样本在 Stereo-seq 芯片上的相对位置。 Tissue segmentation on an H&E-stained image 细胞分割 细胞分割是指通过识别细胞的形态来探测单个细胞的区域，根据细轮廓信息，可以进行细胞维度的深入分析和研究。 组织分割和细胞分割是生物信息学分析中的关键步骤，适当的分割结果对后续表达矩阵数据的提取和下游分析具有重要影响。 回到 SAW realign 使用 QC 成功的图像 本教程的第三部分至关重要，因为上一次 SAW count 分析任务的输出结果将帮助 SAW realign 以完成剩余工作，直到生成 HTML 报告。 cd /saw/runs saw realign \\ --id=Adjusted_Demo_Mouse_Brain \\ --sn=SS200000135TL_D1 \\ --count-data=/path/to/previous/SAW/count/task/folder \\ --realigned-image-tar=/path/to/realigned/image/tar SAW realign 和 SAW count 一样，会根据细胞分割结果自动对细胞轮廓进行外扩，默认为 10 个像素，可以通过设置 --adjusted-distance 来调整，可根据不同的组织样本和细胞类型来调整细胞轮廓的校正程度。 DNB 是 Stereo-seq 芯片上的捕获单元。 DNB 对应配准后图像的正方形像素块的顶点，如果细胞轮廓的扩展距离为 X 像素，则其物理距离估算为 X * 500 nm。 假如对细胞分割结果（手动处理或第三方工具生成的结果）非常满意，可以设置 --adjusted-distance=0 来关闭细胞修正功能。 如果只想获得手动调整后的压缩图像 .tar.gz 文件中的图像数据或表达矩阵矩阵，可以调用 --no-matrix 或 --no-report 参数。 运行分析，如下所示： cd /saw/runs saw realign \\ --id=Demo_Mouse_Brain_Only_Images \\ --sn=SS200000135TL_D1 \\ --count-data=/path/to/previous/SAW/count/task/folder \\ --realigned-image-tar=/path/to/realigned/image/tar \\ --no-matrix 使用 QC 失败的图像 在重启分析之前，必须对图像 QC 失败的数据完成手动配准操作，需要结果显微镜图像与表达矩阵。 SAW 认为，经过手动配准操作（与表达矩阵）的 QC 失败的图像，可以通过调用流程中的自动图像算法进行分析。 cd /saw/runs saw realign \\ --id=Adjuated_Demo_Mouse_Brain \\ --sn=SS200000135TL_D1 \\ --count-data=/path/to/previous/SAW/count/task/folder \\ --realigned-image-tar=/path/to/realigned/image/tar 无图场景 来自 StereoMap 的lasso GeoJSON 文件可以用于 SAW realign 分析流程，重新分割组织区域。 需要确认你使用的lasso GeoJSON文件中仅有一个 label 区域结果，因为SAW realign每次运行仅接收一个组织再分割结果。 仅在无图片输入的场景下有效，--lasso-json 无法与图像相关参数一起使用。 运行分析，如下所示： cd /saw/runs saw realign \\ --id=Lasso_Demo_Mouse_Brain \\ --sn=SS200000135TL_D1 \\ --count-data=/path/to/previous/SAW/count/task/folder \\ --lasso-geojson=/path/to/lasso/GeoJSON SAW realign 输出结果 分析任务运行结束后，在工作目录下会生成一个名为 Adjusted_Demo_Mouse_Brain 的输出文件夹，它的命名取决于 --id 参数，当--id参数没有启用时取决于 --sn 参数的信息。 SAW count 分析任务通常在工作目录下开启，在该目录下，将找到一个名为 --id 或 --sn（当--id参数没有启用时）的文件夹。输出结果依据数据类型被分类，主要文件被保存在 /outs下。 下面列出了 SAW realign 的输出文件目录结构和内容： Adjusted_Demo_Mouse_Brain ├── pipeline-logs ├── STEREO_ANALYSIS_WORKFLOW_PROCESSING └── outs ├── analysis ├── bam ├── feature_expression ├── image ├── .report.tar.gz └── visualization.tar.gz 进一步探究流程输出结果 ： 跳转至HTML报告解读； 熟悉 visualization.tar.gz 可视化文件； 了解输出结果中的各种文件类型。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/secondary-analysis.html":{"url":"shi-yong-jiao-cheng/secondary-analysis.html","title":"数据再分析","keywords":"","body":"数据再分析 聚类分析矩阵套索差异表达分析数据再分析 本教程将将展示如何运行辅助分析流程 SAW reanalyze，进行聚类分析、差异表达分析和 lasso 区域的表达矩阵提取。 聚类分析 在生信下游分析中，聚类是一种关键且基本的算法处理，可将具有相似特征的空间表达点归为同组，该过程有助于揭示表达数据中的底层结构和模式。 在进行分析前，需要根据数据的物种和组织类型来选择合适的 bin size 例如，哺乳动物细胞的直径约为 10 µm，DNB 的物理间距为 500 nm，因此 bin20 会是一个合适的选择。 调用 Leiden 算法 进行聚类时，--Leiden-resolution 参数的默认值为 1.0，它可以调控 Leiden 聚类时的分群颗粒度，值越大，分群簇越多。并且，可以开启 --marker 参数，基于 Leiden 算法的分群结果进行差异表达分析。 如果使用 bin GEF 进行聚类，运行命令如下： saw reanalyze \\ --gef=/path/to/input/GEF \\ --bin-size=20 \\ --Leiden-resolution=1.0 \\ --marker \\ --output=/path/to/output/clustering 基于 bin GEF 的聚类输出如下： clustering ├── .bin20_1.0.h5ad ##._.h5ad, containing analysis results ├── find_marker_genes.csv ##original output CSV └── bin20_marker_features.csv ##formatted CSV for visualization in StereoMap 在运行分析时开启 --marker ，将获得与差异表达分析相关的结果，即 find_marker_genes.csv 和 _marker_features.csv。 find_marker_genes.csv 是原始差异分析结果文件。 _marker_features.csv 是一个经过格式调整CSV，记录了每个类群的平均 MID count、L2FC、校正后的 p-value 和基因在类群内的表达占比等。 如果使用 cellbin GEF 进行聚类，运行命令如下： saw reanalyze \\ --cellbin-gef=/path/to/input/cellbin/GEF \\ --Leiden-resolution=1.0 \\ --marker \\ --output=/path/to/output/folder 基于 cellbin GEF 的聚类输出如下： clustering_analysis ├── .cellbin.gef ##a copy of input cellbin GEF but with new clustering information ├── .cellbin_1.0.h5ad ##.cellbin_.h5ad, containing analysis results ├── find_marker_genes.csv ##original output CSV └── cellbin_marker_features.csv ##formatted CSV for visualization in StereoMap 矩阵套索 StereoMap 中的交互式工具可以 lasso （手动圈选）感兴趣区域，它需要 SAW reanalyze 分析流程来协助将 lasso GeoJSON 中区域信息转化为特征表达矩阵。 Lasso in StereoMap 如果使用 bin GEF 进行 lasso，运行分析如下： saw reanalyze \\ --gef=/path/to/input/GEF \\ --lasso-json=/path/to/lasso/geojson \\ --bin-size=1,20,50 \\ --output=/path/to/output/folder --bin-size 参数可以接收一个列表，以便一次生成多个 bin size 的表达矩阵文件。 基于 bin GEF 的 lasso 输出如下： Lasso ├── │ ├── SN..label.gef ##lasso GEF of bin1 │ └── segmentation │ ├── SN.lasso...gem.gz ##GEM of lasso area of different bin sizes │ ... │ ├── SN.lasso...gem.gz │ └── SN.lasso..mask.tif ##mask image of lasso area └── ├── ... └── ... 如果使用 cellbin GEF 进行 lasso，运行分析如下： saw reanalyze \\ --cellbin-gef=/path/to/input/cellbin/GEF \\ --lasso-json=/path/to/lasso/GeoJSON \\ --output=/path/to/output/folder 基于 cellbin GEF 的 lasso 输出如下： lasso ├── │ └── SN..label.cellbin.gef ##cellbin GEF of lasso area └── └── ... 差异表达分析 SAW reanalyze 可以使用来自 StereoMap 的 diffexp GeoJSON 文件，基于聚类类群选择和套索区域进行差异表达分析。 选定的聚类类群和套索区域被记录在 diffexp GeoJSON 文件中。 运行分析如下： saw reanalyze \\ --count-data=/path/to/previous/SAW/count/result/folder/id \\ --de-json=/path/to/StereoMap/diffexp/GeoJSON \\ --output=/path/to/output/folder --count-data 是相关联的SAW count 分析任务的输出目录，SAW reanalyze 将自动搜索差异表达分析所需的数据文件。相关信息记录在 *.diffexp.geojson 中。 差异表达分析输出如下： Differential_expression ├── ._1.0.h5ad ##H5ad containing analysis results ├── find_marker_genes.csv ##original output CSV └── _marker_features.csv ##formatted CSV for visualization in StereoMap 或： Differential_expression ├── .cellbin_1.0.h5ad ##H5ad for cellbin containing analysis results ├── find_marker_genes.csv ##original output CSV └── cellbin_marker_features.csv ##formatted CSV for visualization in StereoMap Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shi-yong-jiao-cheng/shu-ju-ge-shi-zhuan-huan.html":{"url":"shi-yong-jiao-cheng/shu-ju-ge-shi-zhuan-huan.html","title":"数据格式转换","keywords":"","body":"数据格式转换表达矩阵相关visualizationgef2gemgem2gefbin2cellgef2h5adgem2h5adgef2img图像相关tar2imgimg2rpimergeoverlay数据格式转换 本教程将展示如何使用辅助分析流程 SAW convert 来实现基础的文件格式转换。为了让这工具更加简易好用，SAW convert 下设置了子模块用于具体执行转换任务，子模块通常被命名为\"A2B\"，表示从A格式转换到B格式的过程。 表达矩阵相关 visualization 转换原始 GEF 为 支持可视化的 GEF。 原始 GEF（Gene Expression File）仅在 bin1 维度上储存基因表达信息，是为了防止输出文件过大。然而，要在 StereoMap 中进行可视化，需要包含不同 bin size 的表矩阵信息，通常使用的 bin size 列表 [1, 5, 10, 20, 50, 100, 150, 200]。 saw convert visualization \\ --gef=/path/to/input/GEF \\ --bin-size=1,5,10,20,50,100,150,200 \\ --visualization-gef=/path/to/output/visualization/GEF gef2gem 转换 bin GEF 到 GEM。 GEM（Gene Expression Matrix）中记录的特征表达矩阵仅包含有一种 bin size，因此，在进行转换时需要设置明确的 --bin-size 参数。 saw convert gef2gem \\ --gef=/path/to/input/GEF \\ --bin-size=1 \\ --gem=/path/to/output/GEM 转换 cellbin GEF 到 cellbin GEM。 特别注意，在转换 cellbin GEF 为 cellbin GEM 的过程中，需要获取 DNB 的信息，所以需要加入 bin GEF 文件。 saw convert gef2gem \\ --cellbin-gef=/path/to/input/cellbin/GEF \\ --gef=/path/to/input/bin/GEF \\ --cellbin-gem=/path/to/output/cellbin/GEM gem2gef 转换 GEM 到 bin GEF。 如果输入GEM 是bin1 维度的表达矩阵，则输出的GEF（基因表达文件）将是一个支持可视化的 GEF，其中包括 bin1、5、10、20、50、100、150、200 的表达矩阵信息。 如果输入 GEM 不是 bin1 维度的表达矩阵，输出的 GEF 将只包含特定 bin size 的表达矩阵信息。 saw convert gem2gef \\ --gem=/path/to/input/GEM \\ --gef=/path/to/output/GEF 转换 cellbin GEM 到 cellbin GEF。 saw convert gem2gef \\ --cellbin-gem=/path/to/input/cellbin/GEM \\ --cellbin-gef=/path/to/output/cellbin/GEF bin2cell 转换 bin GEF 到 cellbin GEF。 细胞分割图记录了单个细胞的轮廓信息，可以用于提取细胞维度的表达矩阵文件。 saw convert bin2cell \\ --gef=/path/to/input/GEF \\ --image=/path/to/cell/segmentation/image \\ --cellbin-gef=/path/to/output/cellbin/GEF \\ --cellbin-gem=/path/to/output/CGEM gef2h5ad 转换 bin GEF 到 AnnData H5AD。 AnnData H5AD 是被广泛引用于下游分析的数据格式。AnnData包版本 >= 0.8.0。 saw convert gef2h5ad \\ --gef=/path/to/input/GEF \\ --bin-size=20 \\ --h5ad=/path/to/output/h5ad 转换 cellbin GEF 到 AnnData H5AD。 saw convert gef2h5ad \\ --cellbin-gef=/path/to/input/cellbin/GEF \\ --h5ad=/path/to/output/h5ad gem2h5ad 转换 GEM 到 AnnData H5AD。 saw convert gem2h5ad \\ --gem=/path/to/input/GEM \\ --bin-size=20 \\ --h5ad=/path/to/output/h5ad 转换cellbin GEM到AnnData h5ad。 saw convert gem2h5ad \\ --cellbin-gem=/path/to/input/cellbin/GEM \\ --h5ad=/path/to/output/h5ad gef2img 生成 bin GEF 的灰度热图，采用灰度图展示特征表达矩阵。 saw convert gef2img \\ --gef=/path/to/input/GEF \\ --bin-size=1 \\ --image=/path/to/output/heatmap/image 图像相关 tar2img 从压缩图像 .tar.gz 文件中提取 TIFF 图像，其中通常包含与表达矩阵配准后的显微镜图像，组织分割图像，和细胞分割图像。自动算法或手动处理的图像结果都记录在图像 .tar.gz 文件中。 saw convert tar2img \\ --image-tar=/path/to/input/image/tar \\ --image=/path/to/output/folder img2rpi 合成 TIFF 图像为 RPI 文件，用于 StereoMap 可视化展示。 Layer 图层的名字可以随意命名，但需遵从如下规则：/，例如：DAPI/TissueMask。如果是细胞分割结果相关的图层，建议名称前缀为\"CellMask\"，程序会自动将其转换为细胞轮廓进行展示。 saw convert img2rpi \\ --image=/path/to/input/image1,/path/to/input/image2,/path/to/input/image3... \\ --layers=DAPI/Image,DAPI/TissueMask,DAPI/CellMask... \\ --rpi=/path/to/output/rpi merge 合并多张图为一张图像（至多3张图）。 请注意，图像输入的顺序代表其颜色通道 R-G-B。 saw convert merge \\ --image=/path/to/input/image1,/path/to/input/image2,/path/to/input/image3 \\ --merged-image=/path/to/output/multichannel/image 合并显微镜图像 ssDNA_SS200000135TL_D1_regist.tif 和组织分割图 ssDNA_SS200000135TL_D1_tissue_cut.tif，可用于评估组织分割的效果。 显微镜图像 ssDNA_SS200000135TL_D1_regist.tif 和细胞分割图 ssDNA_SS200000135TL_D1_mask.tif 合并结果的部分区域，用于评估细胞分割的效果。 overlay 将通过矩阵推导的模板点叠加到图像上，用以检查图像 QC 识别到的图像模板点是否准确。 矩阵模板文件 _matrix_template.txt 可在 可视化文件 visualization.tar.gz 中找到。 saw convert overlay \\ --image=/path/to/input/image \\ --template=/path/to/input/template/txt \\ --overlaid-image=/path/to/output/overlaid/image 将矩阵模板点叠加到 ssDNA_SS200000135TL_D1_regist.tif 图像上，用以检查配准效果。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"algorithms/":{"url":"algorithms/","title":"算法原理","keywords":"","body":"算法原理算法原理 SAW Read Processing AlgorithmsEssential processing steps for read alignment, annotation and secondary analysis.SAW Image Processing AlgorithmsImage processing algorithms solve image problems and assist in generating expression matrices. *The interpretation of the Algorithm part is only available in EN. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"algorithms/gene-expression-algorithms.html":{"url":"algorithms/gene-expression-algorithms.html","title":"Read processing algorithms","keywords":"","body":"Read processing algorithmsAlignment & AnnotationCID mappingRNA filteringMID filteringGenome AlignmentAnnotation to transcriptomeMID correctionSecondary analysisDimensionality reduction Clustering Differential expression Read processing algorithms *The interpretation of the Algorithm part is only available in EN. Gene Expression Count during SAW count, for the FASTQ data from the Stereo-seq sequencing platform, includes the following analysis stages: Read processing workflow Regarding the key steps of read alignment and annotation, a flowchart is used to illustrate. Algorithm workflow Alignment & Annotation CID mapping CID mapping requires FASTQs and a chip mask file, recording position information for sequencing reads. Check the amount of Ns in Coordinate IDs: If there is 1 N base in CID, the N base will be replaced by A/T/C/G. CIDs without N bases will be directly poured into the match pool. CIDs with more than one N base will be discarded. In the absense of an N base, if a CID does not match to any positions, each base of the CID will replaced by the other three types iterately until a successful match. After the mapping, only the unique CID match will be retained for subsequent steps. Workflow of CID mapping RNA filtering Before genome alignment, it is necessary to confirm that the reads entering the next step are cDNA sequences. Ideally, this part of the data only contains cDNA fragments, but there may be cases where the fragmented cDNA is too short or some non-cDNA fragments are detected. Reads will be discarded if any of the following conditions are triggered: mapped to adapter sequences, mapped to DNB sequences, with a length of less than 30 after cutting out the poly-A sequence. The above three are collectively known as \"non-relevant short reads\". MID filtering MID sequences will be filtered out if they match any of the following: having more than one base with quality having N bases >= 1. Genome Alignment To align reads to the genome with splicing awareness, SAW utilizes the STAR aligner. Using a transcript annotation GTF/GFF file, the system classifies reads as exonic, intronic, or intergenic ones based on their alignment. If a read shares at least 50% of its overlap with an exon, it is considered exonic XF:i:0. If a sequence does not meet the criteria for exon but crosses an intron, it is called intronic XF:i:1. If it does not fit into either of the previous categories, it is called intergenic XF:i:2. The exonic locus is given priority, and the read is deemed to be reliably mapped to the exonic locus with a MAPQ of 255 for reads that align to one exonic locus but also to one or more non-exonic loci. Annotation to transcriptome In SAW, reads mapped to exonic and intronic regions are to be annotated, using the transcriptomic annotation file. Remove rRNA The preconditions for rRNA filtration are: switching --rRNA-remove on when runningSAW count, addition of rRNA information to the index files using SAW makeRef. Reads mapped to rRNA regions will have a tag of XF:i:3, and they will not move on to the next step. Transcriptome SAW estimates whether there is a successful annotating record based on the position of each read mapped to the genome and whether the alignment is located in a gene region. When the alignment direction of the read on the genome is consistent with that of a gene and overlaps with the gene >= 50% of the mapped length, the read will be considered to be annotated with the gene. If a read is annotated to multiple genes, the one with the longest overlap length with the gene is selected as the final result of the read. When the overlap lengths are the same, the read is considered to be annotated unsuccessfully. Interpretation of annotation Annotating types are classified according to the following rules: If the overlap between read and exon is >=50%, the read is considered to originate from the exonic region of the gene, otherwise, it originates from the intron region. Reads overlapped with genes but have inconsistent directions are classified as antisense. Reads that can be aligned to the genome but cannot be classified as gene or antisense are considered to be intergenic. MID correction At a position, if the MID counts of a certain gene >= 5, they will be corrected. After sorting the MID counts of a specific gene in descending order, the numerical values are corrected following the fundamental principle that allows a Hamming distance of 1. After correction, a tag of UB:Z:XXXXX will be added to the record. An example of MID correction Secondary analysis The secondary analysis, in SAW count and SAW realign, are performed using Stereopy. The procedure includes 6 main parts: Preprocess gene expression data from the tissue coverage region (normalize, logarithmize, identify highly variable genes, and scale each gene). Reduce the dimensionality of the data by running PCA. Compute the neighborhood graph and embed the neighborhood graph using UMAP. Clustering by Leiden algorithm. Perform differential expression analysis, using the t-test to find marker features. Output analysis result file in AnnData H5AD and marker feature CSV. Dimensionality reduction PCA: Spatiotemporal transcriptome data often contain thousands of genes, making the data high-dimensional and challenging to analyze. Principal Components Analysis (PCA) reduces dimensionality by transforming the data into a set of principal components (PCs) that capture the most significant variance. UMAP: SAW supports Uniform Manifold Approximation and Projection (UMAP), which is a popular non-linear dimensionality reduction technique that is particularly useful for visualizing high-dimensional data in a low-dimensional space. In the context of spatiotemporal transcriptome data analysis, it is beneficial to capture both local and global structures as it facilitates the interpretation of complex datasets. UMAP coordinates are available in the pipeline output H5AD, as well as being displayed in the HTML report and StereoMap. Clustering SAW uses Leiden algorithm for clustering spots by expression similarity, operating in the PCA representation. Leiden: an algorithm for network community detection, which is particularly important in bioinformatics analysis, especially in the analysis of spatial transcriptomic datasets. It is an enhanced version of Louvain's method, developed to address its potential instability and provide higher resolution and a more robust community structure. In bioinformatics, the primary roles and benefits of Leiden algorithm can be summarized as follows: Improved resolution and stability: the algorithm can effectively identify smaller community structures, which is crucial for understanding cellular heterogeneity and subtle changes in complex biological processes. Compared with Louvain's method, Leiden can offer more consistent and stable results across multiple runs. Efficient cell type identification: in the analysis of spatial transcriptomic sequencing data, Leiden clustering can assist researchers in identifying various cell types or states from thousands of cells. By constructing a network of cell similarities, Leiden algorithm can cluster similar cells together to form distinct groups, which typically correspond to various biological functions or cell types. Powerful community structure detection: Leiden algorithm ensures the quality of clustering by optimizing a modularity function, which helps reveal complex biological patterns and potential regulatory networks in samples. It is particularly important for understanding the interactions and signal transduction pathways between cells. Applicable to large-scale datasets: with the advancement of single-cell sequencing technology, the size of datasets is increasing. The Leiden algorithm's computational efficiency allows it to handle large-scale datasets while keeping computational costs low. Flexibility and scalability: it is not only applicable to spatial transcriptomic data but can also be extended to other types of bioinformatic data, such as protein interaction networks, metabolic networks, etc. Differential expression To identify genes whose expression is specific to each cluster for each gene and each cluster, whether the in-cluster mean differs from the out-of-cluster mean. t-test: the method used in the find_marker_genes of Stereopy package is based on classical statistical principles to identify differentially expressed genes between groups of cells. Grouping cells: cells are grouped based on a categorical variable, such as cluster labels obtained from the Leiden clustering algorithm. For example, cells in cluster A are compared to cells in cluster B. Expression levels: for each gene, the expression levels are compared between the two groups of cells. Calculating the t-statistic: the t-statistic is calculated using the formula:\\ Degrees of freedom: the degrees of freedom (df) for the test are calculated, often using a formula that takes into account the sample sizes and variances of both groups. A common formula is:\\ P-value calculation: the t-statistic is then compared to the t-distribution with the calculated degrees of freedom to obtain a p-value. This p-value indicates the probability that the observed difference in means could have occurred by chance. Multiple testing correction: given that thousands of genes are tested simultaneously, multiple testing correction methods (such as Benjamini-Hochberg) are applied to control the false discovery rate (FDR). The t-test method in find_marker_genes leverages the principles of hypothesis testing to identify genes that are significantly differentially expressed between predefined groups of cells. This method provides a straightforward and statistically sound approach to uncovering key marker genes that distinguish between cell types or conditions, facilitating deeper insights into the underlying biology of the dataset. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"algorithms/image-processing-algorithms.html":{"url":"algorithms/image-processing-algorithms.html","title":"Image processing algorithms","keywords":"","body":"Image processing algorithmsTissue segmentationCell segmentationCell border expandingReferenceImage processing algorithms *The interpretation of the Algorithm part is only available in EN. Tissue segmentation In SAW, gene expression under tissue is used in downstream analysis. A more accurate tissue segmentation helps to define gene expression under tissue with greater precision. The performance of segmentation is affected by imaging quality (such as clarity), tissue properties (such as discontinuous areas), and the contrast between tissue and the background. The grayscale image (ssDNA/DAPI-based) or G-channel image (H\\&E-based) after Contrast Limited Adaptive Histogram Equalization (CLAHE) is used as input to the BCDU-Net (Bi-directional ConvLSTM U-Net) model [1]. The model classifies each pixel as either being in tissue or not. It also fills holes in large areas, resulting in a binarized tissue mask. If you do not have a microscope image, SAW can still perform tissue segmentation using a feature density map. The algorithm is trained on this type of data. The input feature density map is converted to a grayscale image and subjected to clarity enhancement before being fed into the BCDU-Net model. The remaining image-processing steps are identical to those used in microscope-image-based tissue segmentation. Tissue Segmentation Overview Additionally, holes in the tissue mask from the Immunofluorescence (IF) image won't be filled. IF NameIF image (auto-colored in StereoMap)IF tissue MaskAKAP3TESK2 If the segmentation result does not meet your expectations, you can refer to the tutorial of With manually processed files, to perform a new segmentation. Cell segmentation SAW provides the option of cell-level analysis based on the cell segmentation result. However, the imaging quality and cell distribution can impact the segmentation performance. To address this issue, we utilize various tissue-type images as input for a deep-learning model to enhance the accuracy of segmentation. This process involves using a digital image clarity-enhanced method and a light model framework to produce the cell segmentation result. SAW also offers a GPU computing option to accelerate the segmentation process. The input to the BCDU-Net model is a grayscale image after histogram equalization. The model also incorporates BCDU-Net [1], this architecture is beneficial for spatial understanding, predicting patterns, and capturing image context with high parameter efficiency. Finally, utilize the watershed method to acquire more reasonable cell outlines, eliminate small areas of less than 15 pixels, and generate binarized cell masks. Cell Segmentation Overview Cell segmentation in the tissue edge Cell segmentation in hollows \\ If the segmentation result does not meet your expectations, you can refer to the tutorial of With manually processed files, to perform a new segmentation. Cell border expanding After tissue staining, only the cell nucleus area will be stained. Therefore, the area segmented by cell segmentation typically corresponds to the nucleus area. It is important to note that the background area outside the segmented cells may also be considered part of the cell. At the same time, there is also the issue of gene diffusion, which leads to a limited number of genes in the nucleus, hindering downstream analysis. Therefore, EDM (Euclidean Distance Map) correction technology is used to expand the boundary of the cell nucleus and simulate a complete cell as much as possible, thereby increasing the number of genes. Cell border correcting (pink) in the tissue edge Cell border correcting (pink) in hollows The EDM correction algorithm is designed to enhance the cell nucleus's boundary and simulate a complete cell as closely as possible, thereby increasing the number of genes. To achieve this, the input cell segmentation image is converted into an EDM image. The EDM image is composed of the distance from the background pixel outside the cell to the nearest cell. The algorithm calculates the distance from each point in the background to the nearest cell. Based on the threshold (default value is 10, but adjustable), the area within this threshold from the nearest cell is assigned to the cell. In other words, each cell expands its range within the threshold. Within this threshold, any data point that is closest to a cell is assigned to that cell. In other words, each cell extends its range within the threshold. Cell border expanding is automatically performed based on the cell segmentation result, during SAW count and SAW realign. If you are satisfied with your cell segmentation image, --adjusted--distance in SAW realign will be helpful to skip this step. Reference R. Azad, M. Asadi-Aghbolaghi, M. Fathy and S. Escalera, \"Bi-Directional ConvLSTM U-Net with Densley Connected Convolutions,\" 2019 IEEE/CVF International Conference on Computer Vision Workshop (ICCVW), Seoul, Korea (South), 2019, pp. 406-415, doi: 10.1109/ICCVW.2019.00052. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"gao-ji-she-zhi/":{"url":"gao-ji-she-zhi/","title":"高级设置","keywords":"","body":"高级设置高级设置 Run SAW count with GPUHow to start SAW count run with GPU resources in your environmentExpression Matrix FormatLearn about the file formats of the Stereo-seq matrix Image Processing RecordsLearn about the file formats related to image processing *The interpretation of the Advanced part is only available in EN. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"gao-ji-she-zhi/analysis-with-gpu.html":{"url":"gao-ji-she-zhi/analysis-with-gpu.html","title":"Analysis with GPU","keywords":"","body":"Analysis with GPUDriver installationCheck GPU resourcesStart with GPUAnalysis with GPU *The interpretation of the Advanced part is only available in EN. SAW software now supports utilizing GPU resources for running analysis. The cell segmentation step in the SAW count pipeline is a time-consuming process. If the GPU is enabled for calculations, the task's running time will be greatly shortened. Here we take the NVIDIA graphics card as an example to explain how to call GPU to start SAW count run. Driver installation SAW pipelines are run on Linux for analysis. After your Linux server is connected to one or more NVIDIA graphics cards, ensure that the appropriate driver has been installed. If not, follow the NVIDIA CUDA Installation Guide for Linux to install CUDA. Check GPU resources After installing CUDA, check GPU resources in your environment as: $ nvidia-smi Tue Jun 4 05:20:12 2024 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 515.65.01 Driver Version: 515.65.01 CUDA Version: 11.7 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | | | | MIG M. | |===============================+======================+======================| | 0 Tesla T4 Off | 00000000:17:00.0 Off | 0 | | N/A 28C P8 16W / 70W | 4MiB / 15360MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 1 Tesla T4 Off | 00000000:65:00.0 Off | 0 | | N/A 34C P0 26W / 70W | 1259MiB / 15360MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 2 Tesla T4 Off | 00000000:CA:00.0 Off | 0 | | N/A 36C P0 28W / 70W | 641MiB / 15360MiB | 0% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ | 3 Tesla T4 Off | 00000000:E3:00.0 Off | 0 | | N/A 65C P0 66W / 70W | 14439MiB / 15360MiB | 99% Default | | | | N/A | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: | | GPU GI CI PID Type Process name GPU Memory | | ID ID Usage | |=============================================================================| | 1 N/A N/A 83410 C .../envs/cellbin2/bin/python 1255MiB | | 2 N/A N/A 84598 C .../envs/cellbin2/bin/python 637MiB | | 3 N/A N/A 15814 C python 14435MiB | +-----------------------------------------------------------------------------+ In the first table NVIDIA-SMI, you can intuitively find that there are 4 GPU graphics cards and the serial number of each one, its corresponding fan speed, card name, and performance status. The remaining detailed parameters involve GPU usage, video memory usage, etc., which will not be introduced in detail here. The second table, Processes, displays the video memory usage, process number, and GPU occupied by each process. Start with GPU --gpu-id is configured to detect a GPU graphics card. Based on the GPU resource distribution in your cluster environment, choose an appropriate serial number for --gpu-id. If no one is detected, SAW count will not start the run, instead of using the CPU. Run the analysis as: cd /saw/runs saw count \\ --id=Demo_Mouse_Brain_with_GPU \\ --sn=C04144D5\\ --omics=transcriptomics \\ --kit-version=\"Stereo-seq N FFPE V1.0\" \\ --sequencing-type=\"PE75_25+59\" \\ --chip-mask=/saw/datasets/chip_mask/C04144D5.barcodeToPos.h5 \\ --fastqs=/saw/datasets/fastqs \\ --reference=/saw/datasets/reference/mouse_transcriptome \\ --image-tar=/saw/datasets/image/C04144D5_SC_20240620_153.tar.gz \\ --gpu-id=0 SAW realign does not support computing using GPUs currently. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"gao-ji-she-zhi/expression-matrix-format.html":{"url":"gao-ji-she-zhi/expression-matrix-format.html","title":"Expression matrix format","keywords":"","body":"Expression matrix formatGene Expression File (GEF)Bin GEFCell Bin GEFGene Expression Matrix (GEM)Expression matrix format *The interpretation of the Advanced part is only available in EN. Gene Expression File (GEF) Gene expression file (GEF) is a data management and storage format designed to support multidimensional datasets and high computational efficiency. Stereo-seq analysis workflow generates bin GEF and cellbin GEF files. Bin GEF file format is a hierarchically structured data model that stores one or bin combined gene expression matrices in various bin sizes. Cellbin GEF file format stores expression information within each cell. Each GEF container organizes a collection of spatial gene expression matrices. It includes two primary data objects: Group and Dataset. A dataset is a multidimensional array of data elements. Group object is analogous to a file system directory that organizes datasets and other groups in hierarchies. Bin GEF The first level of GEF includes four group objects: \"geneExp\" (required), \"wholeExp\" (optional), \"wholeExpExon\" (optional), and \"stat\" (optional). Group \"geneExp\" contains groups of gene spatial expression data in one or multiple bin sizes. Group \"wholeExp\" contains datasets that record expression level and gene type count of each coordinate in one or multiple bin sizes. Group \"wholeExpExon\" contains datasets that record the exon level of each coordinate in one or multiple bin sizes. Group \"stat\" saves gene names, total MID count and spatial pattern enrichment score of each gene. \"Attributes\" of the file record the version of GEF format, software version, and omics information. \"Attribute\" in each dataset records the key metrics of that dataset. Check the table to get details. Attributes File Attributes DataType Example Description version uint32 2 Gene expression file format version. geftool_ver uint32[3] 0,7,11 Geftool version. It can be used as an individual tool to manipulate GEF files. omics S32 b'Transcriptomics' Omics name. gef_area float32 4.4410855E10 Tissue or labeled tissue area in square nanometers. bin_type S32 b'bin' Bin type of the GEF file. sn S32 b'SS200000135TL_D1' Stereo-seq chip SN /geneExp/binN/expression:Dataset \"expression\" is a 1D array which stores coordinates and MID counts of each gene in the bin size of N, aggregated by gene name. Dataset Attributes DataType Example (bin1) Description minX int32 59820 Minimum x coordinate in bin N. minY int32 102086 Minimum y coordinate in bin N. maxX int32 73040 Maximum x coordinate in bin N. maxY int32 120539 Maximum y coordinate in bin N. maxExp uint32 28 Maximum MID count in a spot when the bin size is N. Data type for \"maxExp\" is dynamically changed for each sample. resolution uint32 500 Physical pitch (nm) between neighbor spots. Dataset DataType:compound DataType Example (bin1) Description x int32 71032 x coordinate in bin N. y int32 103180 y coordinate in bin N. count uint8/uint16/uint32 1 MID count at (x, y) when bin size is N. Data type for \"count\" is consistent with \"maxExp\" in the \"Attributes.\" [optional] /geneExp/binN/exon:Dataset \"exon\" is a 1D array which stores exon expression of each gene in the bin size of N, aggregated by gene name. Dataset Attributes DataType Example (bin1) Description maxExon int32 21 Max exon expression in binN. Dataset DataType:1D array DataType Example (bin1) Description count uint8/uint16/uint32 0 Exon expression in binN at coordinate (x,y), the index is same to the index in the \"expression\" dataset. Data type for \"count\" is dynamically changed for each sample. /geneExp/binN/gene:Dataset \"gene\" is a 1D array which stores the gene names, the starting row indexes in dataset \"expression\", and row counts. Dataset DataType:compound DataType Example (bin1) Description geneID S64 b'ENSMUSG00000000001' Gene ID. geneName S64 b'Gm16045' Gene name. offset uint32 21 The starting row index in dataset \"expression\" for the gene.In this example, the gene expression data for gene \"Gm16045\" starts from row 21 in the dataset \"expression.\" count uint32 2 Row count.In this example, expression data for gene \"Gm16045\" is recorded in row 21 and 22 (2 rows) in the dataset \"expression.\" [optional] /wholeExp/binN:Dataset \"binN\" is a 2D array (matrix) which stores the MID count and gene type count at each spot. Dataset Attributes DataType Example (bin1) Description number uint64 22879557 Number of non-zero spots in the dense matrix. minX int32 59820 Minimum x coordinate in bin N. lenX int32 13221 Length of x. minY int32 102086 Minimum y coordinate in bin N. lenY int32 18454 Length of y. maxMID uint32 2155 Maximum MID count in a spot. maxGene uint32 846 Maximum gene type count in a spot. resolution uint32 500 Pitch (nm) between neighbor spots. Dataset DataType: 2D array (XⅹY), compound DataType Example (bin1) Description MIDcount uint8/uint16/uint32 1 MID count in the spot. The spot coordinate can be identified from the row and column index of the 2D matrix plus the \"minX\" and \"minY\" specified in the attributes. Data type for \"MIDcount\" is dynamically changed for each sample. genecount uint16 1 Gene count in the spot. The spot coordinate can be identified from \"Attributes\" and the indexes of the 2D array. [optional] /wholeExpExon/binN:Dataset \"binN\" in \"/wholeExpExon/\" Group is a 2D array (matrix) which stores the exon expression count at each spot. Dataset Attributes DataType Example (bin1) Description maxExon uint32 21 Maximum exon expression count in a spot when the bin size is N. Dataset DataType: 2D array DataType Example (bin1) Description MIDcount uint8/uint16/uint32 0 MID count in the spot. The spot coordinate can be identified from the row and column index of the 2D matrix plus the \"minX\" and \"minY\" specified in the attributes. Data type for \"MIDcount\" is dynamically changed for each sample. [optional] /stat/gene:Dataset \"gene\" is a 1D array which stores the MID count and spatial pattern enrichment score (E10) of each gene. The array is order by the MID count in descending order. Dataset Attributes DataType Example Description maxE10 float32 65.53 Maximum E10 score. minE10 float32 0. Minimum E10 score. cutoff float32 0.1 Threshold for filtering spots that will be used for computing E10.In this example, 0.1 means that the spots whose MID count is in the top 10% are used for calculating the spatial enrichment score. Dataset DataType:compound DataType Example Description geneID S64 b'ENSMUSG00000000001' Gene ID. geneName S64 b'Ptgds' Gene name. MIDcount uint32 229502 MID count for the gene. E10 float32 65.53 The spatial pattern enrichment score (E10) for the gene. Cell Bin GEF The first layer of Cell Bin GEF contains one required group \"cellBin\" and multiple optional datasets. The second layer \"codedCellBlock\" is optional, which stores precomputed data used in the rendering of StereoMap. \"Attributes\" of the file record the version of GEF format, software version, and omics information. \"Attribute\" in each dataset records the key metrics of that dataset. Check the table to get more details. Attributes File Attributes DataType Example Description geftool_ver uint32[3] 0,7,11 geftool version. It can be used as an individual tool to manipulate GEF files. offsetX int32 0 Minimum x coordinate in bin 1. offsetY int32 0 Minimum y coordinate in bin 1. omics S32 b‘Transcriptomcis’ Omics name. resolution uint32 500 Pitch (nm) between neighbor spots. version uint32 2 Gene expression file format version. bin_type S32 CellBin Bin type of the GEF file. sn S32 b'SS200000135TL_D1' Stereo-seq chip SN /cellBin/cell:Dataset \"cell\" is a 1D array which stores basic information and indices information of cells and expression. Dataset Attributes DataType Example Description averageArea float32 494.666 Average area for cells in pixel. averageDnbCount float32 194.299 Average number of mRNA-captured DNBs in a cell. averageExpCount float32 541.715 Average MID count in cell. averageGeneCount float32 310.157 Average gene count in cell. maxArea uint16 1925 Maximum area for cells in pixel. maxDnbCount uint16 883 Maximum number of mRNA-captured DNBs in a cell. maxExpCount uint16 3018 Maximum MID count in cell. maxGeneCount uint16 1415 Maximum gene count in cell. maxX int32 17658 Maximum x coordinate of the cell’s center of mass. maxY int32 19422 Maximum y coordinate of the cell’s center of mass. medianArea float32 474. Median area for cells in pixel. medianDnbCount float32 183. Median number of mRNA-captured DNBs in a cell. medianExpCount float32 491. Median MID count in cell. medianGeneCount float32 289. Median gene count in cell. minArea uint16 2 Minimum area for cells in pixel. minDnbCount uint16 0 Minimum number of mRNA-captured DNBs in a cell. minExpCount uint16 0 Minimum MID count in cell. minGeneCount uint16 0 Minimum gene count in cell. minX int32 2933 Minimum x coordinate of the cell’s center of mass. minY int32 5568 Minimum y coordinate of the cell’s center of mass. Dataset DataType:compound DataType Example Description id uint32 10 Cell ID index, the start ID is 0.In the Example, 10 represents the 10th cell in the dataset. x int32 541 The x coordinate of the cell’s center of mass.In the Example, the x coordinate of the 10th cell’s center of mass is 541. y int32 190 The y coordinate of the cell’s center of mass.In the Example, the x coordinate of the 10th cell’s center of mass is 190. offset uint32 494 The start row index of the cell in the \"/cellBin/cellExp\" dataset.The example represents that the gene ID index and total MID count information of the 10th cell in the \"/cellBin/cellExp\" dataset start from the 494th row. geneCount uint16 100 Gene count in the cell.In the example, 100 represents that the 100 rows in the \"/cellBin/cellExp\", start from the 494th to the 593th row, contains the gene ID indices and total MID count of the gene for the 10th cell in \"/cellBin/cell\" dataset. expCount uint16 500 Cell MID count. dnbCount uint16 200 mRNA-captured DNBs of the cell. area uint16 474 Cell area in pixel. cellTypeID uint32 0 Cell type ID. clusterID uint32 20 Cell cluster ID. /cellBin/cellBorder:Dataset \"cellBorder\" is a 3D array which stores the lists of points for the bounding polygons of the cell. Dataset Attributes DataType Example Description maxX int32 16127 Maximum x coordinate of the bounding box of the cell. maxY int32 16663 Maximum y coordinate of the bounding box of the cell. minX int32 11129 Minimum x coordinate of the bounding box of the cell. minY int32 12784 Minimum y coordinate of the bounding box of the cell. Dataset DataType:3D array DataType Example Description 32*(int16,int16) [[-17,-11],[-15,-5]…[32767,32767]] A list of 32 coordinates recording the differences between cell bounding points and the cell’s center of mass (0,0). The real coordinate of cell’s center of mass (x, y) can be obtained from \"cell\" dataset using cellID. /cellBin/cellExp:Dataset \"cellExp\" is a 1D array which stores the expression information of each cell. Dataset Attributes DataType Example Description maxCount uint16 336 Maximum MID count of a gene in a cell. Dataset DataType:compound DataType Example Description geneID uint32 1610 Gene IDs of the genes detected in the cell. ID is the index of \"gene\" dataset.In the example, 1610 represents the 1610th item in the \"gene\" dataset, and the name of the gene can be acquired in \"gene\" dataset. count uint16 3 MID count for the gene.In the example, (assume this is the 0th item in the \"cellExp\" dataset, from the \"offset\" and \"geneCount\" record in the \"cell\" dataset we can know that the 0th item in the \"cellExp\" belongs to the cell whose cellID=0) the MID count for the gene (geneID=1610) in the cell (cellID=0) is 3. [optional] /cellBin/cellExon:Dataset \"cellExon\" is a 1D array which stores the exon information for each cell. Dataset Attributes DataType Example Description maxExon uint16 5793 Maximum exon count of a gene in all cells. minExon uint16 0 Minimum exon count of a gene in all cells. Dataset DataType:1D array DataType Example Description uint16 16 Exon count in a cell, the index of the array is same to the cellID in the \"cell\" dataset. [optional] /cellBin/cellExpExon:Dataset \"cellExpExon\" is a 1D array which stores exon expression information for each cell. Dataset Attributes DataType Example Description maxExon uint16 336 Maximum exon count of a gene in a cell. Dataset DataType:1D array DataType Example Description uint16 3 Exon count (MID) for the gene. The index is same to the \"cellExp\" dataset.In the example, (assume this is the 0th item in the \"cellExpExon\" dataset, since the index is same to \"cellExp\" dataset, from the \"offset\" and \"geneCount\" record in the \"cell\" dataset we can know that the 0th item in the \"cellExpExon\" belongs to the cell whose cellID=0) the exon count (MID) for the gene (geneID=1610) in the cell (cellID=0) is 3. /cellBin/cellTypeList:Dataset \"cellTypeList\" is a 1D array which stores cell types of each cell. Dataset DataType:1D array DataType Example Description S32 b'default' Cell type, \"default\" stands for undefined cell type. /cellBin/gene:Dataset \"gene\" is a 1D array which stores the indices of cell and expression information of each gene. Dataset Attributes DataType Example Description maxCellCount uint32 5718 Maximum number of cells a gene can be detected. maxExpCount uint32 55361 Maximum MID count of a gene. minCellCount uint32 1 Minimum number of cells a gene can be detected. minExpCount uint32 1 Minimum MID count of a gene. Dataset DataType:compound DataType Example Description geneID S32 b'ENSMUSG00000000001' Gene ID. geneName S32 b'AC149090.1' Gene name. offset uint32 0 The start row index of the gene in \"/cellBin/geneExp\" dataset.In the example, 0 means that start from the 0th item in \"/cellBin/geneExp\" dataset records the cellIDs and total MID count information of \"AC149090.1\". cellcount uint32 60 Number of cells a gene can be detected.In the example, 60 represents that start from the 0th item to the 59th item records the information of gene \"AC149090.1\". expCount uint32 100 Sum of MID count for the gene.In the example, the total MID count of \"AC149090.1\" is 100. maxMIDcount uint16 4 Maximum MID count of a gene in a cell.In this case, the maximum MID count of gene \"AC149090.1\" in a cell is 4. /cellBin/geneExp:Dataset \"geneExp\" is a 1D array which stores cell and expression information of each gene. Dataset Attributes DataType Example Description maxCount uint16 10 Maximum MID count of a gene. Dataset DataType:compound DataType Example Description cellID uint32 1247 cellID that contains the gene whose index is same to the index in \"gene\" dataset.In the example, (assume we use the 0th item in \"geneExp\" dataset) 1247 shows that the gene \"AC149090.1\" appears in the cell whose cellID is 1247. count uint16 3 The MID count of the gene, whose index is same to the index in \"gene\" dataset, in the cellID.In the example, the MID count of gene \"AC149090.1\" in the cell (cellID=1247) is 3. [optional] /cellBin/geneExon:Dataset \"geneExon\" is a 1D array which stores the exon expression information of each gene. Dataset Attributes DataType Example Description maxExon uint32 55361 Maximum exon count of a gene. minExon uint32 0 Minimum exon count of a gene. Dataset DataType:1D array DataType Example Description uint32 97 Total exon count of a gene, the index of \"geneExon\" dataset is same to the \"gene\" dataset.In the example, (assume this is the 0th item in the \"geneExon\" dataset, and gene \"AC149090.1\" is the 0th item in the \"gene\" dataset) the exon count of gene \"AC149090.1\" is 97. [optional] /cellBin/geneExpExon:Dataset \"geneExpExon\" is a 1D array which stores the exon expression information in cells of each gene. Dataset Attributes DataType Example Description maxExon uint16 336 Maximum exon expression of a gene in a cell. Dataset DataType:1D array DataType Example Description uint16 3 Exon count of a gene in a cell. The index of \"geneExpExon\" dataset is same to the \"geneExp\" dataset.In the example, (assume this is the 0th item in the \"geneExpExon\" dataset, since the index is same to \"geneExp\" dataset, from the \"offset\" and \"cellCount\" record in the \"gene\" dataset we can know that the 0th item in the \"geneExpExon\" dataset belongs to the gene \"AC149090.1\") 3 stands for the exon count of gene \"AC149090.1\" in cell 1247 is 3. /cellBin/bockIndex:Dataset \"bockIndex\" is a 1D array which stores the matrix block partition information. Dataset DataType:1D array DataType Example Description uint32 0 Cell count in each partition block.cnt=blockIndex[i+1]-blockIndex[i] /cellBin/bockSize:Dataset \"bockSize\" is a 1D array which stores the block size of partition. Dataset DataType:1D array DataType Example Description uint32 256, 256, 104, 104 4-element array. The 4 items represent the block length in x-axis, block length in y-axis, block count in x-axis, and block count in y-axis, respectively. [optional] /codedCellBlock:Group \"codedCellBlock\" stores pre-computed data for rendering in StereoMap. Group Attributes DataType Example Description info string {\"@type\": \"neuroglancer_annotations_v1\", ...} Metadata of encoded precomputed data in JSON. [optional] /codedCellBlock/L0/0_1:Dataset \"0_1\" is an example chunk encoded pre-computed data, including id, geometry, and so on. Dataset DataType:Bytes DataType Example Description H5T_OPAQUE 1F 8B 08 00 ... Bytecode of the chunk. Gene Expression Matrix (GEM) Gene expression matrix (GEM) stores gene spatial expression data. SAW generates multiple gene expression matrix files in the workflow, the basic format requires six columns with a header row that shows the column names. The six columns are gene ID, gene name, x coordinate, y coordinate, MID count and exon count. When it comes to cellbin GEM, the seventh column is for cell ID. The header of the expression matrix for the maximum area enclosing rectangle region has several annotation rows starting with \"#\" before the column rows. The header field names and field types are described in the table. Fields Data Type Example Description #FileFormat string GEMv0.2 Gene expression matrix file format version. #SortedBy string None Gene expression matrix sorting strategy. Valid values: \"geneID\", \"x\", \"y\", \"MIDCount\", \"None\". #BinType string Bin Bin type of the GEM file. #BinSize string 1 (Please check 1.3 Terminologies and Concepts Bin) #Omics string Transcriptomics Omics name. #Stereo-seqChip string SS200000135TL_D1 Stereo-seq Chip T serial number. #OffsetX uint32 1 X coordinate of the origin before calibration. #OffsetY uint32 1 Y coordinate of the origin before calibration. geneID string ENSMUSG00000000001 Gene ID geneName string Gnai3 Gene name. x uint32 16809 X coordinate of the spot. y uint32 8546 Y coordinate of the spot. MIDCount uint32 1 Number of MIDs at (x, y) for the gene in the corresponding row. ExonCount uint32 0 [Optional] Number of exon count at (x, y) for the gene in the corresponding row. CellID uint32 55892 [Optional] CellID for (x, y). An example of bin GEM: #FileFormat=GEMv0.2 #SortedBy=None #BinType=Bin #BinSize=1 #Omics=Transcriptomics #Stereo-seqChip=B03523G1 #OffsetX=0 #OffsetY=0 geneID geneName x y MIDCount ExonCount ENSMUSG00000000001 Gnai3 694 17229 1 1 ENSMUSG00000000001 Gnai3 1428 4994 1 1 An example of cellbin GEM: #FileFormat=GEMv0.2 #SortedBy=None #BinType=CellBin #BinSize=Cell #Omics=Transcriptomics #Stereo-seqChip=B03523G1 #OffsetX=0 #OffsetY=0 geneID geneName x y MIDCount ExonCount CellID ENSMUSG00000047454 Gphn 9325 19972 1 0 192276 ENSMUSG00000030616 Sytl2 9314 19976 1 1 192276 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"gao-ji-she-zhi/image-related-record-format.html":{"url":"gao-ji-she-zhi/image-related-record-format.html","title":"Image-related record format","keywords":"","body":"Image-related record formatImage processing record (IPR)Recorded image processing (RPI)Image-related record format *The interpretation of the Advanced part is only available in EN. Image processing record (IPR) Image processing record (IPR) file is designed to record the whole-life information of a microscope image from photo-taking to processing. Each staining image (ssDNA/DAPI, IF, H\\&E) includes six basic groups, \"ImageInfo\", \"QCInfo\", \"Stitch\", \"TissueSeg\", \"CellSeg\", and \"Register\", which are used to store microscopy photo-taking information, image quality control information, image stitching records, tissue segmentation records, cell segmentation records (optional), and registration records. ItemDescriptionAttributeDescriptionIPRVersionIPR file format version.DatesetDescriptionPreviewA 2D matrix merges stitched image, tissue segmentation boundary and cell segmentation boundary.//ImageInfo: Group records basic image information.AttributesDescriptionAppFileVerMicroscope software version.BackgroundBalanceBackground balance.BitDepthThe bit-depth of a camera sensor describes its ability to transform the analog signal coming from the pixel array into a digital signal.BrightnessRelative intensity affecting a person or sensor.ChannelCountNumber of RGB channels.ColorEnhancementWhether enhanced image color display or not.ContrastThe difference in color and intensity of the depicted object from its background.DeviceSNMicroscope device serial number.DistortionCorrectionWhether fixed distortion or not.ExposureTimeExposure time in ms.FOVHeightHeight of an individual FOV in pixel.FOVWidthWidth of an individual FOV in pixel.GainAmplification applied to the signal by the image sensor.GammaThe coefficient links between the human eye and the digital camera.GammaShiftWhether adapt the digital image taken with the help of a linearly recording camera to the nonlinear perception of the human eye or not.IlluminanceIntensity of light.ManufacturerMicroscope manufacturer.ModelMicroscope model.OverlapOverlapping pixels between single tiles.PixelSizeXSize of pixel in x direction.PixelSizeYSize of pixel in y direction.QCResultFilePrefix of ImageQC/ImageStudio result file, the unique identifier of the image.ScanChannelFluorescence channel.ScanColsNumber of columns scanned.ScanObjectiveMagnification power of the scan objective lens.ScanRowsNumber of rows scanned.ScanTimeScan date and time.SharpnessDegree of clarity of the edge(s) of the image.RegisterVersionImage auto-processing & matrix registration software version.StitchedImageWhether the corresponding image is a panorama image (true) or a set of tiled images (false).STOmicsChipSNStereo-seq Chip serial number.WhiteBalanceAn adjustment in electronic and film imaging that corrects the color balance of the lighting.DatasetDataType: 1D arrayDescriptionRGBScaleRGB color.//QCInfo: Group records the QC information of the image.AttributesDescriptionClarityScoreReference score for evaluating the clearness of cell boundaries.ExperimenterEmail of the experimenter who did QC for the image.GoodFOVCountNumber of FOVs that have identified more than 3 track cross points.ImageQCVersionImage QC version.QCPassFlagWhether the corresponding image passed QC.RemarkInfoAny remarks, notes, comments on the image.StainTypeStain type of microscopy image.TotalFOVCountTotal number of FOVs.TrackLineScoreReference score for evaluating whether the detected track lines can be used as references for image stitching and registering with gene expression matrix. (This score only evaluate whether the program detected track lines on the image, it does not infer the clarity of the lines or the images).TrackLineChannelShooting channel of track lines.TrackCrossQCPassFlagWhether the QC of the track-cross point is passed.ScopeStitchQCScoreScore to assess the stability of microscope overlap (DAPI & mIF only).ScopeStitchQCPassFlagWhether the QC of microscope stitch is passed (DAPI & mIF only).TemplateValidAreaProportion of encircled area by the detected points that match the global track line template (within the error range of 5 pixels), to the entire image area.TemplateRecallProportion of detected points, which match the global track line template (within the error range of 5 pixels), to the points derived from the chip track line rules.ClarityCutSizeSize of cut images (based on FOV) for clarity evaluation.ClarityCountsCounts of cut images in different categories.ClarityOverlapOverlap of cut images for clarity evaluation.DatasetDataType: 2D arrayDescriptionScopeStitchQCMatrixMatrix of overlap deviation of each microscope FOV (DAPI & mIF only).CrossPoints/row_col*nGroup of datasets for each FOV that records the track cross point coordinates. (Row and col stand for the FOV row and column index number, and n stands for number of FOVs). Each dataset is a 2D array record, (x, y) coordinates of track cross points in each FOV.//Calibration: Group records the calibration information (_IF only).AttributesDescriptionCalibrationQCPassFlagWhether the calibration QC of IF image is passed.//Calibration/Scope:AttributesDescriptionConfidenceCalibration confidence of microscope-stitched tiled image vs. IF.OffsetXHorizontal offset.OffsetYvertical offset.[optional]//Calibration/Stereo:AttributesDescriptionConfidenceCalibration confidence of Stereo-stitched image vs. IF.OffsetXHorizontal offset.OffsetYVertical offset.//Stitch: Group records the stitching information.AttributesDescriptionStitchingScoreReference score for stitching.TemplateSourceThe reference FOV for deriving the template used for rotating and scaling the microscopic images.WhichStitchStitching method for image, including microscope, template and ripple stitching. The default for stitched image is microscope.DatasetDataType: 2D arrayDescriptionTemplatePointCenter coordinates for deriving template lines.TransformTemplateCoordinates of template points registered with expression matrix.//Stitch/StereoStitch: Group records the image stitching information processed by Stereo program.AttributesDescriptionStitchedGlobalHeightHeight of stitched tiled images using Stereo stitching algorithm. Tiled image only.StitchedGlobalWidthWidth of stitched tiled images using Stereo stitching algorithm. Tiled image only.DatasetDataType: 2D arrayDescriptionStitchedGlobalLocCoordinates for the Stereo stitched tiled image. Tiled image only.//Stitch/ScopeStitch: Group records the image stitching information processed by microscope imaging software.AttributesDescriptionGlobalHeightHeight of panorama image.GlobalWidthWidth of panorama image.DatasetDataType: 2D arrayDescriptionGlobalLocCoordinates for the stitched tiled image (either program stitched or microscope stitched).ScopeJitterDiffJitter offset of microscope stitching.ScopeHorizontalJitterHorizontal jitter offset of microscope stitching. Tiled image only.ScopeVerticalJitterVertical jitter offset of microscope stitching. Tiled image only.//Stitch/StitchEval: Group records the evaluation result of stitching.AttributeDescriptionMaxDeviationMaximum stitching deviation.DatasetDataType: 2D arrayDescriptionGlobalDeviationGlobal stitching deviation matrix. Tiled image only.StitchEvalHStitching deviation matrix for the horizontal axes.StitchEvalVStitching deviation matrix for the vertical axes.//Register: Group records the information that aligns images with gene expression matrix.AttributesDescriptionCounterRot90Count of counter-clockwise rotation of 90 degrees.FlipWhether horizontally flipped or not.MatrixShapeHeight and width of the gene expression matrix.OffsetXOffset between microscope image and gene expression matrix in x-axis.OffsetYOffset between microscope image and gene expression matrix in y-axis.RegisterScoreReference score for registration.RotationRotation degree between raw image and deviation template.ScaleXScale between raw image and deviation template in horizontal direction.ScaleYScale between raw image and deviation template in vertical direction.XStartGene expression matrix offset x (GEF geneExp/binN/expression attribute minX).YStartGene expression matrix offset y (GEF geneExp/binN/expression attribute minY).ManualRotationManual rotation degree of the raw image around the center point.ManualScaleXManual scale of the raw image in horizontal direction based on center point.ManualScaleYManual scale of the raw image in vertical direction based on center point.DatasetDataType: 2D arrayDescriptionMatrixTemplateList of track cross points derived from gene expression matrix.//TissueSeg: Group records the tissue segmentation information.AttributesDescriptionTissueSegScoreReference score for tissue segmentation.TissueSegShapeImage shape for tissue segmentation mask image.ThresholdThe threshold for tissue segmentation in IF images is divided into maximum and minimum values (IF only).DatasetDataType: 2D arrayDescriptionTissueMaskEncoded tissue segmentation mask file (after registration with gene expression matrix).//CellSeg: Group records the cell segmentation information.AttributesDescriptionCellSegShapeImage shape for cell segmentation mask image.DatasetDataType: 2D arrayDescriptionCellMaskEncoded cell segmentation mask file (after registration with gene expression matrix).CellSegTraceCell contour attributes, including height, width and area./StereoResepSwitch: Group stores the state of each module that whether the module needs to be performed.AttributesDescriptionstitchSwitch for performing stitching.tissuesegSwitch for performing tissue segmentation.cellsegSwitch for performing cell segmentation.registerSwitch for performing registration./ManualState: Group stores the state of each module that whether the module has been manually processed.AttributesDescriptionstitchWhether manually stitched the tiled images.tissuesegWhether manually delineated the tissue coverage region.cellsegWhether manually delineated the cell coverage regions.registerWhether manually aligned microscope image and gene expression matrix.calibrationWhether manually calibrated two images. For example, manually match IF image with DAPI image. Recorded image processing (RPI) The image pyramid model is a multi-resolution hierarchical model that is used to store and display images in different resolutions. For the same field of view, the layer of the image pyramid that is closest to the bottom includes the most detailed information and has the largest scale. register pipeline performs the down-sampling step on the registered image, and the result images are layered to construct a pyramid with the suffix \".rpi\". For each resolution layer, the intact registered image is split into 256 pixels x 256 pixels tiles. If the size of a layer is smaller than 256 x 256, the image will then remain intact. The outer layer group of RPI file is defined according to its stain type, generally including ssDNA, DAPI, IF (immunofluorescence image especially for protein, group name as ), and H\\&E. In each group of stain types, multiple image results, including an image subgroup (registered microscopy image), a TissueMask subgroup (registered mask boundary for the tissue coverage area), and a CellMask subgroup (registered mask boundaries for the cell coverage area, optional), could be saved respectively. Schematic diagram of the image pyramid: Image pyramid displaying Item Description Attributes Description imgSize Size of the image. sizex Max of x. sizey Max of y. version RPI file version. x_start Offset x of the matrix. y_start Offset y of the matrix. /\\/\\: Group records the specific layer information, mainly including \"Image\", \"TissueMask\", \"CellMask\" and \"CellMask_adjusted\". Attributes Description MaxGrayLevel Maximum gray value. MinGrayLevel Minimum gray value. GrayLevelElbow Elbow point of gray value. TrackLayer Whether track layer. Color Layer color. Groups Description binN Detailled downsampling metadata for each bin size. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"cuo-wu-ma.html":{"url":"cuo-wu-ma.html","title":"错误码","keywords":"","body":"错误码Error codesAlignment of readsAnnotation of readsImage processingExpression matrixSecondary analysisReport generation错误码 *The interpretation of the Error Code part is only available in EN. Error codes Under the execution directory, a file named errcode.log will record the error information of pipelines if an error causes a program interruption. Offer the errcode.log and pipeline log to the FAS/FBS for help. SAW error codes are designed to capture error information and describe it in a straightforward manner. They are designed to express in three parts, date-time, error code, and explanation. The date-time information could help users distinguish errors in various program executions. An empty errcode.log file will be generated if the pipeline runs successfully. According to the workflow, error codes for each step are listed below. Alignment of reads Error codeError typeInterpretationSAW-A00001Parameters invalid or missingPlease check your input parameters. Some required parameters might be missed.SAW-A00002File open failedPlease check the input file exists and has the correct access permission.SAW-A00003File parse failedPlease check your input file is in the correct file format. e.g. \"only support .bin or .h5 file.\"SAW-A00004Other IO API errorPlease check your output directory path is an existing path.e.g. \"cannot write to file, /path/to/file\"SAW-A00021Parameters invalid or missingPlease check your input parameters. Some required parameters might be missed.SAW-A00022File open failedPlease check the input file exists and has the correct access permission.e.g. \"cannot open such file, /path/to/file\"SAW-A00023Failed to parser the filePlease check your input file is in the correct file format.SAW-A00024Other API errorPlease contact FAS/FBS for help.SAW-A00025Software exceptionPlease contact FAS/FBS for help.SAW-A10100Parameters invalid or missingThere is something wrong with the input FASTQs or --kit-version or --sequencing-type .SAW-A10101File open failedPlease check the file permission and file format.e.g. \"barcodePositionMapFile does not exist: /path/to/mask\" means to check whether the mask file exists and has the correct access permission.SAW-A10102File parse failedPlease check the completeness of the reads in FASTQs. This issue may arise if the FASTQs are in incorrect format or the file was incompletely written or transferred.e.g. \"sequence and quality have different length\"SAW-A10103Invalid data or data exceptionPlease check the file format and content.SAW-A10104File deletion failedPlease check whether the program has finished according to the *.Log.progress.out or *.run.log file.This error arose if \"_STARtmp\" directory failed to be deleted. SAW-A10105File IO failedPlease contact FAS/FBS for help.SAW-A10106Failure on APIs of system and librariesPlease contact FAS/FBS for help.SAW-A10107Software assertPlease contact FAS/FBS for help.SAW-A10108Software exceptionPlease contact FAS/FBS for help.SAW-A10109Allocate memory errorThis error occurs when you run out of RAM. You may need to kill some jobs that use the same RAM or upgrade your hardware to get more RAM resources for your job.SAW-A10110Out of disk spaceThis error occurs when you store too many files on your hard disk. Please remove some files to free disk space.SAW-A10200Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A10201CID comparison rate is too lowThis error usually arises because the CID information of the input FASTQs is not the same as the CID in the input mask file. Please use the correct SN-FASTQ pairs for SAW count.SAW-A10202Fail to create the index for the BAM filePlease contact FAS/FBS for help.SAW-A10300Fail to load indexed referencePlease check the existence, access permission, and completeness for the indexed reference.SAW-A30001Arguments num errorPlease check your input parameters. Some required parameters might be missed.SAW-A30002File open failedPlease check the input file exists and has the correct access permission.SAW-A30003File parse failedPlease check your mask file is in the correct file format. Only support .h5 or .bin mask file.SAW-A30004Allocate memory errorPlease check whether the range of the coordinates is too large, or you have run out of RAM. You may need to kill some jobs that use the same RAM or upgrade your hardware to get more RAM resources for your job.SAW-A30005Fail to open input fileFail to open input .txt file. Please check the file that exists and have the correct access permission.SAW-A30007Run out of memoryPlease make you have preset enough memory resources for the task to run. Annotation of reads Error codeError typeInterpretationSAW-A20001Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A20002File open failedPlease check the input file that exists and has the correct access permission.SAW-A20003File parse failedPlease check your input BAM header is in the correct file format.SAW-A20004Allocate memory errorThis error occurs when you run out of RAM. You may need to kill some jobs that use the same RAM or upgrade your hardware to get more RAM resources for your job.SAW-A20005File parse failedPlease check gene names in your input GTF/GFF file.e.g. \"Found gene names with their length exceeding 64 characters\"SAW-A20101Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A20102File open failedPlease check the file that exists and has the correct access permission.SAW-A20103File parse failedPlease check your input file has a valid column number.SAW-A20105File parse failedPlease check gene names in your input GTF/GFF file.e.g. \"Found gene names with their length exceeding 64 characters\"SAW-A20106Wrong file formatPlease check whether input file is in GTF/GFF format, suffixed with ( .gff/.gff.gz, .gff3/.gff3.gz, .gtf/.gft.gz）SAW-A20107Abnormal file contentA gene ID matches multiple corresponding locations.SAW-A20108Abnormal file contentDuplicate gene IDs appear in the same location on the same chromosome. Image processing Error codeError typeInterpretationSAW-A40001Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A40002File open failedPlease check the input file that exists and has the correct access permission. SAW-A40003File parse failedPlease check your input file is in the correct file format. SAW-A40004Invalid data or data exceptionPlease check the file content. SAW-A40401Parameter missingPlease check your SAW convert merge input parameters. Some required parameters might be missed.SAW-A40402File open failedPlease check the SAW convert merge input file that exists and has the correct access permission.SAW-A40405Invalid inputSAW convert merge inputs of less than two images or more than three images.SAW-A40406File pairing failedPlease check the SAW convert merge input TIFF sizes are the same. Since the merge function is used for evaluating segmentation results, the input images are supposed to be the same in size and position (tissue position in the whole image).SAW-A40501Parameter missingPlease check your SAW convert overlay input parameters. Some required parameters might be missed.SAW-A40502File open failedPlease check the SAW convert overlay input file that exists and has the correct access permission.SAW-A40504Invalid data or data exceptionError data. Please check the file content. This error may arise because the IPR file in the image .tar.gz does not contain 'Stitch/TransformTemplate' or 'Register/MatrixTemplate information'.SAW-A40601Parameter missingPlease check the SAW convert img2rpi input parameters. Some required parameters might be missed.SAW-A40602File open failedPlease check the SAW convert img2rpi input file that exists and has the correct access permission.SAW-A40605Invalid input--image and --layers of SAW convert img2rpi are not in the same length. They are supposed to be paired.SAW-A40701Parameter missingPlease check the SAW convert img2rpi input parameters. Some required parameters might be missed.SAW-A40702File open failedPlease check the SAW convert img2rpi input file that exists and has the correct access permission.SAW-A40703File parse failedPlease check the input .tar.gz file from StereoMap.SAW-A40704Invalid data or data exceptionPlease check the SAW convert img2rpi input .tar.gz file. This error may arise because the CZI file in .tar.gz is invalid, or the image has not been either automatically or manually registered with the expression matrix. SAW-A40706File pairing failedPlease check the shape of the registered tissue segmentation images. Or please contact FAS/FBS for help.SAW-A40801Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A40802File open failedPlease check the file that exists and has the correct access permission.SAW-A40803File parse failedPlease check your input file is in the correct file format.SAW-A40804Invalid data or data exceptionPlease check the file content. This error may arise because the input file is empty. The second possible reason is that the gene expression matrix information in the Register module (MatrixShape, Xstart, Ystart) does not match with the input GEF file (minX, minY, maxX, maxY), because the manual registration has to be processed on the identical matrix.SAW-A13001GEF parse failedPlease check the path or file format of GEF.SAW-A13002TIFF parse failedPlease check the path or size of TIFF image.SAW-A13003Fail to create outputPlease check the access permission to write files or whether the output directory exists.SAW-A13004Invalid adjusting distancePlease check whether the adjusting distance is in a proper and reasonable range. Expression matrix Error codeError typeInterpretationSAW-A50001Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A50002File open failedPlease check the file that exists and has the correct access permission.SAW-A50003File parse failedPlease check your input file is in the correct file format.SAW-A50004Fail to create output fileFail to create output file. Please check your writing permission of the output directory.SAW-A50005Fail to write TIFFFail to write a TIFF file.SAW-A50006h5AttrWrite errorPlease check the HDF5 file attributes.SAW-A50007h5DatasetWrite errorPlease check the HDF5 file dataset.SAW-A50008Fail to create TIFFPlease check the access permission to write a TIFF image.SAW-A50009Different sizes between TIFF and GEFPlease check the sizes of the TIFF image and GEF respectively. Make sure they are the same size.SAW-A50010Allocate memory errorThis error occurs when you run out of RAM. You may need to kill some jobs that use the same RAM or upgrade your hardware to get more RAM resources for your job.SAW-A60001Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A60002File open failedPlease check the file that exists and has the correct access permission.SAW-A60003File parse failedThe file does not contain correct information. Please check the file format.SAW-A60110Program version errorPlease check your output GEF version. Your input GEF version might be too old.SAW-A60111Call process errorThis error arose because the invocation flow order was messed up. Please modify your invocation flow as prompted.e.g. \"Please call freeRestriction first, or call restrictRegion function before restrictGene.\"SAW-A60120Invalid data or data exceptionError data. Please check the file content.SAW-A60121File information missingFailed to read the file. Please check whether the file is damaged.SAW-A60122File pairing failedPlease check the TIFF mask size is consistent with the size of expression matrix. Since the mask has been registered with the expression matrix, their sizes are supposed to be the same.SAW-A60130Fail to create output fileFail to create output H5 file. Please check your writing permission of the output directory or contact FAS/FBS for help.SAW-A60140Allocate memory errorThis error occurs when you run out of RAM. You may need to kill some jobs that use the same RAM or upgrade your hardware to get more RAM resources for your job.SAW-A60150Abnormal file contentDimensions of gene expression matrix did not match. Please contact FAS/FBS for help.SAW-A00031Parameters invalid or missingPlease check your input parameters. Some required parameters might be missed.SAW-A00032File open failedPlease check the file that exists and has the correct access permission.SAW-A00033File open failedPlease check the file format. Secondary analysis Error codeError typeInterpretationSAW-A70001Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A70002File open failedPlease check the file that exists and has the correct access permission.e.g. “cannot access /path/to/file: No such file or directory.”SAW-A70005Value errorPlease reset the bin size as prompted.e.g. \"Gene number less than 3000, please check your gef file\"Please check the content of your GEF file, and make sure there are at least 3000 genes for clustering.SAW-A70101Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A70102File open failedPlease check the file that exists and has the correct access permission.e.g. “cannot access /path/to/file: No such file or directory.”SAW-A70105Value errorPlease reset the bin size as prompted.e.g. \"Gene number less than 3000, please check your gef file\"Please check the content of your GEF file, and make sure there are at least 3000 genes for clustering. Report generation Error codeError typeInterpretationSAW-A80001Parameter missingPlease check your input parameters. Some required parameters might be missed.SAW-A80002File open failedPlease check the file that exists and has the correct access permission.SAW-A80003Abnormal file contentPlease check the content of input tissue GEF file.SAW-A80004Abnormal file contentThere is no data left after filter by coordinates.SAW-A80005Abnormal file contentTotal map reads is 0, please check the input statistic file.SAW-A80006Abnormal file contentMapped reads are less than annotated reads.SAW-A80007Environment errorPlotting error because of absence of python3.SAW-A80008Programming error Fail to generate saturation file. Please contact FAS/FBS for help.SAW-A90001Parameter missingPlease check your input parameter as prompted. Some required parameters might be missed.SAW-A90002File open failedPlease check the file that exists and has the correct access permission.e.g. \"cannot access *: No such file or directory.\"SAW-A90003File parse failedJSON file format error. This error may arise because the input statistics files were not generated in the same SAW version. Or contact FAS/FBS for help.SAW-A90004Invalid data or data exceptionPlease check the file content. Fail to find the information of bin size or stain type in RPI file.SAW-A90005Fail to create output fileFail to create output file. Please check your writing permission of the output directory. Access to help Have any questions or concerns about the error codes fromyour SAW run? Please get in touch with the local agents or FAS/FBS. Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"release-notes.html":{"url":"release-notes.html","title":"版本说明","keywords":"","body":"版本说明SAW发版记录8.0.1 （7月8日, 2024）8.0.0 （6月29日, 2024）历史版本版本说明 SAW发版记录 8.0.1 （7月8日, 2024） 问题修复： 修复软件部分已知BUG和问题。 8.0.0 （6月29日, 2024） 新形态： SAW本次更新以单体可执行程序.tar.gz 文件的形式发布，可以直接在系统上解压，无需额外配置计算环境。由于它已经集成并预编译所有内置软件所需的依赖项，因此可以在大多数Linux环境直接运行。 新功能： 整合并简化流程使命令编写和完成分析变得更加便捷。这些流程模块包括： SAW count：核心流程模块，用于根据计算基因表达读数和 Stereo-seq 芯片生成表达矩阵。 SAW makeRef：根据参考基因组数据构建索引文件。 SAW checkGTF：检查注释文件的格式。 SAW realign：使用手动处理的文件重新启动分析。 SAW reanalyze：重新执行下游分析。 SAW convert：支持文件格式转换。 SAW 支持从 FFPE（formalin-fixed paraffin-embedded）样本中获取基因表达信息。在运行 SAW count 时，通过将 --kit-version 设置为 \"Stereo-seq N FFPE Kit V1.0\" 来实现。对于 FFPE 分析，需要使用 SAW v8.0.0 或更高版本。 基于 FFPE 组织样本，可以在运行 SAW count 时通过使用 --microorganism-detect 参数来开启微生物分析，需要准备必要的参考数据集。更多信息请参阅参考基因组准备。 SAW 还升级了读取比对和注释的生物信息学工作流程，以适应 FFPE 数据集。 在注释过程中，默认情况下会同时使用唯一比对 reads 和 多比对 reads 中的最优比对进行基因定量分析。如果分析人员只关注唯一比对 reads，可以使用 --uniquely-mapped-only 参数。 新的空间基因表达矩阵通过唯一基因ID进行标识，同时依然记录基因名称信息。 在图像相关的分析部分，软件对图像处理性能进行了优化。同时，在运行 SAW count 时，支持以TIFF格式直接输入显微镜拼接大图图像。 SAW 分析中新增了基于 Leiden 聚类进行的差异表达分析，marker features 被记录在AnnData格式的 H5AD 和 CSV 文件中，并在 HTML 报告和 StereoMap 中展示。 HTML 报告中的图表是交互式的，新增微生物分析页面，增加了 marker features 结果表格。 重新整理输出目录结构，使得结果文件更加清晰易查找，并将中间环节文件和日志放入指定的文件夹中。 输出可视化压缩文件visualization.tar.gz，其中包含 .stereo 统领文件，用于记录 SAW 分析流程的基本信息和 StereoMap 所需的字段信息。 历史版本 历史版本信息可以从 GitHub 获取。 获取帮助 有任何关于SAW版本的问题或疑虑？ 请联系当地销售或FAS/FBS。 Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"},"shu-ju-ji.html":{"url":"shu-ju-ji.html","title":"数据集","keywords":"","body":"数据集Demo 数据集Stereo-seq N Formalin Fixed & Paraffin Embedded (FFPE)Stereo-seq T Fresh Frozen (FF)数据集 Demo 数据集 跳转至 SAW demo 数据集的下载页面. \"Kit version\" 记录的是运行 SAW count 分析流程时所使用的 --kit-version 参数信息。 Stereo-seq N Formalin Fixed & Paraffin Embedded (FFPE) DatasetChip sizeKit versionPipeline versionSpeciesDisease stateAnatomical tissue Staining methodC04144D5_mouse_brain_Stereo-seq_N_FFPE1 cm x 1 cmStereo-seq N FFPE V1.0≥ SAW 8.0.0MouseHealthyBrainssDNAC04138G3_mouse_brain_Stereo-seq_N_FFPE1 cm x 1 cmStereo-seq N FFPE V1.0≥ SAW 8.0.0MouseHealthyBrainH&EA03490D3_mouse_lung_microorganism_Stereo-seq_N_FFPE1 cm x 1 cmStereo-seq N FFPE V1.0≥ SAW 8.0.0MouseInfected with Mycobacterium tuberculosisLungH&E Stereo-seq T Fresh Frozen (FF) DatasetChip sizeKit versionPipeline versionSpeciesDisease stateAnatomical tissue Staining methodSS200000135TL_D1_mouse_brain_Stereo-seq_T_FF1 cm x 1 cmStereo-seq T FF V1.2≥ SAW 5.5.0MouseHealthyBrainssDNA SS200000059_NC_mouse_testis_Stereo-seq_T_FF1 cm x 1 cmStereo-seq T FF V1.2≥ SAW 6.0.0MouseHealthyTestisDAPI + 2 IF (AKAP3, TESK2)FP200009107_E414_mouse_olfactory_bulb_Stereo-seq_T_FF0.5 cm x 0.5 cmStereo-seq T FF V1.2≥ SAW 6.1.0MouseHealthyOlfactory bulbDAPID02070C3D3_mouse_embryo_Stereo-seq_T_FF1 cm x 2 cmStereo-seq T FF V1.2≥ SAW 6.1.0MouseHealthyEmbryoDAPIC02533C1_mouse_kidney_Stereo-seq_T_FF1 cm x 1 cmStereo-seq T FF V1.2≥ SAW 7.0.0MouseHealthyKidneyH&E Copyright ©2024 Beijing Genomics Institute (Shenzhen) All right reserved.Modiftied: 2024-07-16 12:24:25 document.addEventListener(\"DOMContentLoaded\", function() {lightbox.option({\"resizeDuration\":200,\"wrapAround\":true});})"}}